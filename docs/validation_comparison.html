<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Scott Forrest">
<meta name="dcterms.date" content="2025-02-26">

<title>Comparing SSF and deepSSF Predictions – deepSSF</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ssf_validation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4a1c1709ed6c34e18d4d8b73dec7994d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BYRMN2C7ZE"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
 
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
gtag('config', 'G-BYRMN2C7ZE', { 'anonymize_ip': true});
</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">deepSSF</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./getting_started.html"> 
<span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./study_system.html"> 
<span class="menu-text">Study System</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data_preparation.html"> 
<span class="menu-text">Data Preparation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./model_training.html"> 
<span class="menu-text">Model Training</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./predictions.html"> 
<span class="menu-text">Predictions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./inference.html"> 
<span class="menu-text">Inference</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./validation.html" aria-current="page"> 
<span class="menu-text">Validation</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://swforrest.github.io"> 
<span class="menu-text">Website</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/swforrest/deepSSF"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:scottwforrest@gmail.com"> <i class="bi bi-envelope-at-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/swforrest/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/scottwilliamf.bsky.social"> 
<span class="menu-text">Bluesky</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./validation_comparison.html">Comparing SSF and deepSSF Predictions</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Validation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Python/deepSSF_next_step_validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">deepSSF Validation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Python/deepSSF_next_step_validation_S2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">deepSSF Validation - S2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ssf_model_fit_id.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SSF Model Fitting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ssf_validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SSF Validation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validation_comparison.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Comparing SSF and deepSSF Predictions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link active" data-scroll-target="#loading-packages">Loading packages</a></li>
  <li><a href="#script-setup" id="toc-script-setup" class="nav-link" data-scroll-target="#script-setup">Script setup</a></li>
  <li><a href="#step-selection-function-probabilities" id="toc-step-selection-function-probabilities" class="nav-link" data-scroll-target="#step-selection-function-probabilities">Step selection function probabilities</a>
  <ul class="collapse">
  <li><a href="#ssf-models-fitted-with-and-without-temporal-dynamics" id="toc-ssf-models-fitted-with-and-without-temporal-dynamics" class="nav-link" data-scroll-target="#ssf-models-fitted-with-and-without-temporal-dynamics">SSF models fitted with and without temporal dynamics</a>
  <ul class="collapse">
  <li><a href="#lengthening-data-frames-to-stack-together-for-plotting" id="toc-lengthening-data-frames-to-stack-together-for-plotting" class="nav-link" data-scroll-target="#lengthening-data-frames-to-stack-together-for-plotting">Lengthening data frames to stack together for plotting</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#deepssf-probabilities" id="toc-deepssf-probabilities" class="nav-link" data-scroll-target="#deepssf-probabilities">deepSSF probabilities</a>
  <ul class="collapse">
  <li><a href="#lengthening-data-frames-to-stack-together-for-plotting-1" id="toc-lengthening-data-frames-to-stack-together-for-plotting-1" class="nav-link" data-scroll-target="#lengthening-data-frames-to-stack-together-for-plotting-1">Lengthening data frames to stack together for plotting</a></li>
  </ul></li>
  <li><a href="#deepssf-sentinel-2-probabilities" id="toc-deepssf-sentinel-2-probabilities" class="nav-link" data-scroll-target="#deepssf-sentinel-2-probabilities">deepSSF Sentinel 2 probabilities</a>
  <ul class="collapse">
  <li><a href="#lengthening-data-frames-to-stack-together-for-plotting-2" id="toc-lengthening-data-frames-to-stack-together-for-plotting-2" class="nav-link" data-scroll-target="#lengthening-data-frames-to-stack-together-for-plotting-2">Lengthening data frames to stack together for plotting</a></li>
  </ul></li>
  <li><a href="#compare-the-probabilities" id="toc-compare-the-probabilities" class="nav-link" data-scroll-target="#compare-the-probabilities">Compare the probabilities</a>
  <ul class="collapse">
  <li><a href="#combine-the-wide-data-frames" id="toc-combine-the-wide-data-frames" class="nav-link" data-scroll-target="#combine-the-wide-data-frames">Combine the wide data frames</a>
  <ul class="collapse">
  <li><a href="#keep-only-the-relevant-columns" id="toc-keep-only-the-relevant-columns" class="nav-link" data-scroll-target="#keep-only-the-relevant-columns">Keep only the relevant columns</a></li>
  <li><a href="#combine-the-data-frames" id="toc-combine-the-data-frames" class="nav-link" data-scroll-target="#combine-the-data-frames">Combine the data frames</a></li>
  </ul></li>
  <li><a href="#split-in-habitat-selection-movement-and-next-step-probabilities" id="toc-split-in-habitat-selection-movement-and-next-step-probabilities" class="nav-link" data-scroll-target="#split-in-habitat-selection-movement-and-next-step-probabilities">Split in habitat selection, movement and next step probabilities</a>
  <ul class="collapse">
  <li><a href="#function-to-get-the-maximum-probability" id="toc-function-to-get-the-maximum-probability" class="nav-link" data-scroll-target="#function-to-get-the-maximum-probability">Function to get the maximum probability</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#calculate-which-was-the-maximum-probability-for-each-row" id="toc-calculate-which-was-the-maximum-probability-for-each-row" class="nav-link" data-scroll-target="#calculate-which-was-the-maximum-probability-for-each-row">Calculate which was the maximum probability for each row</a>
  <ul class="collapse">
  <li><a href="#habitat-selection" id="toc-habitat-selection" class="nav-link" data-scroll-target="#habitat-selection">Habitat selection</a></li>
  <li><a href="#movement" id="toc-movement" class="nav-link" data-scroll-target="#movement">Movement</a></li>
  <li><a href="#next-step" id="toc-next-step" class="nav-link" data-scroll-target="#next-step">Next-step</a></li>
  <li><a href="#combine-the-lengthened-data-frames" id="toc-combine-the-lengthened-data-frames" class="nav-link" data-scroll-target="#combine-the-lengthened-data-frames">Combine the lengthened data frames</a></li>
  <li><a href="#prepare-data-frame-for-plotting" id="toc-prepare-data-frame-for-plotting" class="nav-link" data-scroll-target="#prepare-data-frame-for-plotting">Prepare data frame for plotting</a>
  <ul class="collapse">
  <li><a href="#prepare-sliding-window" id="toc-prepare-sliding-window" class="nav-link" data-scroll-target="#prepare-sliding-window">Prepare sliding window</a></li>
  <li><a href="#all-ids" id="toc-all-ids" class="nav-link" data-scroll-target="#all-ids">All IDs</a></li>
  </ul></li>
  <li><a href="#out-of-sample-validation" id="toc-out-of-sample-validation" class="nav-link" data-scroll-target="#out-of-sample-validation">Out-of-sample validation</a>
  <ul class="collapse">
  <li><a href="#calculating-mean-and-quantiles" id="toc-calculating-mean-and-quantiles" class="nav-link" data-scroll-target="#calculating-mean-and-quantiles">Calculating mean and quantiles</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#habitat-selection-across-the-tracking-period" id="toc-habitat-selection-across-the-tracking-period" class="nav-link" data-scroll-target="#habitat-selection-across-the-tracking-period">Habitat selection across the tracking period</a>
  <ul class="collapse">
  <li><a href="#all-models" id="toc-all-models" class="nav-link" data-scroll-target="#all-models">All models</a></li>
  <li><a href="#deepssf-models" id="toc-deepssf-models" class="nav-link" data-scroll-target="#deepssf-models">deepSSF models</a></li>
  <li><a href="#ssf-models" id="toc-ssf-models" class="nav-link" data-scroll-target="#ssf-models">SSF models</a></li>
  </ul></li>
  <li><a href="#movement-probability-across-the-tracking-period" id="toc-movement-probability-across-the-tracking-period" class="nav-link" data-scroll-target="#movement-probability-across-the-tracking-period">Movement probability across the tracking period</a>
  <ul class="collapse">
  <li><a href="#all-models-1" id="toc-all-models-1" class="nav-link" data-scroll-target="#all-models-1">All models</a></li>
  <li><a href="#deepssf-models-1" id="toc-deepssf-models-1" class="nav-link" data-scroll-target="#deepssf-models-1">deepSSF models</a></li>
  <li><a href="#ssf-models-1" id="toc-ssf-models-1" class="nav-link" data-scroll-target="#ssf-models-1">SSF models</a></li>
  </ul></li>
  <li><a href="#next-step-probabilities-across-the-tracking-period" id="toc-next-step-probabilities-across-the-tracking-period" class="nav-link" data-scroll-target="#next-step-probabilities-across-the-tracking-period">Next-step probabilities across the tracking period</a>
  <ul class="collapse">
  <li><a href="#all-models-2" id="toc-all-models-2" class="nav-link" data-scroll-target="#all-models-2">All models</a></li>
  <li><a href="#deepssf-models-2" id="toc-deepssf-models-2" class="nav-link" data-scroll-target="#deepssf-models-2">deepSSF models</a></li>
  <li><a href="#ssf-models-2" id="toc-ssf-models-2" class="nav-link" data-scroll-target="#ssf-models-2">SSF models</a></li>
  </ul></li>
  <li><a href="#hourly-probabilities" id="toc-hourly-probabilities" class="nav-link" data-scroll-target="#hourly-probabilities">Hourly probabilities</a></li>
  <li><a href="#habitat-selection-across-the-day" id="toc-habitat-selection-across-the-day" class="nav-link" data-scroll-target="#habitat-selection-across-the-day">Habitat selection across the day</a>
  <ul class="collapse">
  <li><a href="#all-models-3" id="toc-all-models-3" class="nav-link" data-scroll-target="#all-models-3">All models</a></li>
  <li><a href="#deepssf-models-3" id="toc-deepssf-models-3" class="nav-link" data-scroll-target="#deepssf-models-3">deepSSF models</a></li>
  <li><a href="#ssf-models-3" id="toc-ssf-models-3" class="nav-link" data-scroll-target="#ssf-models-3">SSF models</a></li>
  </ul></li>
  <li><a href="#movement-probability-across-the-day" id="toc-movement-probability-across-the-day" class="nav-link" data-scroll-target="#movement-probability-across-the-day">Movement probability across the day</a>
  <ul class="collapse">
  <li><a href="#all-models-4" id="toc-all-models-4" class="nav-link" data-scroll-target="#all-models-4">All models</a></li>
  <li><a href="#deepssf-models-4" id="toc-deepssf-models-4" class="nav-link" data-scroll-target="#deepssf-models-4">deepSSF models</a></li>
  <li><a href="#ssf-models-4" id="toc-ssf-models-4" class="nav-link" data-scroll-target="#ssf-models-4">SSF models</a></li>
  </ul></li>
  <li><a href="#next-step-probability-across-the-day" id="toc-next-step-probability-across-the-day" class="nav-link" data-scroll-target="#next-step-probability-across-the-day">Next-step probability across the day</a>
  <ul class="collapse">
  <li><a href="#all-models-5" id="toc-all-models-5" class="nav-link" data-scroll-target="#all-models-5">All models</a></li>
  <li><a href="#deepssf-models-5" id="toc-deepssf-models-5" class="nav-link" data-scroll-target="#deepssf-models-5">deepSSF models</a></li>
  <li><a href="#ssf-models-5" id="toc-ssf-models-5" class="nav-link" data-scroll-target="#ssf-models-5">SSF models</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="validation_comparison.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Comparing SSF and deepSSF Predictions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://swforrest.github.io/">Scott Forrest</a> <a href="mailto:scottwforrest@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-9529-0108" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Queensland University of Technology, CSIRO
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>In this script we are comparing the nezt-step ahead predictions of the SSF (with and without temporal dynamics) and deepSSF models. We are comparing the probabilities of movement, habitat selection and next-step selection, and how they change throughout time.</p>
    <p>By comparing the predictions of each process across the entire tracking period or for each hour of the day, we can critically evaluate the covariates that are used by the models and allow for model refinement.</p>
    <p>As we expected, the deepSSF models outperformed the SSF models on the in-sample data, which was particularly the case for when the model was trained with Sentinel-2 spectral bands and slope as the spatial covariates (deepSSF S2). The performance dropped for out-of-sample data for all models (including SSFs), and the deepSSF trained with the derived covariates (NDVI, canopy cover, herbaceous vegetation and slope) performed worse than the SSF models, and was only marginally better than a null model, which bears some evidence of overfitting. However, the deepSSF S2 model, trained on `raw’ Sentinel-2 layers rather than derived quantities, retained greater accuracy than all other approaches for out-of-sample data, suggesting that these inputs contain more information that is relevant to buffalo movement and habitat selection than derived quantities like NDVI and slope.</p>
  </div>
</div>


</header>


<section id="loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-packages">Loading packages</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"amt"</span>, <span class="st">"sf"</span>, <span class="st">"terra"</span>, <span class="st">"beepr"</span>, <span class="st">"tictoc"</span>, <span class="st">"circular"</span>, </span>
<span id="cb1-3"><a href="#cb1-3"></a>              <span class="st">"matrixStats"</span>, <span class="st">"progress"</span>, <span class="st">"paletteer"</span>, <span class="st">"slider"</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">walk</span>(packages, require, <span class="at">character.only =</span> T)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)  <span class="co"># Prevent scientific notation in plots</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">0</span>)  <span class="co"># Reset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="script-setup" class="level2">
<h2 class="anchored" data-anchor-id="script-setup">Script setup</h2>
<p>Specify the focal id for selecting the in-sample predictions.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>focal_id <span class="ot">&lt;-</span> <span class="dv">2005</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-selection-function-probabilities" class="level1">
<h1>Step selection function probabilities</h1>
<section id="ssf-models-fitted-with-and-without-temporal-dynamics" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models-fitted-with-and-without-temporal-dynamics">SSF models fitted with and without temporal dynamics</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># create vector of GPS data filenames</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>validation_ssf <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"outputs/next_step_validation"</span>, <span class="at">pattern =</span> <span class="st">"next_step_probs_ssf_id"</span>) </span>
<span id="cb3-3"><a href="#cb3-3"></a>validation_ids <span class="ot">&lt;-</span> <span class="fu">substr</span>(validation_ssf, <span class="dv">23</span>, <span class="dv">26</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># import data</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>validation_ssf_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(validation_ssf))</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(validation_ssf)){</span>
<span id="cb3-9"><a href="#cb3-9"></a>  validation_ssf_list[[i]] <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="fu">paste</span>(<span class="st">"outputs/next_step_validation/"</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>                                             validation_ssf[[i]], </span>
<span id="cb3-11"><a href="#cb3-11"></a>                                             <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb3-12"><a href="#cb3-12"></a>  </span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="co"># validation_ssf_list[i]$id &lt;- validation_ids[i]</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="fu">attr</span>(validation_ssf_list[[i]]<span class="sc">$</span>t_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="fu">attr</span>(validation_ssf_list[[i]]<span class="sc">$</span>t2_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>  </span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(validation_ssf_list[[i]]<span class="sc">$</span>prob_next_step_ssf_0p)))</span>
<span id="cb3-18"><a href="#cb3-18"></a>  </span>
<span id="cb3-19"><a href="#cb3-19"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># check that the data has been imported correctly</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># validation_ssf_list</span></span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a>validation_ssf_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_ssf_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lengthening-data-frames-to-stack-together-for-plotting" class="level3">
<h3 class="anchored" data-anchor-id="lengthening-data-frames-to-stack-together-for-plotting">Lengthening data frames to stack together for plotting</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>validation_ssf_move <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"prob_movement"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"movement"</span>),</span>
<span id="cb18-4"><a href="#cb18-4"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">gsub</span>(<span class="st">"prob_movement_"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb18-7"><a href="#cb18-7"></a>         <span class="at">probability =</span> <span class="st">"move"</span>,</span>
<span id="cb18-8"><a href="#cb18-8"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a>validation_ssf_habitat <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb18-11"><a href="#cb18-11"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"prob_habitat"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"habitat"</span>),</span>
<span id="cb18-13"><a href="#cb18-13"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb18-14"><a href="#cb18-14"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">gsub</span>(<span class="st">"prob_habitat_"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb18-16"><a href="#cb18-16"></a>         <span class="at">probability =</span> <span class="st">"habitat"</span>,</span>
<span id="cb18-17"><a href="#cb18-17"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb18-18"><a href="#cb18-18"></a></span>
<span id="cb18-19"><a href="#cb18-19"></a>validation_ssf_next_step <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"prob_next_step"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-21"><a href="#cb18-21"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"next_step"</span>),</span>
<span id="cb18-22"><a href="#cb18-22"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb18-23"><a href="#cb18-23"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-24"><a href="#cb18-24"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">gsub</span>(<span class="st">"prob_next_step_"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb18-25"><a href="#cb18-25"></a>         <span class="at">probability =</span> <span class="st">"next_step"</span>,</span>
<span id="cb18-26"><a href="#cb18-26"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb18-27"><a href="#cb18-27"></a></span>
<span id="cb18-28"><a href="#cb18-28"></a>validation_ssf_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_ssf_move,</span>
<span id="cb18-29"><a href="#cb18-29"></a>                                 validation_ssf_habitat,</span>
<span id="cb18-30"><a href="#cb18-30"></a>                                 validation_ssf_next_step)</span>
<span id="cb18-31"><a href="#cb18-31"></a></span>
<span id="cb18-32"><a href="#cb18-32"></a><span class="fu">head</span>(validation_ssf_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["x_"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y_"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["t_"],"name":[4],"type":["dttm"],"align":["right"]},{"label":["x2_"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y2_"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t2_"],"name":[7],"type":["dttm"],"align":["right"]},{"label":["hour_t2"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["yday_t2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["year_t2"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["full_name"],"name":[11],"type":["chr"],"align":["left"]},{"label":["model"],"name":[12],"type":["chr"],"align":["left"]},{"label":["probability"],"name":[13],"type":["chr"],"align":["left"]},{"label":["value"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"41969.31","3":"-1435671","4":"2018-07-25 11:04:23","5":"41921.52","6":"-1435654","7":"2018-07-25 12:04:39","8":"12","9":"206","10":"2018","11":"prob_movement_ssf_0p","12":"ssf_0p","13":"move","14":"NA"},{"1":"2005","2":"41969.31","3":"-1435671","4":"2018-07-25 11:04:23","5":"41921.52","6":"-1435654","7":"2018-07-25 12:04:39","8":"12","9":"206","10":"2018","11":"prob_movement_ssf_2p","12":"ssf_2p","13":"move","14":"NA"},{"1":"2005","2":"41921.52","3":"-1435654","4":"2018-07-25 12:04:39","5":"41779.44","6":"-1435601","7":"2018-07-25 13:04:17","8":"13","9":"206","10":"2018","11":"prob_movement_ssf_0p","12":"ssf_0p","13":"move","14":"0.001074485"},{"1":"2005","2":"41921.52","3":"-1435654","4":"2018-07-25 12:04:39","5":"41779.44","6":"-1435601","7":"2018-07-25 13:04:17","8":"13","9":"206","10":"2018","11":"prob_movement_ssf_2p","12":"ssf_2p","13":"move","14":"0.001553322"},{"1":"2005","2":"41779.44","3":"-1435601","4":"2018-07-25 13:04:17","5":"41841.20","6":"-1435635","7":"2018-07-25 14:04:39","8":"14","9":"206","10":"2018","11":"prob_movement_ssf_0p","12":"ssf_0p","13":"move","14":"0.001394574"},{"1":"2005","2":"41779.44","3":"-1435601","4":"2018-07-25 13:04:17","5":"41841.20","6":"-1435635","7":"2018-07-25 14:04:39","8":"14","9":"206","10":"2018","11":"prob_movement_ssf_2p","12":"ssf_2p","13":"move","14":"0.001958874"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="deepssf-probabilities" class="level1">
<h1>deepSSF probabilities</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># create vector of GPS data filenames</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>validation_deepssf <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"outputs/next_step_validation"</span>, <span class="at">pattern =</span> <span class="st">"next_step_probs_TAmix"</span>) </span>
<span id="cb19-3"><a href="#cb19-3"></a>validation_ids <span class="ot">&lt;-</span> <span class="fu">substr</span>(validation_deepssf, <span class="dv">25</span>, <span class="dv">28</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># import data</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>validation_deepssf_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(validation_deepssf))</span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(validation_deepssf)){</span>
<span id="cb19-9"><a href="#cb19-9"></a>  validation_deepssf_list[[i]] <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="fu">paste</span>(<span class="st">"outputs/next_step_validation/"</span>,</span>
<span id="cb19-10"><a href="#cb19-10"></a>                                             validation_deepssf[[i]], </span>
<span id="cb19-11"><a href="#cb19-11"></a>                                             <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb19-12"><a href="#cb19-12"></a>  </span>
<span id="cb19-13"><a href="#cb19-13"></a>  <span class="co"># validation_deepssf_list[i]$id &lt;- validation_ids[i]</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>  <span class="fu">attr</span>(validation_deepssf_list[[i]]<span class="sc">$</span>t_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>  <span class="fu">attr</span>(validation_deepssf_list[[i]]<span class="sc">$</span>t2_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>  </span>
<span id="cb19-17"><a href="#cb19-17"></a>}</span>
<span id="cb19-18"><a href="#cb19-18"></a></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co"># To check that the data has been imported correctly</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co"># validation_deepssf_list</span></span>
<span id="cb19-21"><a href="#cb19-21"></a></span>
<span id="cb19-22"><a href="#cb19-22"></a>validation_deepssf_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_deepssf_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lengthening-data-frames-to-stack-together-for-plotting-1" class="level3">
<h3 class="anchored" data-anchor-id="lengthening-data-frames-to-stack-together-for-plotting-1">Lengthening data frames to stack together for plotting</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>validation_deepssf_long <span class="ot">&lt;-</span> validation_deepssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"probs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"probs"</span>),</span>
<span id="cb20-4"><a href="#cb20-4"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"deepSSF"</span>,</span>
<span id="cb20-7"><a href="#cb20-7"></a>         <span class="at">probability =</span> <span class="fu">gsub</span>(<span class="st">"_probs"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb20-8"><a href="#cb20-8"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="deepssf-sentinel-2-probabilities" class="level1">
<h1>deepSSF Sentinel 2 probabilities</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># create vector of GPS data filenames</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>validation_deepssf_s2 <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"outputs/next_step_validation"</span>, <span class="at">pattern =</span> <span class="st">"next_step_probs_S2"</span>) </span>
<span id="cb21-3"><a href="#cb21-3"></a>validation_ids <span class="ot">&lt;-</span> <span class="fu">substr</span>(validation_deepssf_s2, <span class="dv">22</span>, <span class="dv">25</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co"># import data</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>validation_deepssf_s2_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(validation_deepssf_s2))</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(validation_deepssf_s2)){</span>
<span id="cb21-9"><a href="#cb21-9"></a>  validation_deepssf_s2_list[[i]] <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="fu">paste</span>(<span class="st">"outputs/next_step_validation/"</span>,</span>
<span id="cb21-10"><a href="#cb21-10"></a>                                             validation_deepssf_s2[[i]], </span>
<span id="cb21-11"><a href="#cb21-11"></a>                                             <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb21-12"><a href="#cb21-12"></a>  </span>
<span id="cb21-13"><a href="#cb21-13"></a>  <span class="co"># validation_deepssf_s2_list[i]$id &lt;- validation_ids[i]</span></span>
<span id="cb21-14"><a href="#cb21-14"></a>  <span class="fu">attr</span>(validation_deepssf_s2_list[[i]]<span class="sc">$</span>t_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="fu">attr</span>(validation_deepssf_s2_list[[i]]<span class="sc">$</span>t2_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb21-16"><a href="#cb21-16"></a>  </span>
<span id="cb21-17"><a href="#cb21-17"></a>}</span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="co"># To check that the data has been imported correctly</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co"># validation_deepssf_s2_list</span></span>
<span id="cb21-21"><a href="#cb21-21"></a></span>
<span id="cb21-22"><a href="#cb21-22"></a>validation_deepssf_s2_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_deepssf_s2_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lengthening-data-frames-to-stack-together-for-plotting-2" class="level3">
<h3 class="anchored" data-anchor-id="lengthening-data-frames-to-stack-together-for-plotting-2">Lengthening data frames to stack together for plotting</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>validation_deepssf_s2_long <span class="ot">&lt;-</span> validation_deepssf_s2_all <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"probs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"probs"</span>),</span>
<span id="cb22-4"><a href="#cb22-4"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"deepSSF_S2"</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>         <span class="at">probability =</span> <span class="fu">gsub</span>(<span class="st">"_probs"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb22-8"><a href="#cb22-8"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compare-the-probabilities" class="level1">
<h1>Compare the probabilities</h1>
<section id="combine-the-wide-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="combine-the-wide-data-frames">Combine the wide data frames</h2>
<section id="keep-only-the-relevant-columns" class="level3">
<h3 class="anchored" data-anchor-id="keep-only-the-relevant-columns">Keep only the relevant columns</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>validation_ssf_clean <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span>
<span id="cb23-3"><a href="#cb23-3"></a>                  prob_habitat_ssf_0p, prob_habitat_ssf_2p, </span>
<span id="cb23-4"><a href="#cb23-4"></a>                  prob_movement_ssf_0p, prob_movement_ssf_2p,</span>
<span id="cb23-5"><a href="#cb23-5"></a>                  prob_next_step_ssf_0p, prob_next_step_ssf_2p))</span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a>validation_deepssf_clean <span class="ot">&lt;-</span> validation_deepssf_all <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">mutate</span>(<span class="at">habitat_deepSSF =</span> habitat_probs,</span>
<span id="cb23-9"><a href="#cb23-9"></a>         <span class="at">movement_deepSSF =</span> move_probs,</span>
<span id="cb23-10"><a href="#cb23-10"></a>         <span class="at">next_step_deepSSF =</span> next_step_probs,</span>
<span id="cb23-11"><a href="#cb23-11"></a>         <span class="at">.keep =</span> <span class="st">"none"</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a>validation_deepssf_s2_clean <span class="ot">&lt;-</span> validation_deepssf_s2_all <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="fu">mutate</span>(<span class="at">habitat_deepSSF_S2 =</span> habitat_probs,</span>
<span id="cb23-15"><a href="#cb23-15"></a>         <span class="at">movement_deepSSF_S2 =</span> move_probs,</span>
<span id="cb23-16"><a href="#cb23-16"></a>         <span class="at">next_step_deepSSF_S2 =</span> next_step_probs,</span>
<span id="cb23-17"><a href="#cb23-17"></a>         <span class="at">.keep =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-the-data-frames" class="level3">
<h3 class="anchored" data-anchor-id="combine-the-data-frames">Combine the data frames</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>validation_all <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(validation_ssf_clean,</span>
<span id="cb24-2"><a href="#cb24-2"></a>                            validation_deepssf_clean,</span>
<span id="cb24-3"><a href="#cb24-3"></a>                            validation_deepssf_s2_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="split-in-habitat-selection-movement-and-next-step-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="split-in-habitat-selection-movement-and-next-step-probabilities">Split in habitat selection, movement and next step probabilities</h2>
<section id="function-to-get-the-maximum-probability" class="level3">
<h3 class="anchored" data-anchor-id="function-to-get-the-maximum-probability">Function to get the maximum probability</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>get_max_column <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="co"># Create a new column with the name of the column containing the max value for each row</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  df<span class="sc">$</span>max_column <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="co"># Find the column name with the maximum value</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>    col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(df)</span>
<span id="cb25-6"><a href="#cb25-6"></a>    max_col_index <span class="ot">&lt;-</span> <span class="fu">which.max</span>(row)</span>
<span id="cb25-7"><a href="#cb25-7"></a>    <span class="fu">return</span>(col_names[max_col_index])</span>
<span id="cb25-8"><a href="#cb25-8"></a>  })</span>
<span id="cb25-9"><a href="#cb25-9"></a>  </span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="fu">return</span>(df)</span>
<span id="cb25-11"><a href="#cb25-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="calculate-which-was-the-maximum-probability-for-each-row" class="level1">
<h1>Calculate which was the maximum probability for each row</h1>
<section id="habitat-selection" class="level2">
<h2 class="anchored" data-anchor-id="habitat-selection">Habitat selection</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>validation_habitat <span class="ot">&lt;-</span> validation_all <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">==</span> <span class="dv">2005</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="co"># id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="co"># grep("habitat", colnames(validation_all)),</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>    prob_habitat_ssf_0p,</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="co"># prob_habitat_ssf_2p,</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="co"># habitat_deepSSF,</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>    habitat_deepSSF_S2</span>
<span id="cb26-9"><a href="#cb26-9"></a>    ) </span>
<span id="cb26-10"><a href="#cb26-10"></a></span>
<span id="cb26-11"><a href="#cb26-11"></a>validation_habitat_prop <span class="ot">&lt;-</span> <span class="fu">get_max_column</span>(validation_habitat)</span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a>max_column_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(validation_habitat_prop<span class="sc">$</span>max_column)</span>
<span id="cb26-14"><a href="#cb26-14"></a>max_column_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(max_column_counts)</span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="at">column =</span> <span class="fu">names</span>(max_column_counts),</span>
<span id="cb26-18"><a href="#cb26-18"></a>  <span class="at">count =</span> <span class="fu">as.numeric</span>(max_column_counts),</span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="at">proportion =</span> <span class="fu">as.numeric</span>(max_column_proportions)</span>
<span id="cb26-20"><a href="#cb26-20"></a>)</span>
<span id="cb26-21"><a href="#cb26-21"></a></span>
<span id="cb26-22"><a href="#cb26-22"></a>summary_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["column"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["proportion"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"habitat_deepSSF_S2","2":"41622","3":"0.4453551"},{"1":"prob_habitat_ssf_0p","2":"51836","3":"0.5546449"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="movement" class="level2">
<h2 class="anchored" data-anchor-id="movement">Movement</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>validation_movement <span class="ot">&lt;-</span> validation_all <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb27-3"><a href="#cb27-3"></a>    <span class="co"># id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>    <span class="co"># grep("movement", colnames(validation_all)),</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="co"># prob_movement_ssf_0p,</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>    prob_movement_ssf_2p,</span>
<span id="cb27-7"><a href="#cb27-7"></a>    movement_deepSSF,</span>
<span id="cb27-8"><a href="#cb27-8"></a>    <span class="co"># movement_deepSSF_S2</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>    ) </span>
<span id="cb27-10"><a href="#cb27-10"></a></span>
<span id="cb27-11"><a href="#cb27-11"></a>validation_movement_prop <span class="ot">&lt;-</span> <span class="fu">get_max_column</span>(validation_movement)</span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a>max_column_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(validation_movement_prop<span class="sc">$</span>max_column)</span>
<span id="cb27-14"><a href="#cb27-14"></a>max_column_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(max_column_counts)</span>
<span id="cb27-15"><a href="#cb27-15"></a></span>
<span id="cb27-16"><a href="#cb27-16"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-17"><a href="#cb27-17"></a>  <span class="at">column =</span> <span class="fu">names</span>(max_column_counts),</span>
<span id="cb27-18"><a href="#cb27-18"></a>  <span class="at">count =</span> <span class="fu">as.numeric</span>(max_column_counts),</span>
<span id="cb27-19"><a href="#cb27-19"></a>  <span class="at">proportion =</span> <span class="fu">as.numeric</span>(max_column_proportions)</span>
<span id="cb27-20"><a href="#cb27-20"></a>)</span>
<span id="cb27-21"><a href="#cb27-21"></a></span>
<span id="cb27-22"><a href="#cb27-22"></a>summary_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["column"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["proportion"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"movement_deepSSF","2":"70366","3":"0.679484"},{"1":"prob_movement_ssf_2p","2":"33192","3":"0.320516"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="next-step" class="level2">
<h2 class="anchored" data-anchor-id="next-step">Next-step</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>validation_next_step <span class="ot">&lt;-</span> validation_all <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="co"># id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="co"># grep("next_step", colnames(validation_all)),</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="co"># prob_next_step_ssf_0p,</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>    prob_next_step_ssf_2p,</span>
<span id="cb28-7"><a href="#cb28-7"></a>    next_step_deepSSF,</span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="co"># next_step_deepSSF_S2</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>    ) </span>
<span id="cb28-10"><a href="#cb28-10"></a></span>
<span id="cb28-11"><a href="#cb28-11"></a>validation_next_step_prop <span class="ot">&lt;-</span> <span class="fu">get_max_column</span>(validation_next_step)</span>
<span id="cb28-12"><a href="#cb28-12"></a></span>
<span id="cb28-13"><a href="#cb28-13"></a>max_column_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(validation_next_step_prop<span class="sc">$</span>max_column)</span>
<span id="cb28-14"><a href="#cb28-14"></a>max_column_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(max_column_counts)</span>
<span id="cb28-15"><a href="#cb28-15"></a></span>
<span id="cb28-16"><a href="#cb28-16"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-17"><a href="#cb28-17"></a>  <span class="at">column =</span> <span class="fu">names</span>(max_column_counts),</span>
<span id="cb28-18"><a href="#cb28-18"></a>  <span class="at">count =</span> <span class="fu">as.numeric</span>(max_column_counts),</span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="at">proportion =</span> <span class="fu">as.numeric</span>(max_column_proportions)</span>
<span id="cb28-20"><a href="#cb28-20"></a>)</span>
<span id="cb28-21"><a href="#cb28-21"></a></span>
<span id="cb28-22"><a href="#cb28-22"></a>summary_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["column"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["proportion"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"next_step_deepSSF","2":"65888","3":"0.6362425"},{"1":"prob_next_step_ssf_2p","2":"37670","3":"0.3637575"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="combine-the-lengthened-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="combine-the-lengthened-data-frames">Combine the lengthened data frames</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>validation_all_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_ssf_long,</span>
<span id="cb29-2"><a href="#cb29-2"></a>                                 validation_deepssf_long,</span>
<span id="cb29-3"><a href="#cb29-3"></a>                                 validation_deepssf_s2_long)</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a>validation_all_long <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="prepare-data-frame-for-plotting" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-frame-for-plotting">Prepare data frame for plotting</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Wet season is from November to April</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>months_wet <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a>validation_all_long <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> focal_id, <span class="st">"in_sample"</span>, <span class="st">"out_sample"</span>),</span>
<span id="cb30-6"><a href="#cb30-6"></a>         <span class="at">yday_t2_2018 =</span> <span class="fu">ifelse</span>(year_t2 <span class="sc">==</span> <span class="dv">2018</span>, yday_t2, yday_t2 <span class="sc">+</span> <span class="dv">365</span>),</span>
<span id="cb30-7"><a href="#cb30-7"></a>         <span class="at">week_t2 =</span> <span class="fu">week</span>(t2_),</span>
<span id="cb30-8"><a href="#cb30-8"></a>         <span class="at">month_t2 =</span> <span class="fu">month</span>(t2_),</span>
<span id="cb30-9"><a href="#cb30-9"></a>         <span class="at">season =</span> <span class="fu">ifelse</span>(month_t2 <span class="sc">%in%</span> months_wet, <span class="st">"wet"</span>, <span class="st">"dry"</span>))</span>
<span id="cb30-10"><a href="#cb30-10"></a></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="fu">head</span>(validation_all_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["x_"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y_"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["t_"],"name":[4],"type":["dttm"],"align":["right"]},{"label":["x2_"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y2_"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t2_"],"name":[7],"type":["dttm"],"align":["right"]},{"label":["hour_t2"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["yday_t2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["year_t2"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["full_name"],"name":[11],"type":["chr"],"align":["left"]},{"label":["model"],"name":[12],"type":["chr"],"align":["left"]},{"label":["probability"],"name":[13],"type":["chr"],"align":["left"]},{"label":["value"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["sample"],"name":[15],"type":["chr"],"align":["left"]},{"label":["yday_t2_2018"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["week_t2"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["month_t2"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["season"],"name":[19],"type":["chr"],"align":["left"]}],"data":[{"1":"2005","2":"41921.52","3":"-1435654","4":"2018-07-25 12:04:39","5":"41779.44","6":"-1435601","7":"2018-07-25 13:04:17","8":"13","9":"206","10":"2018","11":"prob_movement_ssf_0p","12":"ssf_0p","13":"move","14":"0.0010744848","15":"in_sample","16":"206","17":"30","18":"7","19":"dry"},{"1":"2005","2":"41921.52","3":"-1435654","4":"2018-07-25 12:04:39","5":"41779.44","6":"-1435601","7":"2018-07-25 13:04:17","8":"13","9":"206","10":"2018","11":"prob_movement_ssf_2p","12":"ssf_2p","13":"move","14":"0.0015533221","15":"in_sample","16":"206","17":"30","18":"7","19":"dry"},{"1":"2005","2":"41779.44","3":"-1435601","4":"2018-07-25 13:04:17","5":"41841.20","6":"-1435635","7":"2018-07-25 14:04:39","8":"14","9":"206","10":"2018","11":"prob_movement_ssf_0p","12":"ssf_0p","13":"move","14":"0.0013945736","15":"in_sample","16":"206","17":"30","18":"7","19":"dry"},{"1":"2005","2":"41779.44","3":"-1435601","4":"2018-07-25 13:04:17","5":"41841.20","6":"-1435635","7":"2018-07-25 14:04:39","8":"14","9":"206","10":"2018","11":"prob_movement_ssf_2p","12":"ssf_2p","13":"move","14":"0.0019588736","15":"in_sample","16":"206","17":"30","18":"7","19":"dry"},{"1":"2005","2":"41841.20","3":"-1435635","4":"2018-07-25 14:04:39","5":"41655.46","6":"-1435604","7":"2018-07-25 15:04:27","8":"15","9":"206","10":"2018","11":"prob_movement_ssf_0p","12":"ssf_0p","13":"move","14":"0.0005880560","15":"in_sample","16":"206","17":"30","18":"7","19":"dry"},{"1":"2005","2":"41841.20","3":"-1435635","4":"2018-07-25 14:04:39","5":"41655.46","6":"-1435604","7":"2018-07-25 15:04:27","8":"15","9":"206","10":"2018","11":"prob_movement_ssf_2p","12":"ssf_2p","13":"move","14":"0.0007257329","15":"in_sample","16":"206","17":"30","18":"7","19":"dry"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="prepare-sliding-window" class="level3">
<h3 class="anchored" data-anchor-id="prepare-sliding-window">Prepare sliding window</h3>
<p>The predicted probabilities are very noisy, so we apply some smoothing by using a sliding window (rolling mean).</p>
<p>We first need a function to calculate the summary statistics for each window.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>window_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">summarise</span>(data,</span>
<span id="cb31-3"><a href="#cb31-3"></a>            <span class="at">average_time =</span> <span class="fu">mean</span>(t2_, <span class="at">na.rm =</span> T),</span>
<span id="cb31-4"><a href="#cb31-4"></a>            <span class="at">average_prob =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb31-5"><a href="#cb31-5"></a>            <span class="at">q025 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb31-6"><a href="#cb31-6"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb31-7"><a href="#cb31-7"></a>            <span class="at">q50 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb31-8"><a href="#cb31-8"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb31-9"><a href="#cb31-9"></a>            <span class="at">q975 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> T)</span>
<span id="cb31-10"><a href="#cb31-10"></a>            )</span>
<span id="cb31-11"><a href="#cb31-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="all-ids" class="level3">
<h3 class="anchored" data-anchor-id="all-ids">All IDs</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>window_width <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># number of days in each window - should be odd</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co"># how many observations before and after the current observation</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>before_after <span class="ot">&lt;-</span> (window_width <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb32-4"><a href="#cb32-4"></a></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co"># ensure that the data is sorted by time (while respecting the id and model grouping)</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>all_data <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">group_by</span>(id, model, probability) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">arrange</span>(t2_)</span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># apply the sliding window function</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>validation_all_sliding_period <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">slide_period_dfr</span>(</span>
<span id="cb32-13"><a href="#cb32-13"></a>    all_data<span class="sc">$</span>t2_,</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="co"># specify that we want to split by days (and slide across at daily intervals)</span></span>
<span id="cb32-15"><a href="#cb32-15"></a>    <span class="st">"day"</span>,</span>
<span id="cb32-16"><a href="#cb32-16"></a>    <span class="co"># our window function (calculates mean and quantiles for each window)</span></span>
<span id="cb32-17"><a href="#cb32-17"></a>    window_summary,</span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="co"># how many days before and after the current observation we want to include in the window</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>    <span class="at">.before =</span> before_after,</span>
<span id="cb32-20"><a href="#cb32-20"></a>    <span class="at">.after =</span> before_after</span>
<span id="cb32-21"><a href="#cb32-21"></a>)</span>
<span id="cb32-22"><a href="#cb32-22"></a></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="fu">head</span>(validation_all_sliding_period, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["probability"],"name":[3],"type":["chr"],"align":["left"]},{"label":["average_time"],"name":[4],"type":["dttm"],"align":["right"]},{"label":["average_prob"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["q025"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["q25"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["q50"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["q75"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["q975"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"deepSSF","3":"habitat","4":"2018-07-29 06:37:58.56024","5":"0.0001067576","6":"4.432543e-05","7":"1.029873e-04","8":"0.0001071502","9":"0.0001143835","10":"0.0001370512"},{"1":"2005","2":"deepSSF","3":"move","4":"2018-07-29 06:37:58.56024","5":"0.0964471884","6":"1.826772e-05","7":"3.260185e-04","8":"0.0019145595","9":"0.0179316727","10":"0.7724902285"},{"1":"2005","2":"deepSSF","3":"next_step","4":"2018-07-29 06:37:58.56024","5":"0.0970434612","6":"1.154278e-05","7":"3.352182e-04","8":"0.0020632123","9":"0.0179818975","10":"0.7774376374"},{"1":"2005","2":"deepSSF_S2","3":"habitat","4":"2018-07-29 06:37:58.56024","5":"0.0001519351","6":"3.601910e-05","7":"7.600786e-05","8":"0.0001468339","9":"0.0002039330","10":"0.0003457077"},{"1":"2005","2":"deepSSF_S2","3":"move","4":"2018-07-29 06:37:58.56024","5":"0.0865613757","6":"1.609196e-05","7":"3.162099e-04","8":"0.0021111546","9":"0.0232812501","10":"0.7087863398"},{"1":"2005","2":"deepSSF_S2","3":"next_step","4":"2018-07-29 06:37:58.56024","5":"0.0894862605","6":"7.307345e-06","7":"3.418523e-04","8":"0.0023574347","9":"0.0226912597","10":"0.7427670978"},{"1":"2005","2":"ssf_0p","3":"habitat","4":"2018-07-29 06:37:58.56024","5":"0.0001013572","6":"7.879680e-05","7":"9.565210e-05","8":"0.0001026293","9":"0.0001084189","10":"0.0001194655"},{"1":"2005","2":"ssf_0p","3":"move","4":"2018-07-29 06:37:58.56024","5":"0.0016744302","6":"6.771687e-05","7":"3.817631e-04","8":"0.0011960944","9":"0.0027583890","10":"0.0044345171"},{"1":"2005","2":"ssf_0p","3":"next_step","4":"2018-07-29 06:37:58.56024","5":"0.0017073482","6":"7.051453e-05","7":"3.797187e-04","8":"0.0012511386","9":"0.0027803571","10":"0.0045826617"},{"1":"2005","2":"ssf_2p","3":"habitat","4":"2018-07-29 06:37:58.56024","5":"0.0001072595","6":"6.788693e-05","7":"9.134503e-05","8":"0.0001056624","9":"0.0001153782","10":"0.0001898314"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can see from the function above that we have the average time, average probability, and quantiles for eac overlapping window, for each model and probability surface (habitat, movement and next-step).</p>
</section>
</section>
<section id="out-of-sample-validation" class="level2">
<h2 class="anchored" data-anchor-id="out-of-sample-validation">Out-of-sample validation</h2>
<p>The above sliding windows are for each individual separately, but we also want to calculate the average and quantiles for all out-of-sample individuals together.</p>
<section id="calculating-mean-and-quantiles" class="level3">
<h3 class="anchored" data-anchor-id="calculating-mean-and-quantiles">Calculating mean and quantiles</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># out-of-sample data - all ids but the focal id</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>OOS_data <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">==</span> focal_id) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">group_by</span>(model, probability) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">arrange</span>(t2_)</span>
<span id="cb33-6"><a href="#cb33-6"></a></span>
<span id="cb33-7"><a href="#cb33-7"></a>validation_all_sliding_period_OOS <span class="ot">&lt;-</span> OOS_data <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">slide_period_dfr</span>(</span>
<span id="cb33-9"><a href="#cb33-9"></a>    OOS_data<span class="sc">$</span>t2_,</span>
<span id="cb33-10"><a href="#cb33-10"></a>    <span class="st">"day"</span>,</span>
<span id="cb33-11"><a href="#cb33-11"></a>    window_summary,</span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="at">.before =</span> before_after,</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="at">.after =</span> before_after</span>
<span id="cb33-14"><a href="#cb33-14"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'model'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">head</span>(validation_all_sliding_period_OOS, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["probability"],"name":[2],"type":["chr"],"align":["left"]},{"label":["average_time"],"name":[3],"type":["dttm"],"align":["right"]},{"label":["average_prob"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["q025"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["q25"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["q50"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["q75"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["q975"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"deepSSF","2":"habitat","3":"2018-07-29 06:09:54.173098","4":"1.023828e-04","5":"2.673227e-05","6":"7.508572e-05","7":"1.042744e-04","8":"0.0001248181","9":"0.0001747172"},{"1":"deepSSF","2":"move","3":"2018-07-29 06:09:54.173098","4":"6.004943e-02","5":"1.300750e-05","6":"3.024758e-04","7":"2.029008e-03","8":"0.0201739490","9":"0.5665996315"},{"1":"deepSSF","2":"next_step","3":"2018-07-29 06:09:54.173098","4":"5.942295e-02","5":"8.577757e-06","6":"2.835353e-04","7":"1.932343e-03","8":"0.0209164589","9":"0.5799159141"},{"1":"deepSSF_S2","2":"habitat","3":"2018-07-29 06:09:54.173098","4":"1.194888e-04","5":"8.438991e-06","6":"5.316849e-05","7":"9.425790e-05","8":"0.0001514997","9":"0.0003828910"},{"1":"deepSSF_S2","2":"move","3":"2018-07-29 06:09:54.173098","4":"7.737191e-02","5":"8.188931e-06","6":"2.739986e-04","7":"1.983298e-03","8":"0.0178765969","9":"0.7871371757"},{"1":"deepSSF_S2","2":"next_step","3":"2018-07-29 06:09:54.173098","4":"7.517658e-02","5":"4.238392e-06","6":"2.333699e-04","7":"1.852570e-03","8":"0.0175838141","9":"0.7938504633"},{"1":"ssf_0p","2":"habitat","3":"2018-07-29 06:09:54.173098","4":"9.822556e-05","5":"7.167980e-05","6":"8.638200e-05","7":"9.649995e-05","8":"0.0001058142","9":"0.0001465477"},{"1":"ssf_0p","2":"move","3":"2018-07-29 06:09:54.173098","4":"1.739303e-03","5":"3.701296e-05","6":"3.853802e-04","7":"1.241735e-03","8":"0.0031479285","9":"0.0044980502"},{"1":"ssf_0p","2":"next_step","3":"2018-07-29 06:09:54.173098","4":"1.757736e-03","5":"3.625837e-05","6":"3.793745e-04","7":"1.265333e-03","8":"0.0030174709","9":"0.0048391987"},{"1":"ssf_2p","2":"habitat","3":"2018-07-29 06:09:54.173098","4":"1.045837e-04","5":"5.502251e-05","6":"8.601408e-05","7":"1.005511e-04","8":"0.0001178061","9":"0.0001782830"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now the summaries are calculated for all out-of-sample individuals together.</p>
</section>
</section>
</section>
<section id="habitat-selection-across-the-tracking-period" class="level1">
<h1>Habitat selection across the tracking period</h1>
<section id="all-models" class="level2">
<h2 class="anchored" data-anchor-id="all-models">All models</h2>
<p>The solid coloured lines show the average probability for the focal individual that the model was fitted to, and the shaded ribbon is the 50% quantile (there is high variability between probability values, so for clarity we omitted the 95% quantiles). The thin coloured lines are the average probability values for 12 individuals that the model was not fitted to, and are therefore out-of-sample validation data. The dashed coloured lines are the mean values for each model for all of the out-of-sample individuals.</p>
<p>We also show the ‘null’ probability, i.e.&nbsp;if the selection was completely random, which is just the probability divided equally between all cells.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># if there were uniform probabilities (i.e. no selection)</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>uniform_prob <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">101</span><span class="sc">*</span><span class="dv">101</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a>ribbon_50_alpha <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>primary_linewidth <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>OOS_mean_linewidth <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>secondary_linewidth <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>  </span>
<span id="cb36-11"><a href="#cb36-11"></a>  <span class="co"># dashed lines containing the SSF probabilities (for zooming into in the paper)</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14"></a>  </span>
<span id="cb36-15"><a href="#cb36-15"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb36-16"><a href="#cb36-16"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb36-18"><a href="#cb36-18"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb36-19"><a href="#cb36-19"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb36-20"><a href="#cb36-20"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb36-21"><a href="#cb36-21"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb36-22"><a href="#cb36-22"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb36-23"><a href="#cb36-23"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb36-24"><a href="#cb36-24"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>  </span>
<span id="cb36-26"><a href="#cb36-26"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb36-27"><a href="#cb36-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb36-28"><a href="#cb36-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb36-29"><a href="#cb36-29"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb36-30"><a href="#cb36-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb36-31"><a href="#cb36-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb36-32"><a href="#cb36-32"></a>                <span class="at">colour =</span> model,</span>
<span id="cb36-33"><a href="#cb36-33"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb36-34"><a href="#cb36-34"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb36-35"><a href="#cb36-35"></a>  </span>
<span id="cb36-36"><a href="#cb36-36"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb36-37"><a href="#cb36-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb36-38"><a href="#cb36-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>),</span>
<span id="cb36-39"><a href="#cb36-39"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb36-40"><a href="#cb36-40"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb36-41"><a href="#cb36-41"></a>                <span class="at">colour =</span> model),</span>
<span id="cb36-42"><a href="#cb36-42"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb36-43"><a href="#cb36-43"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb36-44"><a href="#cb36-44"></a>  </span>
<span id="cb36-45"><a href="#cb36-45"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb36-46"><a href="#cb36-46"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb36-47"><a href="#cb36-47"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb36-48"><a href="#cb36-48"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb36-49"><a href="#cb36-49"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb36-50"><a href="#cb36-50"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb36-51"><a href="#cb36-51"></a>                <span class="at">colour =</span> model,</span>
<span id="cb36-52"><a href="#cb36-52"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb36-53"><a href="#cb36-53"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb36-54"><a href="#cb36-54"></a>  </span>
<span id="cb36-55"><a href="#cb36-55"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb36-56"><a href="#cb36-56"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb36-57"><a href="#cb36-57"></a>  </span>
<span id="cb36-58"><a href="#cb36-58"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb36-59"><a href="#cb36-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb36-60"><a href="#cb36-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb36-61"><a href="#cb36-61"></a>  </span>
<span id="cb36-62"><a href="#cb36-62"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb36-63"><a href="#cb36-63"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb36-64"><a href="#cb36-64"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb36-65"><a href="#cb36-65"></a>  </span>
<span id="cb36-66"><a href="#cb36-66"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb36-67"><a href="#cb36-67"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb36-68"><a href="#cb36-68"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-69"><a href="#cb36-69"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-70"><a href="#cb36-70"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># ggsave(paste0("outputs/validation_all_sliding_", window_width, "days.png"),</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The first thing to note is difference in magnitude between the deepSSF and the SSF predictions. The deepSSF predicted probabilities are often much higher, but can also be much lower, suggesting that the deepSSF models are more ‘confident’.</p>
<p>The deepSSF and deepSSF S2 models both performed particularly well between December 2018 and July 2019, (wet-season and early dry-season), although only the deepSSF S2 model performs well outside of this period (for most of the dry season). This suggests that the derived covariates may lack information that is relevant to buffalo during this period, such as a representation of water.</p>
<p>The higher performance of the deepSSF S2 predictions is also echoed in the out-of-sample predictions, which are generally quite a lot higher than the other models.</p>
</section>
<section id="deepssf-models" class="level2">
<h2 class="anchored" data-anchor-id="deepssf-models">deepSSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>  </span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="co"># dashed lines containing the SSF probabilities (for zooming into in the paper)</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>  </span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>                       id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb38-12"><a href="#cb38-12"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb38-13"><a href="#cb38-13"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb38-14"><a href="#cb38-14"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb38-15"><a href="#cb38-15"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb38-16"><a href="#cb38-16"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb38-17"><a href="#cb38-17"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18"></a>  </span>
<span id="cb38-19"><a href="#cb38-19"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb38-21"><a href="#cb38-21"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb38-22"><a href="#cb38-22"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb38-23"><a href="#cb38-23"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb38-24"><a href="#cb38-24"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb38-25"><a href="#cb38-25"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb38-26"><a href="#cb38-26"></a>                <span class="at">colour =</span> model,</span>
<span id="cb38-27"><a href="#cb38-27"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb38-28"><a href="#cb38-28"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb38-29"><a href="#cb38-29"></a>  </span>
<span id="cb38-30"><a href="#cb38-30"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb38-31"><a href="#cb38-31"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb38-32"><a href="#cb38-32"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb38-33"><a href="#cb38-33"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb38-34"><a href="#cb38-34"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb38-35"><a href="#cb38-35"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb38-36"><a href="#cb38-36"></a>                <span class="at">colour =</span> model),</span>
<span id="cb38-37"><a href="#cb38-37"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb38-38"><a href="#cb38-38"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb38-39"><a href="#cb38-39"></a>  </span>
<span id="cb38-40"><a href="#cb38-40"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb38-41"><a href="#cb38-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb38-42"><a href="#cb38-42"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb38-43"><a href="#cb38-43"></a>                     id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb38-44"><a href="#cb38-44"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb38-45"><a href="#cb38-45"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb38-46"><a href="#cb38-46"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb38-47"><a href="#cb38-47"></a>                <span class="at">colour =</span> model,</span>
<span id="cb38-48"><a href="#cb38-48"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb38-49"><a href="#cb38-49"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb38-50"><a href="#cb38-50"></a>  </span>
<span id="cb38-51"><a href="#cb38-51"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb38-52"><a href="#cb38-52"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb38-53"><a href="#cb38-53"></a>  </span>
<span id="cb38-54"><a href="#cb38-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb38-55"><a href="#cb38-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb38-56"><a href="#cb38-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb38-57"><a href="#cb38-57"></a>  </span>
<span id="cb38-58"><a href="#cb38-58"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb38-59"><a href="#cb38-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb38-60"><a href="#cb38-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb38-61"><a href="#cb38-61"></a>  </span>
<span id="cb38-62"><a href="#cb38-62"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb38-63"><a href="#cb38-63"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb38-64"><a href="#cb38-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-65"><a href="#cb38-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb38-66"><a href="#cb38-66"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_sliding_", window_width, "days.png"),</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ssf-models" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models">SSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  </span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb40-6"><a href="#cb40-6"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb40-7"><a href="#cb40-7"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb40-8"><a href="#cb40-8"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb40-9"><a href="#cb40-9"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb40-10"><a href="#cb40-10"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb40-11"><a href="#cb40-11"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb40-12"><a href="#cb40-12"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb40-13"><a href="#cb40-13"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14"></a>  </span>
<span id="cb40-15"><a href="#cb40-15"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb40-16"><a href="#cb40-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb40-17"><a href="#cb40-17"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb40-18"><a href="#cb40-18"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb40-19"><a href="#cb40-19"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb40-20"><a href="#cb40-20"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb40-21"><a href="#cb40-21"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb40-22"><a href="#cb40-22"></a>                <span class="at">colour =</span> model,</span>
<span id="cb40-23"><a href="#cb40-23"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb40-24"><a href="#cb40-24"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25"></a>  </span>
<span id="cb40-26"><a href="#cb40-26"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb40-27"><a href="#cb40-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb40-28"><a href="#cb40-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb40-29"><a href="#cb40-29"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb40-30"><a href="#cb40-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb40-31"><a href="#cb40-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb40-32"><a href="#cb40-32"></a>                <span class="at">colour =</span> model),</span>
<span id="cb40-33"><a href="#cb40-33"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb40-34"><a href="#cb40-34"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb40-35"><a href="#cb40-35"></a>  </span>
<span id="cb40-36"><a href="#cb40-36"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb40-37"><a href="#cb40-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb40-38"><a href="#cb40-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb40-39"><a href="#cb40-39"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb40-40"><a href="#cb40-40"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb40-41"><a href="#cb40-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb40-42"><a href="#cb40-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb40-43"><a href="#cb40-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb40-44"><a href="#cb40-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb40-45"><a href="#cb40-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb40-46"><a href="#cb40-46"></a>  </span>
<span id="cb40-47"><a href="#cb40-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb40-48"><a href="#cb40-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb40-49"><a href="#cb40-49"></a>  </span>
<span id="cb40-50"><a href="#cb40-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb40-51"><a href="#cb40-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb40-52"><a href="#cb40-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb40-53"><a href="#cb40-53"></a>  </span>
<span id="cb40-54"><a href="#cb40-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb40-55"><a href="#cb40-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb40-56"><a href="#cb40-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb40-57"><a href="#cb40-57"></a>  </span>
<span id="cb40-58"><a href="#cb40-58"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>, </span>
<span id="cb40-59"><a href="#cb40-59"></a>                     <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb40-60"><a href="#cb40-60"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb40-61"><a href="#cb40-61"></a>  </span>
<span id="cb40-62"><a href="#cb40-62"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb40-63"><a href="#cb40-63"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.6e-4</span>, <span class="fl">1.5e-4</span>)) <span class="sc">+</span></span>
<span id="cb40-64"><a href="#cb40-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-65"><a href="#cb40-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb40-66"><a href="#cb40-66"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_sliding_", window_width, "days.png"),</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There isn’t a clear seasonal trend with the SSF predictions, but in general the models do better than the null model, although the out-of-sample predictions vary around the null model.</p>
</section>
</section>
<section id="movement-probability-across-the-tracking-period" class="level1">
<h1>Movement probability across the tracking period</h1>
<section id="all-models-1" class="level2">
<h2 class="anchored" data-anchor-id="all-models-1">All models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  </span>
<span id="cb42-7"><a href="#cb42-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb42-11"><a href="#cb42-11"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb42-12"><a href="#cb42-12"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb42-13"><a href="#cb42-13"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb42-14"><a href="#cb42-14"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb42-15"><a href="#cb42-15"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb42-16"><a href="#cb42-16"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>  </span>
<span id="cb42-18"><a href="#cb42-18"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb42-19"><a href="#cb42-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb42-21"><a href="#cb42-21"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb42-22"><a href="#cb42-22"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb42-23"><a href="#cb42-23"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb42-24"><a href="#cb42-24"></a>                <span class="at">colour =</span> model,</span>
<span id="cb42-25"><a href="#cb42-25"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb42-26"><a href="#cb42-26"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27"></a>  </span>
<span id="cb42-28"><a href="#cb42-28"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb42-29"><a href="#cb42-29"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb42-30"><a href="#cb42-30"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>),</span>
<span id="cb42-31"><a href="#cb42-31"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb42-32"><a href="#cb42-32"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb42-33"><a href="#cb42-33"></a>                <span class="at">colour =</span> model),</span>
<span id="cb42-34"><a href="#cb42-34"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb42-35"><a href="#cb42-35"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36"></a>  </span>
<span id="cb42-37"><a href="#cb42-37"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb42-38"><a href="#cb42-38"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb42-39"><a href="#cb42-39"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb42-40"><a href="#cb42-40"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb42-41"><a href="#cb42-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb42-42"><a href="#cb42-42"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb42-43"><a href="#cb42-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb42-44"><a href="#cb42-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb42-45"><a href="#cb42-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb42-46"><a href="#cb42-46"></a>  </span>
<span id="cb42-47"><a href="#cb42-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb42-48"><a href="#cb42-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb42-49"><a href="#cb42-49"></a>  </span>
<span id="cb42-50"><a href="#cb42-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb42-51"><a href="#cb42-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb42-52"><a href="#cb42-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb42-53"><a href="#cb42-53"></a>  </span>
<span id="cb42-54"><a href="#cb42-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb42-55"><a href="#cb42-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb42-56"><a href="#cb42-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb42-57"><a href="#cb42-57"></a>  </span>
<span id="cb42-58"><a href="#cb42-58"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb42-59"><a href="#cb42-59"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb42-60"><a href="#cb42-60"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-61"><a href="#cb42-61"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb42-62"><a href="#cb42-62"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># ggsave(paste0("outputs/validation_all_move_sliding_", window_width, "days.png"),</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The movement probabilities for the deepSSF models are much higher than the for the SSF models, which I suspect is mostly due to the mixture of distributions in the deepSSF models. When the buffalo are in a low movement period, there can be very high probability in the few cells close to the buffalo, which is often accurate (when the predicted probability is 0.2 that means all of the probability mass is shared between only 5 cells. I don’t think the SSF movement kernel has the same flexibility to capture this.</p>
<p>This also comes out very clearly in the hourly predictions, with much higher predicted probabilities during the low movement periods.</p>
</section>
<section id="deepssf-models-1" class="level2">
<h2 class="anchored" data-anchor-id="deepssf-models-1">deepSSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  </span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">9e-3</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>  </span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>                       id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb44-12"><a href="#cb44-12"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb44-13"><a href="#cb44-13"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb44-14"><a href="#cb44-14"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb44-15"><a href="#cb44-15"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb44-16"><a href="#cb44-16"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb44-17"><a href="#cb44-17"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18"></a>  </span>
<span id="cb44-19"><a href="#cb44-19"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb44-20"><a href="#cb44-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb44-21"><a href="#cb44-21"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb44-22"><a href="#cb44-22"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb44-23"><a href="#cb44-23"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb44-24"><a href="#cb44-24"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb44-25"><a href="#cb44-25"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb44-26"><a href="#cb44-26"></a>                <span class="at">colour =</span> model,</span>
<span id="cb44-27"><a href="#cb44-27"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb44-28"><a href="#cb44-28"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb44-29"><a href="#cb44-29"></a>  </span>
<span id="cb44-30"><a href="#cb44-30"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb44-31"><a href="#cb44-31"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb44-32"><a href="#cb44-32"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb44-33"><a href="#cb44-33"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb44-34"><a href="#cb44-34"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb44-35"><a href="#cb44-35"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb44-36"><a href="#cb44-36"></a>                <span class="at">colour =</span> model),</span>
<span id="cb44-37"><a href="#cb44-37"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb44-38"><a href="#cb44-38"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb44-39"><a href="#cb44-39"></a>  </span>
<span id="cb44-40"><a href="#cb44-40"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb44-41"><a href="#cb44-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb44-42"><a href="#cb44-42"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb44-43"><a href="#cb44-43"></a>                     id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb44-44"><a href="#cb44-44"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb44-45"><a href="#cb44-45"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb44-46"><a href="#cb44-46"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb44-47"><a href="#cb44-47"></a>                <span class="at">colour =</span> model,</span>
<span id="cb44-48"><a href="#cb44-48"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb44-49"><a href="#cb44-49"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb44-50"><a href="#cb44-50"></a>  </span>
<span id="cb44-51"><a href="#cb44-51"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb44-52"><a href="#cb44-52"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb44-53"><a href="#cb44-53"></a>  </span>
<span id="cb44-54"><a href="#cb44-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb44-55"><a href="#cb44-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb44-56"><a href="#cb44-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb44-57"><a href="#cb44-57"></a>  </span>
<span id="cb44-58"><a href="#cb44-58"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb44-59"><a href="#cb44-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb44-60"><a href="#cb44-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb44-61"><a href="#cb44-61"></a>  </span>
<span id="cb44-62"><a href="#cb44-62"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb44-63"><a href="#cb44-63"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb44-64"><a href="#cb44-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb44-65"><a href="#cb44-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb44-66"><a href="#cb44-66"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_move_sliding_", window_width, "days.png"),</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ssf-models-1" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models-1">SSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  </span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb46-6"><a href="#cb46-6"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb46-7"><a href="#cb46-7"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb46-8"><a href="#cb46-8"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb46-9"><a href="#cb46-9"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb46-10"><a href="#cb46-10"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb46-11"><a href="#cb46-11"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb46-12"><a href="#cb46-12"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb46-13"><a href="#cb46-13"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>  </span>
<span id="cb46-15"><a href="#cb46-15"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb46-17"><a href="#cb46-17"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb46-18"><a href="#cb46-18"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb46-19"><a href="#cb46-19"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb46-20"><a href="#cb46-20"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb46-21"><a href="#cb46-21"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb46-22"><a href="#cb46-22"></a>                <span class="at">colour =</span> model,</span>
<span id="cb46-23"><a href="#cb46-23"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb46-24"><a href="#cb46-24"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb46-25"><a href="#cb46-25"></a>  </span>
<span id="cb46-26"><a href="#cb46-26"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb46-27"><a href="#cb46-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb46-28"><a href="#cb46-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb46-29"><a href="#cb46-29"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb46-30"><a href="#cb46-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb46-31"><a href="#cb46-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb46-32"><a href="#cb46-32"></a>                <span class="at">colour =</span> model),</span>
<span id="cb46-33"><a href="#cb46-33"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb46-34"><a href="#cb46-34"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb46-35"><a href="#cb46-35"></a>  </span>
<span id="cb46-36"><a href="#cb46-36"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb46-37"><a href="#cb46-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb46-38"><a href="#cb46-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb46-39"><a href="#cb46-39"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb46-40"><a href="#cb46-40"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb46-41"><a href="#cb46-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb46-42"><a href="#cb46-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb46-43"><a href="#cb46-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb46-44"><a href="#cb46-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb46-45"><a href="#cb46-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb46-46"><a href="#cb46-46"></a>  </span>
<span id="cb46-47"><a href="#cb46-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb46-48"><a href="#cb46-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb46-49"><a href="#cb46-49"></a>  </span>
<span id="cb46-50"><a href="#cb46-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb46-51"><a href="#cb46-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb46-52"><a href="#cb46-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb46-53"><a href="#cb46-53"></a>  </span>
<span id="cb46-54"><a href="#cb46-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb46-55"><a href="#cb46-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb46-56"><a href="#cb46-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb46-57"><a href="#cb46-57"></a>  </span>
<span id="cb46-58"><a href="#cb46-58"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>, </span>
<span id="cb46-59"><a href="#cb46-59"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb46-60"><a href="#cb46-60"></a>  </span>
<span id="cb46-61"><a href="#cb46-61"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb46-62"><a href="#cb46-62"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">9e-3</span>)) <span class="sc">+</span></span>
<span id="cb46-63"><a href="#cb46-63"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-64"><a href="#cb46-64"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb46-65"><a href="#cb46-65"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_move_sliding_", window_width, "days.png"),</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The temporally dynamic models have consistently higher probabilities of movement than the static models, which again is likely due to the concentration of the movement kernel during the low movement periods, where the probability values are distributed across much fewer cells.</p>
</section>
</section>
<section id="next-step-probabilities-across-the-tracking-period" class="level1">
<h1>Next-step probabilities across the tracking period</h1>
<p>The next-step probability values are very similar to the movement probabilities due to the concentration of the probability mass in fewer cells that are closer to the buffalo, whereas the habitat selection probabilities are distributed across all of the local layers, so they’re not actually that informative beyond the movement probabilities.</p>
<section id="all-models-2" class="level2">
<h2 class="anchored" data-anchor-id="all-models-2">All models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  </span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="co"># dashed lines containing the SSF probability values</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>  </span>
<span id="cb48-7"><a href="#cb48-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb48-8"><a href="#cb48-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb48-11"><a href="#cb48-11"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb48-12"><a href="#cb48-12"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb48-13"><a href="#cb48-13"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb48-14"><a href="#cb48-14"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb48-15"><a href="#cb48-15"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb48-16"><a href="#cb48-16"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17"></a>  </span>
<span id="cb48-18"><a href="#cb48-18"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb48-19"><a href="#cb48-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb48-20"><a href="#cb48-20"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb48-21"><a href="#cb48-21"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb48-22"><a href="#cb48-22"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb48-23"><a href="#cb48-23"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb48-24"><a href="#cb48-24"></a>                <span class="at">colour =</span> model,</span>
<span id="cb48-25"><a href="#cb48-25"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb48-26"><a href="#cb48-26"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb48-27"><a href="#cb48-27"></a>  </span>
<span id="cb48-28"><a href="#cb48-28"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb48-29"><a href="#cb48-29"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb48-30"><a href="#cb48-30"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>),</span>
<span id="cb48-31"><a href="#cb48-31"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb48-32"><a href="#cb48-32"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb48-33"><a href="#cb48-33"></a>                <span class="at">colour =</span> model),</span>
<span id="cb48-34"><a href="#cb48-34"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb48-35"><a href="#cb48-35"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb48-36"><a href="#cb48-36"></a>  </span>
<span id="cb48-37"><a href="#cb48-37"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb48-38"><a href="#cb48-38"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb48-39"><a href="#cb48-39"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb48-40"><a href="#cb48-40"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb48-41"><a href="#cb48-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb48-42"><a href="#cb48-42"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb48-43"><a href="#cb48-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb48-44"><a href="#cb48-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb48-45"><a href="#cb48-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb48-46"><a href="#cb48-46"></a>  </span>
<span id="cb48-47"><a href="#cb48-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb48-48"><a href="#cb48-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb48-49"><a href="#cb48-49"></a>  </span>
<span id="cb48-50"><a href="#cb48-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb48-51"><a href="#cb48-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb48-52"><a href="#cb48-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb48-53"><a href="#cb48-53"></a>  </span>
<span id="cb48-54"><a href="#cb48-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb48-55"><a href="#cb48-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb48-56"><a href="#cb48-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb48-57"><a href="#cb48-57"></a>  </span>
<span id="cb48-58"><a href="#cb48-58"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb48-59"><a href="#cb48-59"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb48-60"><a href="#cb48-60"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-61"><a href="#cb48-61"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb48-62"><a href="#cb48-62"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># ggsave(paste0("outputs/validation_all_next_step_sliding_", window_width, "days.png"),</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="deepssf-models-2" class="level2">
<h2 class="anchored" data-anchor-id="deepssf-models-2">deepSSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>  </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="co"># dashed lines containing the SSF probability values</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">9e-3</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6"></a>  </span>
<span id="cb50-7"><a href="#cb50-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb50-8"><a href="#cb50-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb50-10"><a href="#cb50-10"></a>                       id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb50-11"><a href="#cb50-11"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb50-12"><a href="#cb50-12"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb50-13"><a href="#cb50-13"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb50-14"><a href="#cb50-14"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb50-15"><a href="#cb50-15"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb50-16"><a href="#cb50-16"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb50-17"><a href="#cb50-17"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18"></a>  </span>
<span id="cb50-19"><a href="#cb50-19"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb50-20"><a href="#cb50-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb50-21"><a href="#cb50-21"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb50-22"><a href="#cb50-22"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb50-23"><a href="#cb50-23"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb50-24"><a href="#cb50-24"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb50-25"><a href="#cb50-25"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb50-26"><a href="#cb50-26"></a>                <span class="at">colour =</span> model,</span>
<span id="cb50-27"><a href="#cb50-27"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb50-28"><a href="#cb50-28"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb50-29"><a href="#cb50-29"></a>  </span>
<span id="cb50-30"><a href="#cb50-30"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb50-31"><a href="#cb50-31"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb50-32"><a href="#cb50-32"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb50-33"><a href="#cb50-33"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb50-34"><a href="#cb50-34"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb50-35"><a href="#cb50-35"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb50-36"><a href="#cb50-36"></a>                <span class="at">colour =</span> model),</span>
<span id="cb50-37"><a href="#cb50-37"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb50-38"><a href="#cb50-38"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb50-39"><a href="#cb50-39"></a>  </span>
<span id="cb50-40"><a href="#cb50-40"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb50-41"><a href="#cb50-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb50-42"><a href="#cb50-42"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb50-43"><a href="#cb50-43"></a>                     id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb50-44"><a href="#cb50-44"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb50-45"><a href="#cb50-45"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb50-46"><a href="#cb50-46"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb50-47"><a href="#cb50-47"></a>                <span class="at">colour =</span> model,</span>
<span id="cb50-48"><a href="#cb50-48"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb50-49"><a href="#cb50-49"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb50-50"><a href="#cb50-50"></a>  </span>
<span id="cb50-51"><a href="#cb50-51"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb50-52"><a href="#cb50-52"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb50-53"><a href="#cb50-53"></a>  </span>
<span id="cb50-54"><a href="#cb50-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb50-55"><a href="#cb50-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb50-56"><a href="#cb50-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb50-57"><a href="#cb50-57"></a>  </span>
<span id="cb50-58"><a href="#cb50-58"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb50-59"><a href="#cb50-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb50-60"><a href="#cb50-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb50-61"><a href="#cb50-61"></a>  </span>
<span id="cb50-62"><a href="#cb50-62"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb50-63"><a href="#cb50-63"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb50-64"><a href="#cb50-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb50-65"><a href="#cb50-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb50-66"><a href="#cb50-66"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_next_step_sliding_", window_width, "days.png"),</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ssf-models-2" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models-2">SSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>  </span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb52-6"><a href="#cb52-6"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb52-7"><a href="#cb52-7"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb52-8"><a href="#cb52-8"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb52-9"><a href="#cb52-9"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb52-10"><a href="#cb52-10"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb52-11"><a href="#cb52-11"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb52-12"><a href="#cb52-12"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb52-13"><a href="#cb52-13"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14"></a>  </span>
<span id="cb52-15"><a href="#cb52-15"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb52-16"><a href="#cb52-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb52-17"><a href="#cb52-17"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb52-18"><a href="#cb52-18"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb52-19"><a href="#cb52-19"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb52-20"><a href="#cb52-20"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb52-21"><a href="#cb52-21"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb52-22"><a href="#cb52-22"></a>                <span class="at">colour =</span> model,</span>
<span id="cb52-23"><a href="#cb52-23"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb52-24"><a href="#cb52-24"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb52-25"><a href="#cb52-25"></a>  </span>
<span id="cb52-26"><a href="#cb52-26"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb52-27"><a href="#cb52-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb52-28"><a href="#cb52-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb52-29"><a href="#cb52-29"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb52-30"><a href="#cb52-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb52-31"><a href="#cb52-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb52-32"><a href="#cb52-32"></a>                <span class="at">colour =</span> model),</span>
<span id="cb52-33"><a href="#cb52-33"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb52-34"><a href="#cb52-34"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb52-35"><a href="#cb52-35"></a>  </span>
<span id="cb52-36"><a href="#cb52-36"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb52-37"><a href="#cb52-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb52-38"><a href="#cb52-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb52-39"><a href="#cb52-39"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb52-40"><a href="#cb52-40"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb52-41"><a href="#cb52-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb52-42"><a href="#cb52-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb52-43"><a href="#cb52-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb52-44"><a href="#cb52-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb52-45"><a href="#cb52-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb52-46"><a href="#cb52-46"></a>  </span>
<span id="cb52-47"><a href="#cb52-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb52-48"><a href="#cb52-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb52-49"><a href="#cb52-49"></a>  </span>
<span id="cb52-50"><a href="#cb52-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb52-51"><a href="#cb52-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb52-52"><a href="#cb52-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb52-53"><a href="#cb52-53"></a>  </span>
<span id="cb52-54"><a href="#cb52-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb52-55"><a href="#cb52-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb52-56"><a href="#cb52-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb52-57"><a href="#cb52-57"></a>  </span>
<span id="cb52-58"><a href="#cb52-58"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>, </span>
<span id="cb52-59"><a href="#cb52-59"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb52-60"><a href="#cb52-60"></a>  </span>
<span id="cb52-61"><a href="#cb52-61"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb52-62"><a href="#cb52-62"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">9e-3</span>)) <span class="sc">+</span></span>
<span id="cb52-63"><a href="#cb52-63"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-64"><a href="#cb52-64"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb52-65"><a href="#cb52-65"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_next_step_sliding_", window_width, "days.png"),</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="hourly-probabilities" class="level1">
<h1>Hourly probabilities</h1>
<p>We can also calculate the habitat selection, movement and next-step probabilities for each hour of the day, indicating when the models are accurate (or notr) at different times of the day.</p>
<p>For this we don’t need a sliding window, we will just bin by the hour of the day.</p>
<p>Here we just show the hourly probabilities across the whole tracking period, but we could also split this up into seasons and assess how accurate the models are during the wet and dry seasons.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># grouping by each individual, model and hour of the day</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>validation_all_quantiles_hourly <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">group_by</span>(id, model, probability, hour_t2) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4"></a>  <span class="fu">summarise</span>(<span class="at">average_prob =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb54-5"><a href="#cb54-5"></a>            <span class="at">sd_prob =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb54-6"><a href="#cb54-6"></a>            <span class="at">q025 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb54-7"><a href="#cb54-7"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb54-8"><a href="#cb54-8"></a>            <span class="at">q50 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb54-9"><a href="#cb54-9"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb54-10"><a href="#cb54-10"></a>            <span class="at">q975 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> T)</span>
<span id="cb54-11"><a href="#cb54-11"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'id', 'model', 'probability'. You can
override using the `.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">head</span>(validation_all_quantiles_hourly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["probability"],"name":[3],"type":["chr"],"align":["left"]},{"label":["hour_t2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["average_prob"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sd_prob"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["q025"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["q25"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["q50"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["q75"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["q975"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"deepSSF","3":"habitat","4":"0","5":"0.0002485280","6":"0.0003207159","7":"2.495861e-05","8":"1.032110e-04","9":"0.0001338204","10":"0.0001933139","11":"0.001310475"},{"1":"2005","2":"deepSSF","3":"habitat","4":"1","5":"0.0002327976","6":"0.0002947584","7":"2.770755e-05","8":"9.775564e-05","9":"0.0001305555","10":"0.0001910075","11":"0.001278686"},{"1":"2005","2":"deepSSF","3":"habitat","4":"2","5":"0.0002389060","6":"0.0003048614","7":"2.691245e-05","8":"9.889237e-05","9":"0.0001324575","10":"0.0001963378","11":"0.001316071"},{"1":"2005","2":"deepSSF","3":"habitat","4":"3","5":"0.0002322502","6":"0.0003087312","7":"1.886684e-05","8":"1.035020e-04","9":"0.0001308055","10":"0.0001920978","11":"0.001356516"},{"1":"2005","2":"deepSSF","3":"habitat","4":"4","5":"0.0002413408","6":"0.0003207733","7":"2.857967e-05","8":"1.062962e-04","9":"0.0001301269","10":"0.0001870941","11":"0.001409807"},{"1":"2005","2":"deepSSF","3":"habitat","4":"5","5":"0.0002290460","6":"0.0003203935","7":"2.956573e-05","8":"1.063734e-04","9":"0.0001236291","10":"0.0001782608","11":"0.001378905"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># out-of-sample ids</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="co"># grouping by each model and hour of the day (combining all OOS individuals to get the average)</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>validation_all_quantiles_hourly_OOS <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">==</span> focal_id) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>  <span class="fu">group_by</span>(model, probability, hour_t2) <span class="sc">%&gt;%</span> </span>
<span id="cb57-6"><a href="#cb57-6"></a>  <span class="fu">summarise</span>(<span class="at">average_prob =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb57-7"><a href="#cb57-7"></a>            <span class="at">sd_prob =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb57-8"><a href="#cb57-8"></a>            <span class="at">q025 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb57-9"><a href="#cb57-9"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb57-10"><a href="#cb57-10"></a>            <span class="at">q50 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb57-11"><a href="#cb57-11"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb57-12"><a href="#cb57-12"></a>            <span class="at">q975 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> T)</span>
<span id="cb57-13"><a href="#cb57-13"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'model', 'probability'. You can override
using the `.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">head</span>(validation_all_quantiles_hourly_OOS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["probability"],"name":[2],"type":["chr"],"align":["left"]},{"label":["hour_t2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average_prob"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sd_prob"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["q025"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["q25"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["q50"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["q75"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["q975"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"deepSSF","2":"habitat","3":"0","4":"9.407951e-05","5":"1.077475e-04","6":"4.444639e-06","7":"3.733527e-05","8":"7.431017e-05","9":"0.0001250104","10":"0.0002684961"},{"1":"deepSSF","2":"habitat","3":"1","4":"9.524731e-05","5":"1.224010e-04","6":"4.441560e-06","7":"3.606480e-05","8":"7.408074e-05","9":"0.0001248238","10":"0.0002904225"},{"1":"deepSSF","2":"habitat","3":"2","4":"9.679362e-05","5":"1.190892e-04","6":"4.543338e-06","7":"3.639747e-05","8":"7.531282e-05","9":"0.0001261581","10":"0.0003080050"},{"1":"deepSSF","2":"habitat","3":"3","4":"9.886051e-05","5":"1.178414e-04","6":"4.640756e-06","7":"3.752760e-05","8":"7.945627e-05","9":"0.0001304998","10":"0.0002893189"},{"1":"deepSSF","2":"habitat","3":"4","4":"1.006873e-04","5":"1.054463e-04","6":"5.216216e-06","7":"4.174282e-05","8":"8.808522e-05","9":"0.0001351974","10":"0.0002721426"},{"1":"deepSSF","2":"habitat","3":"5","4":"1.021680e-04","5":"9.725396e-05","6":"6.813645e-06","7":"4.570566e-05","8":"9.626439e-05","9":"0.0001339199","10":"0.0002706319"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="habitat-selection-across-the-day" class="level1">
<h1>Habitat selection across the day</h1>
<section id="all-models-3" class="level2">
<h2 class="anchored" data-anchor-id="all-models-3">All models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>  </span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6"></a>  </span>
<span id="cb60-7"><a href="#cb60-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb60-8"><a href="#cb60-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="#cb60-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb60-10"><a href="#cb60-10"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb60-11"><a href="#cb60-11"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb60-12"><a href="#cb60-12"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb60-13"><a href="#cb60-13"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb60-14"><a href="#cb60-14"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb60-15"><a href="#cb60-15"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb60-16"><a href="#cb60-16"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17"></a>  </span>
<span id="cb60-18"><a href="#cb60-18"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb60-19"><a href="#cb60-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb60-20"><a href="#cb60-20"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb60-21"><a href="#cb60-21"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb60-22"><a href="#cb60-22"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb60-23"><a href="#cb60-23"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb60-24"><a href="#cb60-24"></a>                <span class="at">colour =</span> model,</span>
<span id="cb60-25"><a href="#cb60-25"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb60-26"><a href="#cb60-26"></a>            <span class="at">linewidth =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb60-27"><a href="#cb60-27"></a>  </span>
<span id="cb60-28"><a href="#cb60-28"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb60-29"><a href="#cb60-29"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb60-30"><a href="#cb60-30"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>),</span>
<span id="cb60-31"><a href="#cb60-31"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb60-32"><a href="#cb60-32"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb60-33"><a href="#cb60-33"></a>                <span class="at">colour =</span> model),</span>
<span id="cb60-34"><a href="#cb60-34"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb60-35"><a href="#cb60-35"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb60-36"><a href="#cb60-36"></a>  </span>
<span id="cb60-37"><a href="#cb60-37"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb60-38"><a href="#cb60-38"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb60-39"><a href="#cb60-39"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb60-40"><a href="#cb60-40"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb60-41"><a href="#cb60-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb60-42"><a href="#cb60-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb60-43"><a href="#cb60-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb60-44"><a href="#cb60-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb60-45"><a href="#cb60-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb60-46"><a href="#cb60-46"></a>  </span>
<span id="cb60-47"><a href="#cb60-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb60-48"><a href="#cb60-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb60-49"><a href="#cb60-49"></a>  </span>
<span id="cb60-50"><a href="#cb60-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb60-51"><a href="#cb60-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb60-52"><a href="#cb60-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb60-53"><a href="#cb60-53"></a>  </span>
<span id="cb60-54"><a href="#cb60-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb60-55"><a href="#cb60-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb60-56"><a href="#cb60-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb60-57"><a href="#cb60-57"></a>  </span>
<span id="cb60-58"><a href="#cb60-58"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb60-59"><a href="#cb60-59"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb60-60"><a href="#cb60-60"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb60-61"><a href="#cb60-61"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># ggsave(paste0("outputs/validation_all_hourly.png"),</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The deepSSF models both predict well in the evening (at least in-sample), but only the deepSSF S2 predicts well during the middle of the day, again suggesting that there is information in the Sentinel-2 layers that isn’t present in the derived covariates.</p>
<p>The out-of-sample predictions are also much higher for the deepSSF S2 model, suggesting that it is better at generalising to new data.</p>
</section>
<section id="deepssf-models-3" class="level2">
<h2 class="anchored" data-anchor-id="deepssf-models-3">deepSSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>  </span>
<span id="cb62-3"><a href="#cb62-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>  </span>
<span id="cb62-7"><a href="#cb62-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb62-10"><a href="#cb62-10"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb62-11"><a href="#cb62-11"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb62-12"><a href="#cb62-12"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb62-13"><a href="#cb62-13"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb62-14"><a href="#cb62-14"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb62-15"><a href="#cb62-15"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb62-16"><a href="#cb62-16"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb62-17"><a href="#cb62-17"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18"></a>  </span>
<span id="cb62-19"><a href="#cb62-19"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb62-20"><a href="#cb62-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb62-21"><a href="#cb62-21"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb62-22"><a href="#cb62-22"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb62-23"><a href="#cb62-23"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb62-24"><a href="#cb62-24"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb62-25"><a href="#cb62-25"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb62-26"><a href="#cb62-26"></a>                <span class="at">colour =</span> model,</span>
<span id="cb62-27"><a href="#cb62-27"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb62-28"><a href="#cb62-28"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb62-29"><a href="#cb62-29"></a>  </span>
<span id="cb62-30"><a href="#cb62-30"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb62-31"><a href="#cb62-31"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb62-32"><a href="#cb62-32"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb62-33"><a href="#cb62-33"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb62-34"><a href="#cb62-34"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb62-35"><a href="#cb62-35"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb62-36"><a href="#cb62-36"></a>                <span class="at">colour =</span> model),</span>
<span id="cb62-37"><a href="#cb62-37"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb62-38"><a href="#cb62-38"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-39"><a href="#cb62-39"></a>  </span>
<span id="cb62-40"><a href="#cb62-40"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb62-41"><a href="#cb62-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb62-42"><a href="#cb62-42"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb62-43"><a href="#cb62-43"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb62-44"><a href="#cb62-44"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb62-45"><a href="#cb62-45"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb62-46"><a href="#cb62-46"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb62-47"><a href="#cb62-47"></a>                <span class="at">colour =</span> model,</span>
<span id="cb62-48"><a href="#cb62-48"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb62-49"><a href="#cb62-49"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb62-50"><a href="#cb62-50"></a>  </span>
<span id="cb62-51"><a href="#cb62-51"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb62-52"><a href="#cb62-52"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb62-53"><a href="#cb62-53"></a>  </span>
<span id="cb62-54"><a href="#cb62-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb62-55"><a href="#cb62-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb62-56"><a href="#cb62-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb62-57"><a href="#cb62-57"></a>  </span>
<span id="cb62-58"><a href="#cb62-58"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb62-59"><a href="#cb62-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb62-60"><a href="#cb62-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb62-61"><a href="#cb62-61"></a>  </span>
<span id="cb62-62"><a href="#cb62-62"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb62-63"><a href="#cb62-63"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb62-64"><a href="#cb62-64"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4e-4</span>)) <span class="sc">+</span></span>
<span id="cb62-65"><a href="#cb62-65"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-66"><a href="#cb62-66"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_hourly.png"),</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ssf-models-3" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models-3">SSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb64-6"><a href="#cb64-6"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb64-7"><a href="#cb64-7"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb64-8"><a href="#cb64-8"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb64-9"><a href="#cb64-9"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb64-10"><a href="#cb64-10"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb64-11"><a href="#cb64-11"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb64-12"><a href="#cb64-12"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb64-13"><a href="#cb64-13"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14"></a>  </span>
<span id="cb64-15"><a href="#cb64-15"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb64-16"><a href="#cb64-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb64-17"><a href="#cb64-17"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb64-18"><a href="#cb64-18"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb64-19"><a href="#cb64-19"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb64-20"><a href="#cb64-20"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb64-21"><a href="#cb64-21"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb64-22"><a href="#cb64-22"></a>                <span class="at">colour =</span> model,</span>
<span id="cb64-23"><a href="#cb64-23"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb64-24"><a href="#cb64-24"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb64-25"><a href="#cb64-25"></a>  </span>
<span id="cb64-26"><a href="#cb64-26"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb64-27"><a href="#cb64-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb64-28"><a href="#cb64-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb64-29"><a href="#cb64-29"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb64-30"><a href="#cb64-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb64-31"><a href="#cb64-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb64-32"><a href="#cb64-32"></a>                <span class="at">colour =</span> model),</span>
<span id="cb64-33"><a href="#cb64-33"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb64-34"><a href="#cb64-34"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb64-35"><a href="#cb64-35"></a>  </span>
<span id="cb64-36"><a href="#cb64-36"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb64-37"><a href="#cb64-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb64-38"><a href="#cb64-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb64-39"><a href="#cb64-39"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb64-40"><a href="#cb64-40"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb64-41"><a href="#cb64-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb64-42"><a href="#cb64-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb64-43"><a href="#cb64-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb64-44"><a href="#cb64-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb64-45"><a href="#cb64-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb64-46"><a href="#cb64-46"></a>  </span>
<span id="cb64-47"><a href="#cb64-47"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb64-48"><a href="#cb64-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb64-49"><a href="#cb64-49"></a>  </span>
<span id="cb64-50"><a href="#cb64-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb64-51"><a href="#cb64-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb64-52"><a href="#cb64-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb64-53"><a href="#cb64-53"></a>  </span>
<span id="cb64-54"><a href="#cb64-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb64-55"><a href="#cb64-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb64-56"><a href="#cb64-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb64-57"><a href="#cb64-57"></a>  </span>
<span id="cb64-58"><a href="#cb64-58"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>,</span>
<span id="cb64-59"><a href="#cb64-59"></a>                     <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb64-60"><a href="#cb64-60"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb64-61"><a href="#cb64-61"></a>  </span>
<span id="cb64-62"><a href="#cb64-62"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb64-63"><a href="#cb64-63"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.6e-4</span>, <span class="fl">1.5e-4</span>)) <span class="sc">+</span></span>
<span id="cb64-64"><a href="#cb64-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb64-65"><a href="#cb64-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_hourly.png"),</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The SSF model with temporal dynamics had higher prediction accuracy than the SSF model without temporal dynamics overall (in- and out-of-sample), but it was more variable throughout the day, and was quite poor between midnight and about 5am.</p>
</section>
</section>
<section id="movement-probability-across-the-day" class="level1">
<h1>Movement probability across the day</h1>
<section id="all-models-4" class="level2">
<h2 class="anchored" data-anchor-id="all-models-4">All models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>  </span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6"></a>  </span>
<span id="cb66-7"><a href="#cb66-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb66-10"><a href="#cb66-10"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb66-11"><a href="#cb66-11"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb66-12"><a href="#cb66-12"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb66-13"><a href="#cb66-13"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb66-14"><a href="#cb66-14"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb66-15"><a href="#cb66-15"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb66-16"><a href="#cb66-16"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb66-17"><a href="#cb66-17"></a>  </span>
<span id="cb66-18"><a href="#cb66-18"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb66-19"><a href="#cb66-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb66-20"><a href="#cb66-20"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb66-21"><a href="#cb66-21"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb66-22"><a href="#cb66-22"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb66-23"><a href="#cb66-23"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb66-24"><a href="#cb66-24"></a>                <span class="at">colour =</span> model,</span>
<span id="cb66-25"><a href="#cb66-25"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb66-26"><a href="#cb66-26"></a>            <span class="at">linewidth =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb66-27"><a href="#cb66-27"></a>  </span>
<span id="cb66-28"><a href="#cb66-28"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb66-29"><a href="#cb66-29"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb66-30"><a href="#cb66-30"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>),</span>
<span id="cb66-31"><a href="#cb66-31"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb66-32"><a href="#cb66-32"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb66-33"><a href="#cb66-33"></a>                <span class="at">colour =</span> model),</span>
<span id="cb66-34"><a href="#cb66-34"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb66-35"><a href="#cb66-35"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb66-36"><a href="#cb66-36"></a>  </span>
<span id="cb66-37"><a href="#cb66-37"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb66-38"><a href="#cb66-38"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb66-39"><a href="#cb66-39"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb66-40"><a href="#cb66-40"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb66-41"><a href="#cb66-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb66-42"><a href="#cb66-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb66-43"><a href="#cb66-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb66-44"><a href="#cb66-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb66-45"><a href="#cb66-45"></a>            <span class="at">linewidth =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb66-46"><a href="#cb66-46"></a>  </span>
<span id="cb66-47"><a href="#cb66-47"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb66-48"><a href="#cb66-48"></a>  </span>
<span id="cb66-49"><a href="#cb66-49"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb66-50"><a href="#cb66-50"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb66-51"><a href="#cb66-51"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb66-52"><a href="#cb66-52"></a>  </span>
<span id="cb66-53"><a href="#cb66-53"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb66-54"><a href="#cb66-54"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb66-55"><a href="#cb66-55"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb66-56"><a href="#cb66-56"></a>  </span>
<span id="cb66-57"><a href="#cb66-57"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb66-58"><a href="#cb66-58"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb66-59"><a href="#cb66-59"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-60"><a href="#cb66-60"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># ggsave(paste0("outputs/validation_all_move_hourly.png"),</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The movement probabilities are much lower during the high movement periods. This is because there are many more cells that the buffalo are likely to move to, and so the probability of moving to any one cell is lower, and the model must spread the prediction probability across many more cells.</p>
<p>The SSF probabilities are also much much lower than the deepSSF probabilities, as explained for the movement probabilities across the tracking period.</p>
</section>
<section id="deepssf-models-4" class="level2">
<h2 class="anchored" data-anchor-id="deepssf-models-4">deepSSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  </span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.25e-2</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>  </span>
<span id="cb68-7"><a href="#cb68-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb68-8"><a href="#cb68-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb68-10"><a href="#cb68-10"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb68-11"><a href="#cb68-11"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb68-12"><a href="#cb68-12"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb68-13"><a href="#cb68-13"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb68-14"><a href="#cb68-14"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb68-15"><a href="#cb68-15"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb68-16"><a href="#cb68-16"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb68-17"><a href="#cb68-17"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb68-18"><a href="#cb68-18"></a>  </span>
<span id="cb68-19"><a href="#cb68-19"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb68-20"><a href="#cb68-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb68-21"><a href="#cb68-21"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb68-22"><a href="#cb68-22"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb68-23"><a href="#cb68-23"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb68-24"><a href="#cb68-24"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb68-25"><a href="#cb68-25"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb68-26"><a href="#cb68-26"></a>                <span class="at">colour =</span> model,</span>
<span id="cb68-27"><a href="#cb68-27"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb68-28"><a href="#cb68-28"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb68-29"><a href="#cb68-29"></a>  </span>
<span id="cb68-30"><a href="#cb68-30"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb68-31"><a href="#cb68-31"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb68-32"><a href="#cb68-32"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb68-33"><a href="#cb68-33"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb68-34"><a href="#cb68-34"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb68-35"><a href="#cb68-35"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb68-36"><a href="#cb68-36"></a>                <span class="at">colour =</span> model),</span>
<span id="cb68-37"><a href="#cb68-37"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb68-38"><a href="#cb68-38"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb68-39"><a href="#cb68-39"></a>  </span>
<span id="cb68-40"><a href="#cb68-40"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb68-41"><a href="#cb68-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb68-42"><a href="#cb68-42"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb68-43"><a href="#cb68-43"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb68-44"><a href="#cb68-44"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb68-45"><a href="#cb68-45"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb68-46"><a href="#cb68-46"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb68-47"><a href="#cb68-47"></a>                <span class="at">colour =</span> model,</span>
<span id="cb68-48"><a href="#cb68-48"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb68-49"><a href="#cb68-49"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb68-50"><a href="#cb68-50"></a>  </span>
<span id="cb68-51"><a href="#cb68-51"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb68-52"><a href="#cb68-52"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb68-53"><a href="#cb68-53"></a>  </span>
<span id="cb68-54"><a href="#cb68-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb68-55"><a href="#cb68-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb68-56"><a href="#cb68-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb68-57"><a href="#cb68-57"></a>  </span>
<span id="cb68-58"><a href="#cb68-58"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb68-59"><a href="#cb68-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb68-60"><a href="#cb68-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb68-61"><a href="#cb68-61"></a>  </span>
<span id="cb68-62"><a href="#cb68-62"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb68-63"><a href="#cb68-63"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb68-64"><a href="#cb68-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-65"><a href="#cb68-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_move_hourly.png"),</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ssf-models-4" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models-4">SSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>  </span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb70-6"><a href="#cb70-6"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb70-7"><a href="#cb70-7"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb70-8"><a href="#cb70-8"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb70-9"><a href="#cb70-9"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb70-10"><a href="#cb70-10"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb70-11"><a href="#cb70-11"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb70-12"><a href="#cb70-12"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb70-13"><a href="#cb70-13"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb70-14"><a href="#cb70-14"></a>  </span>
<span id="cb70-15"><a href="#cb70-15"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb70-16"><a href="#cb70-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb70-17"><a href="#cb70-17"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb70-18"><a href="#cb70-18"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb70-19"><a href="#cb70-19"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb70-20"><a href="#cb70-20"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb70-21"><a href="#cb70-21"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb70-22"><a href="#cb70-22"></a>                <span class="at">colour =</span> model,</span>
<span id="cb70-23"><a href="#cb70-23"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb70-24"><a href="#cb70-24"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb70-25"><a href="#cb70-25"></a>  </span>
<span id="cb70-26"><a href="#cb70-26"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb70-27"><a href="#cb70-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb70-28"><a href="#cb70-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb70-29"><a href="#cb70-29"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb70-30"><a href="#cb70-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb70-31"><a href="#cb70-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb70-32"><a href="#cb70-32"></a>                <span class="at">colour =</span> model),</span>
<span id="cb70-33"><a href="#cb70-33"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb70-34"><a href="#cb70-34"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb70-35"><a href="#cb70-35"></a>  </span>
<span id="cb70-36"><a href="#cb70-36"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb70-37"><a href="#cb70-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb70-38"><a href="#cb70-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb70-39"><a href="#cb70-39"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb70-40"><a href="#cb70-40"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb70-41"><a href="#cb70-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb70-42"><a href="#cb70-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb70-43"><a href="#cb70-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb70-44"><a href="#cb70-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb70-45"><a href="#cb70-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb70-46"><a href="#cb70-46"></a>  </span>
<span id="cb70-47"><a href="#cb70-47"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb70-48"><a href="#cb70-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb70-49"><a href="#cb70-49"></a>  </span>
<span id="cb70-50"><a href="#cb70-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb70-51"><a href="#cb70-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb70-52"><a href="#cb70-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb70-53"><a href="#cb70-53"></a>  </span>
<span id="cb70-54"><a href="#cb70-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb70-55"><a href="#cb70-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb70-56"><a href="#cb70-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb70-57"><a href="#cb70-57"></a>  </span>
<span id="cb70-58"><a href="#cb70-58"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>,</span>
<span id="cb70-59"><a href="#cb70-59"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb70-60"><a href="#cb70-60"></a>  </span>
<span id="cb70-61"><a href="#cb70-61"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb70-62"><a href="#cb70-62"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.25e-2</span>)) <span class="sc">+</span></span>
<span id="cb70-63"><a href="#cb70-63"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb70-64"><a href="#cb70-64"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_move_hourly.png"),</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The SSF models perform similarly, expect at night, where the temporally dynamic performs much better in- and out-of-sample.</p>
</section>
</section>
<section id="next-step-probability-across-the-day" class="level1">
<h1>Next-step probability across the day</h1>
<section id="all-models-5" class="level2">
<h2 class="anchored" data-anchor-id="all-models-5">All models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>  </span>
<span id="cb72-3"><a href="#cb72-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb72-4"><a href="#cb72-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>  </span>
<span id="cb72-7"><a href="#cb72-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb72-8"><a href="#cb72-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb72-9"><a href="#cb72-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb72-10"><a href="#cb72-10"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb72-11"><a href="#cb72-11"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb72-12"><a href="#cb72-12"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb72-13"><a href="#cb72-13"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb72-14"><a href="#cb72-14"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb72-15"><a href="#cb72-15"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb72-16"><a href="#cb72-16"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17"></a>  </span>
<span id="cb72-18"><a href="#cb72-18"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb72-19"><a href="#cb72-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb72-20"><a href="#cb72-20"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb72-21"><a href="#cb72-21"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb72-22"><a href="#cb72-22"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb72-23"><a href="#cb72-23"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb72-24"><a href="#cb72-24"></a>                <span class="at">colour =</span> model,</span>
<span id="cb72-25"><a href="#cb72-25"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb72-26"><a href="#cb72-26"></a>            <span class="at">linewidth =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb72-27"><a href="#cb72-27"></a>  </span>
<span id="cb72-28"><a href="#cb72-28"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb72-29"><a href="#cb72-29"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb72-30"><a href="#cb72-30"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb72-31"><a href="#cb72-31"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb72-32"><a href="#cb72-32"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb72-33"><a href="#cb72-33"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb72-34"><a href="#cb72-34"></a>                <span class="at">colour =</span> model),</span>
<span id="cb72-35"><a href="#cb72-35"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb72-36"><a href="#cb72-36"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb72-37"><a href="#cb72-37"></a>  </span>
<span id="cb72-38"><a href="#cb72-38"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb72-39"><a href="#cb72-39"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb72-40"><a href="#cb72-40"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb72-41"><a href="#cb72-41"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb72-42"><a href="#cb72-42"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb72-43"><a href="#cb72-43"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb72-44"><a href="#cb72-44"></a>                <span class="at">colour =</span> model,</span>
<span id="cb72-45"><a href="#cb72-45"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb72-46"><a href="#cb72-46"></a>            <span class="at">linewidth =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb72-47"><a href="#cb72-47"></a>  </span>
<span id="cb72-48"><a href="#cb72-48"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb72-49"><a href="#cb72-49"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb72-50"><a href="#cb72-50"></a>  </span>
<span id="cb72-51"><a href="#cb72-51"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb72-52"><a href="#cb72-52"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb72-53"><a href="#cb72-53"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb72-54"><a href="#cb72-54"></a>  </span>
<span id="cb72-55"><a href="#cb72-55"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb72-56"><a href="#cb72-56"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb72-57"><a href="#cb72-57"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb72-58"><a href="#cb72-58"></a>  </span>
<span id="cb72-59"><a href="#cb72-59"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb72-60"><a href="#cb72-60"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb72-61"><a href="#cb72-61"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-62"><a href="#cb72-62"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># ggsave(paste0("outputs/validation_all_next_step_hourly.png"),</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="deepssf-models-5" class="level2">
<h2 class="anchored" data-anchor-id="deepssf-models-5">deepSSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>  </span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.25e-2</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>  </span>
<span id="cb74-7"><a href="#cb74-7"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb74-8"><a href="#cb74-8"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb74-9"><a href="#cb74-9"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb74-10"><a href="#cb74-10"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb74-11"><a href="#cb74-11"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb74-12"><a href="#cb74-12"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb74-13"><a href="#cb74-13"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb74-14"><a href="#cb74-14"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb74-15"><a href="#cb74-15"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb74-16"><a href="#cb74-16"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb74-17"><a href="#cb74-17"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb74-18"><a href="#cb74-18"></a>  </span>
<span id="cb74-19"><a href="#cb74-19"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb74-20"><a href="#cb74-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb74-21"><a href="#cb74-21"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb74-22"><a href="#cb74-22"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb74-23"><a href="#cb74-23"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb74-24"><a href="#cb74-24"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb74-25"><a href="#cb74-25"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb74-26"><a href="#cb74-26"></a>                <span class="at">colour =</span> model,</span>
<span id="cb74-27"><a href="#cb74-27"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb74-28"><a href="#cb74-28"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb74-29"><a href="#cb74-29"></a>  </span>
<span id="cb74-30"><a href="#cb74-30"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb74-31"><a href="#cb74-31"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb74-32"><a href="#cb74-32"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb74-33"><a href="#cb74-33"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb74-34"><a href="#cb74-34"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb74-35"><a href="#cb74-35"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb74-36"><a href="#cb74-36"></a>                <span class="at">colour =</span> model),</span>
<span id="cb74-37"><a href="#cb74-37"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb74-38"><a href="#cb74-38"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb74-39"><a href="#cb74-39"></a>  </span>
<span id="cb74-40"><a href="#cb74-40"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb74-41"><a href="#cb74-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb74-42"><a href="#cb74-42"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb74-43"><a href="#cb74-43"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb74-44"><a href="#cb74-44"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb74-45"><a href="#cb74-45"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb74-46"><a href="#cb74-46"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb74-47"><a href="#cb74-47"></a>                <span class="at">colour =</span> model,</span>
<span id="cb74-48"><a href="#cb74-48"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb74-49"><a href="#cb74-49"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb74-50"><a href="#cb74-50"></a>  </span>
<span id="cb74-51"><a href="#cb74-51"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb74-52"><a href="#cb74-52"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb74-53"><a href="#cb74-53"></a>  </span>
<span id="cb74-54"><a href="#cb74-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb74-55"><a href="#cb74-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb74-56"><a href="#cb74-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb74-57"><a href="#cb74-57"></a>  </span>
<span id="cb74-58"><a href="#cb74-58"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb74-59"><a href="#cb74-59"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb74-60"><a href="#cb74-60"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb74-61"><a href="#cb74-61"></a>  </span>
<span id="cb74-62"><a href="#cb74-62"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb74-63"><a href="#cb74-63"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb74-64"><a href="#cb74-64"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb74-65"><a href="#cb74-65"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_next_step_hourly.png"),</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ssf-models-5" class="level2">
<h2 class="anchored" data-anchor-id="ssf-models-5">SSF models</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>  </span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb76-6"><a href="#cb76-6"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb76-7"><a href="#cb76-7"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb76-8"><a href="#cb76-8"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb76-9"><a href="#cb76-9"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb76-10"><a href="#cb76-10"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb76-11"><a href="#cb76-11"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb76-12"><a href="#cb76-12"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb76-13"><a href="#cb76-13"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb76-14"><a href="#cb76-14"></a>  </span>
<span id="cb76-15"><a href="#cb76-15"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb76-16"><a href="#cb76-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb76-17"><a href="#cb76-17"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb76-18"><a href="#cb76-18"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb76-19"><a href="#cb76-19"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb76-20"><a href="#cb76-20"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb76-21"><a href="#cb76-21"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb76-22"><a href="#cb76-22"></a>                <span class="at">colour =</span> model,</span>
<span id="cb76-23"><a href="#cb76-23"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb76-24"><a href="#cb76-24"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb76-25"><a href="#cb76-25"></a>  </span>
<span id="cb76-26"><a href="#cb76-26"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb76-27"><a href="#cb76-27"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb76-28"><a href="#cb76-28"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb76-29"><a href="#cb76-29"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb76-30"><a href="#cb76-30"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb76-31"><a href="#cb76-31"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb76-32"><a href="#cb76-32"></a>                <span class="at">colour =</span> model),</span>
<span id="cb76-33"><a href="#cb76-33"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb76-34"><a href="#cb76-34"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb76-35"><a href="#cb76-35"></a>  </span>
<span id="cb76-36"><a href="#cb76-36"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb76-37"><a href="#cb76-37"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb76-38"><a href="#cb76-38"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb76-39"><a href="#cb76-39"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb76-40"><a href="#cb76-40"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb76-41"><a href="#cb76-41"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb76-42"><a href="#cb76-42"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb76-43"><a href="#cb76-43"></a>                <span class="at">colour =</span> model,</span>
<span id="cb76-44"><a href="#cb76-44"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb76-45"><a href="#cb76-45"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb76-46"><a href="#cb76-46"></a>  </span>
<span id="cb76-47"><a href="#cb76-47"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb76-48"><a href="#cb76-48"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb76-49"><a href="#cb76-49"></a>  </span>
<span id="cb76-50"><a href="#cb76-50"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb76-51"><a href="#cb76-51"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb76-52"><a href="#cb76-52"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb76-53"><a href="#cb76-53"></a>  </span>
<span id="cb76-54"><a href="#cb76-54"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb76-55"><a href="#cb76-55"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb76-56"><a href="#cb76-56"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb76-57"><a href="#cb76-57"></a>  </span>
<span id="cb76-58"><a href="#cb76-58"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>,</span>
<span id="cb76-59"><a href="#cb76-59"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb76-60"><a href="#cb76-60"></a>  </span>
<span id="cb76-61"><a href="#cb76-61"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb76-62"><a href="#cb76-62"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.25e-2</span>)) <span class="sc">+</span></span>
<span id="cb76-63"><a href="#cb76-63"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb76-64"><a href="#cb76-64"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="validation_comparison_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_next_step_hourly.png"),</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ssf_validation.html" class="pagination-link" aria-label="SSF Validation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">SSF Validation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb78" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">---</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="an">title:</span><span class="co"> "Comparing SSF and deepSSF Predictions"</span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="an">author:</span></span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="co">  - name: Scott Forrest</span></span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="co">    url: https://swforrest.github.io/</span></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="co">    orcid: 0000-0001-9529-0108</span></span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="co">    affiliation: Queensland University of Technology, CSIRO</span></span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="co">    email: "scottwforrest@gmail.com"</span></span>
<span id="cb78-9"><a href="#cb78-9"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="co">  cache: false</span></span>
<span id="cb78-12"><a href="#cb78-12"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb78-13"><a href="#cb78-13"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb78-14"><a href="#cb78-14"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb78-15"><a href="#cb78-15"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb78-16"><a href="#cb78-16"></a><span class="co">  html:</span></span>
<span id="cb78-17"><a href="#cb78-17"></a><span class="co">    # self-contained: true</span></span>
<span id="cb78-18"><a href="#cb78-18"></a><span class="co">    code-fold: show</span></span>
<span id="cb78-19"><a href="#cb78-19"></a><span class="co">    code-tools: true</span></span>
<span id="cb78-20"><a href="#cb78-20"></a><span class="co">    df-print: paged</span></span>
<span id="cb78-21"><a href="#cb78-21"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb78-22"><a href="#cb78-22"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb78-23"><a href="#cb78-23"></a><span class="co">    fig-format: png</span></span>
<span id="cb78-24"><a href="#cb78-24"></a><span class="co">    fig-dpi: 300</span></span>
<span id="cb78-25"><a href="#cb78-25"></a><span class="co">  pdf:</span></span>
<span id="cb78-26"><a href="#cb78-26"></a><span class="co">    geometry: </span></span>
<span id="cb78-27"><a href="#cb78-27"></a><span class="co">      - top=30mm</span></span>
<span id="cb78-28"><a href="#cb78-28"></a><span class="co">      - left=30mm</span></span>
<span id="cb78-29"><a href="#cb78-29"></a><span class="an">editor:</span></span>
<span id="cb78-30"><a href="#cb78-30"></a><span class="co">  source</span></span>
<span id="cb78-31"><a href="#cb78-31"></a><span class="an">abstract:</span><span class="co"> |</span></span>
<span id="cb78-32"><a href="#cb78-32"></a><span class="co">  In this script we are comparing the nezt-step ahead predictions of the SSF (with and without temporal dynamics) and deepSSF models. We are comparing the probabilities of movement, habitat selection and next-step selection, and how they change throughout time.</span></span>
<span id="cb78-33"><a href="#cb78-33"></a><span class="co">  </span></span>
<span id="cb78-34"><a href="#cb78-34"></a><span class="co">  By comparing the predictions of each process across the entire tracking period or for each hour of the day, we can critically evaluate the covariates that are used by the models and allow for model refinement. </span></span>
<span id="cb78-35"><a href="#cb78-35"></a><span class="co">  </span></span>
<span id="cb78-36"><a href="#cb78-36"></a><span class="co">  As we expected, the deepSSF models outperformed the SSF models on the in-sample data, which was particularly the case for when the model was trained with Sentinel-2 spectral bands and slope as the spatial covariates (deepSSF S2). The performance dropped for out-of-sample data for all models (including SSFs), and the deepSSF trained with the derived covariates (NDVI, canopy cover, herbaceous vegetation and slope) performed worse than the SSF models, and was only marginally better than a null model, which bears some evidence of overfitting. However, the deepSSF S2 model, trained on `raw' Sentinel-2 layers rather than derived quantities, retained greater accuracy than all other approaches for out-of-sample data, suggesting that these inputs contain more information that is relevant to buffalo movement and habitat selection than derived quantities like NDVI and slope.</span></span>
<span id="cb78-37"><a href="#cb78-37"></a><span class="co">---</span></span>
<span id="cb78-38"><a href="#cb78-38"></a></span>
<span id="cb78-39"><a href="#cb78-39"></a><span class="fu">## Loading packages</span></span>
<span id="cb78-40"><a href="#cb78-40"></a></span>
<span id="cb78-43"><a href="#cb78-43"></a><span class="in">```{r}</span></span>
<span id="cb78-44"><a href="#cb78-44"></a><span class="co">#| warning=FALSE</span></span>
<span id="cb78-45"><a href="#cb78-45"></a></span>
<span id="cb78-46"><a href="#cb78-46"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb78-47"><a href="#cb78-47"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"amt"</span>, <span class="st">"sf"</span>, <span class="st">"terra"</span>, <span class="st">"beepr"</span>, <span class="st">"tictoc"</span>, <span class="st">"circular"</span>, </span>
<span id="cb78-48"><a href="#cb78-48"></a>              <span class="st">"matrixStats"</span>, <span class="st">"progress"</span>, <span class="st">"paletteer"</span>, <span class="st">"slider"</span>)</span>
<span id="cb78-49"><a href="#cb78-49"></a><span class="fu">walk</span>(packages, require, <span class="at">character.only =</span> T)</span>
<span id="cb78-50"><a href="#cb78-50"></a></span>
<span id="cb78-51"><a href="#cb78-51"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)  <span class="co"># Prevent scientific notation in plots</span></span>
<span id="cb78-52"><a href="#cb78-52"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">0</span>)  <span class="co"># Reset</span></span>
<span id="cb78-53"><a href="#cb78-53"></a></span>
<span id="cb78-54"><a href="#cb78-54"></a><span class="in">```</span></span>
<span id="cb78-55"><a href="#cb78-55"></a></span>
<span id="cb78-56"><a href="#cb78-56"></a><span class="fu">## Script setup</span></span>
<span id="cb78-57"><a href="#cb78-57"></a></span>
<span id="cb78-58"><a href="#cb78-58"></a>Specify the focal id for selecting the in-sample predictions.</span>
<span id="cb78-59"><a href="#cb78-59"></a></span>
<span id="cb78-62"><a href="#cb78-62"></a><span class="in">```{r}</span></span>
<span id="cb78-63"><a href="#cb78-63"></a>focal_id <span class="ot">&lt;-</span> <span class="dv">2005</span></span>
<span id="cb78-64"><a href="#cb78-64"></a></span>
<span id="cb78-65"><a href="#cb78-65"></a><span class="in">```</span></span>
<span id="cb78-66"><a href="#cb78-66"></a></span>
<span id="cb78-67"><a href="#cb78-67"></a><span class="fu"># Step selection function probabilities</span></span>
<span id="cb78-68"><a href="#cb78-68"></a></span>
<span id="cb78-69"><a href="#cb78-69"></a><span class="fu">## SSF models fitted with and without temporal dynamics</span></span>
<span id="cb78-70"><a href="#cb78-70"></a></span>
<span id="cb78-73"><a href="#cb78-73"></a><span class="in">```{r}</span></span>
<span id="cb78-74"><a href="#cb78-74"></a><span class="co">#| message=FALSE</span></span>
<span id="cb78-75"><a href="#cb78-75"></a></span>
<span id="cb78-76"><a href="#cb78-76"></a><span class="co"># create vector of GPS data filenames</span></span>
<span id="cb78-77"><a href="#cb78-77"></a>validation_ssf <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"outputs/next_step_validation"</span>, <span class="at">pattern =</span> <span class="st">"next_step_probs_ssf_id"</span>) </span>
<span id="cb78-78"><a href="#cb78-78"></a>validation_ids <span class="ot">&lt;-</span> <span class="fu">substr</span>(validation_ssf, <span class="dv">23</span>, <span class="dv">26</span>)</span>
<span id="cb78-79"><a href="#cb78-79"></a></span>
<span id="cb78-80"><a href="#cb78-80"></a><span class="co"># import data</span></span>
<span id="cb78-81"><a href="#cb78-81"></a>validation_ssf_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(validation_ssf))</span>
<span id="cb78-82"><a href="#cb78-82"></a></span>
<span id="cb78-83"><a href="#cb78-83"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(validation_ssf)){</span>
<span id="cb78-84"><a href="#cb78-84"></a>  validation_ssf_list[[i]] <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="fu">paste</span>(<span class="st">"outputs/next_step_validation/"</span>,</span>
<span id="cb78-85"><a href="#cb78-85"></a>                                             validation_ssf[[i]], </span>
<span id="cb78-86"><a href="#cb78-86"></a>                                             <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb78-87"><a href="#cb78-87"></a>  </span>
<span id="cb78-88"><a href="#cb78-88"></a>  <span class="co"># validation_ssf_list[i]$id &lt;- validation_ids[i]</span></span>
<span id="cb78-89"><a href="#cb78-89"></a>  <span class="fu">attr</span>(validation_ssf_list[[i]]<span class="sc">$</span>t_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb78-90"><a href="#cb78-90"></a>  <span class="fu">attr</span>(validation_ssf_list[[i]]<span class="sc">$</span>t2_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb78-91"><a href="#cb78-91"></a>  </span>
<span id="cb78-92"><a href="#cb78-92"></a>  <span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(validation_ssf_list[[i]]<span class="sc">$</span>prob_next_step_ssf_0p)))</span>
<span id="cb78-93"><a href="#cb78-93"></a>  </span>
<span id="cb78-94"><a href="#cb78-94"></a>}</span>
<span id="cb78-95"><a href="#cb78-95"></a></span>
<span id="cb78-96"><a href="#cb78-96"></a><span class="co"># check that the data has been imported correctly</span></span>
<span id="cb78-97"><a href="#cb78-97"></a><span class="co"># validation_ssf_list</span></span>
<span id="cb78-98"><a href="#cb78-98"></a></span>
<span id="cb78-99"><a href="#cb78-99"></a>validation_ssf_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_ssf_list)</span>
<span id="cb78-100"><a href="#cb78-100"></a></span>
<span id="cb78-101"><a href="#cb78-101"></a><span class="in">```</span></span>
<span id="cb78-102"><a href="#cb78-102"></a></span>
<span id="cb78-103"><a href="#cb78-103"></a><span class="fu">### Lengthening data frames to stack together for plotting</span></span>
<span id="cb78-104"><a href="#cb78-104"></a></span>
<span id="cb78-107"><a href="#cb78-107"></a><span class="in">```{r}</span></span>
<span id="cb78-108"><a href="#cb78-108"></a>validation_ssf_move <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-109"><a href="#cb78-109"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"prob_movement"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-110"><a href="#cb78-110"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"movement"</span>),</span>
<span id="cb78-111"><a href="#cb78-111"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb78-112"><a href="#cb78-112"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-113"><a href="#cb78-113"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">gsub</span>(<span class="st">"prob_movement_"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb78-114"><a href="#cb78-114"></a>         <span class="at">probability =</span> <span class="st">"move"</span>,</span>
<span id="cb78-115"><a href="#cb78-115"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb78-116"><a href="#cb78-116"></a></span>
<span id="cb78-117"><a href="#cb78-117"></a>validation_ssf_habitat <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-118"><a href="#cb78-118"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"prob_habitat"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-119"><a href="#cb78-119"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"habitat"</span>),</span>
<span id="cb78-120"><a href="#cb78-120"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb78-121"><a href="#cb78-121"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-122"><a href="#cb78-122"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">gsub</span>(<span class="st">"prob_habitat_"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb78-123"><a href="#cb78-123"></a>         <span class="at">probability =</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-124"><a href="#cb78-124"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb78-125"><a href="#cb78-125"></a></span>
<span id="cb78-126"><a href="#cb78-126"></a>validation_ssf_next_step <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span></span>
<span id="cb78-127"><a href="#cb78-127"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"prob_next_step"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-128"><a href="#cb78-128"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"next_step"</span>),</span>
<span id="cb78-129"><a href="#cb78-129"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb78-130"><a href="#cb78-130"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-131"><a href="#cb78-131"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">gsub</span>(<span class="st">"prob_next_step_"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb78-132"><a href="#cb78-132"></a>         <span class="at">probability =</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-133"><a href="#cb78-133"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb78-134"><a href="#cb78-134"></a></span>
<span id="cb78-135"><a href="#cb78-135"></a>validation_ssf_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_ssf_move,</span>
<span id="cb78-136"><a href="#cb78-136"></a>                                 validation_ssf_habitat,</span>
<span id="cb78-137"><a href="#cb78-137"></a>                                 validation_ssf_next_step)</span>
<span id="cb78-138"><a href="#cb78-138"></a></span>
<span id="cb78-139"><a href="#cb78-139"></a><span class="fu">head</span>(validation_ssf_long)</span>
<span id="cb78-140"><a href="#cb78-140"></a></span>
<span id="cb78-141"><a href="#cb78-141"></a><span class="in">```</span></span>
<span id="cb78-142"><a href="#cb78-142"></a></span>
<span id="cb78-143"><a href="#cb78-143"></a><span class="fu"># deepSSF probabilities</span></span>
<span id="cb78-144"><a href="#cb78-144"></a></span>
<span id="cb78-147"><a href="#cb78-147"></a><span class="in">```{r}</span></span>
<span id="cb78-148"><a href="#cb78-148"></a><span class="co">#| message=FALSE</span></span>
<span id="cb78-149"><a href="#cb78-149"></a></span>
<span id="cb78-150"><a href="#cb78-150"></a><span class="co"># create vector of GPS data filenames</span></span>
<span id="cb78-151"><a href="#cb78-151"></a>validation_deepssf <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"outputs/next_step_validation"</span>, <span class="at">pattern =</span> <span class="st">"next_step_probs_TAmix"</span>) </span>
<span id="cb78-152"><a href="#cb78-152"></a>validation_ids <span class="ot">&lt;-</span> <span class="fu">substr</span>(validation_deepssf, <span class="dv">25</span>, <span class="dv">28</span>)</span>
<span id="cb78-153"><a href="#cb78-153"></a></span>
<span id="cb78-154"><a href="#cb78-154"></a><span class="co"># import data</span></span>
<span id="cb78-155"><a href="#cb78-155"></a>validation_deepssf_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(validation_deepssf))</span>
<span id="cb78-156"><a href="#cb78-156"></a></span>
<span id="cb78-157"><a href="#cb78-157"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(validation_deepssf)){</span>
<span id="cb78-158"><a href="#cb78-158"></a>  validation_deepssf_list[[i]] <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="fu">paste</span>(<span class="st">"outputs/next_step_validation/"</span>,</span>
<span id="cb78-159"><a href="#cb78-159"></a>                                             validation_deepssf[[i]], </span>
<span id="cb78-160"><a href="#cb78-160"></a>                                             <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb78-161"><a href="#cb78-161"></a>  </span>
<span id="cb78-162"><a href="#cb78-162"></a>  <span class="co"># validation_deepssf_list[i]$id &lt;- validation_ids[i]</span></span>
<span id="cb78-163"><a href="#cb78-163"></a>  <span class="fu">attr</span>(validation_deepssf_list[[i]]<span class="sc">$</span>t_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb78-164"><a href="#cb78-164"></a>  <span class="fu">attr</span>(validation_deepssf_list[[i]]<span class="sc">$</span>t2_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb78-165"><a href="#cb78-165"></a>  </span>
<span id="cb78-166"><a href="#cb78-166"></a>}</span>
<span id="cb78-167"><a href="#cb78-167"></a></span>
<span id="cb78-168"><a href="#cb78-168"></a><span class="co"># To check that the data has been imported correctly</span></span>
<span id="cb78-169"><a href="#cb78-169"></a><span class="co"># validation_deepssf_list</span></span>
<span id="cb78-170"><a href="#cb78-170"></a></span>
<span id="cb78-171"><a href="#cb78-171"></a>validation_deepssf_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_deepssf_list)</span>
<span id="cb78-172"><a href="#cb78-172"></a></span>
<span id="cb78-173"><a href="#cb78-173"></a><span class="in">```</span></span>
<span id="cb78-174"><a href="#cb78-174"></a></span>
<span id="cb78-175"><a href="#cb78-175"></a><span class="fu">### Lengthening data frames to stack together for plotting</span></span>
<span id="cb78-176"><a href="#cb78-176"></a></span>
<span id="cb78-179"><a href="#cb78-179"></a><span class="in">```{r}</span></span>
<span id="cb78-180"><a href="#cb78-180"></a>validation_deepssf_long <span class="ot">&lt;-</span> validation_deepssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-181"><a href="#cb78-181"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"probs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-182"><a href="#cb78-182"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"probs"</span>),</span>
<span id="cb78-183"><a href="#cb78-183"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb78-184"><a href="#cb78-184"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-185"><a href="#cb78-185"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"deepSSF"</span>,</span>
<span id="cb78-186"><a href="#cb78-186"></a>         <span class="at">probability =</span> <span class="fu">gsub</span>(<span class="st">"_probs"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb78-187"><a href="#cb78-187"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb78-188"><a href="#cb78-188"></a></span>
<span id="cb78-189"><a href="#cb78-189"></a><span class="in">```</span></span>
<span id="cb78-190"><a href="#cb78-190"></a></span>
<span id="cb78-191"><a href="#cb78-191"></a><span class="fu"># deepSSF Sentinel 2 probabilities</span></span>
<span id="cb78-192"><a href="#cb78-192"></a></span>
<span id="cb78-195"><a href="#cb78-195"></a><span class="in">```{r}</span></span>
<span id="cb78-196"><a href="#cb78-196"></a><span class="co">#| message=FALSE</span></span>
<span id="cb78-197"><a href="#cb78-197"></a></span>
<span id="cb78-198"><a href="#cb78-198"></a><span class="co"># create vector of GPS data filenames</span></span>
<span id="cb78-199"><a href="#cb78-199"></a>validation_deepssf_s2 <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"outputs/next_step_validation"</span>, <span class="at">pattern =</span> <span class="st">"next_step_probs_S2"</span>) </span>
<span id="cb78-200"><a href="#cb78-200"></a>validation_ids <span class="ot">&lt;-</span> <span class="fu">substr</span>(validation_deepssf_s2, <span class="dv">22</span>, <span class="dv">25</span>)</span>
<span id="cb78-201"><a href="#cb78-201"></a></span>
<span id="cb78-202"><a href="#cb78-202"></a><span class="co"># import data</span></span>
<span id="cb78-203"><a href="#cb78-203"></a>validation_deepssf_s2_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(validation_deepssf_s2))</span>
<span id="cb78-204"><a href="#cb78-204"></a></span>
<span id="cb78-205"><a href="#cb78-205"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(validation_deepssf_s2)){</span>
<span id="cb78-206"><a href="#cb78-206"></a>  validation_deepssf_s2_list[[i]] <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="fu">paste</span>(<span class="st">"outputs/next_step_validation/"</span>,</span>
<span id="cb78-207"><a href="#cb78-207"></a>                                             validation_deepssf_s2[[i]], </span>
<span id="cb78-208"><a href="#cb78-208"></a>                                             <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb78-209"><a href="#cb78-209"></a>  </span>
<span id="cb78-210"><a href="#cb78-210"></a>  <span class="co"># validation_deepssf_s2_list[i]$id &lt;- validation_ids[i]</span></span>
<span id="cb78-211"><a href="#cb78-211"></a>  <span class="fu">attr</span>(validation_deepssf_s2_list[[i]]<span class="sc">$</span>t_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb78-212"><a href="#cb78-212"></a>  <span class="fu">attr</span>(validation_deepssf_s2_list[[i]]<span class="sc">$</span>t2_, <span class="st">"tzone"</span>) <span class="ot">&lt;-</span> <span class="st">"Australia/Queensland"</span></span>
<span id="cb78-213"><a href="#cb78-213"></a>  </span>
<span id="cb78-214"><a href="#cb78-214"></a>}</span>
<span id="cb78-215"><a href="#cb78-215"></a></span>
<span id="cb78-216"><a href="#cb78-216"></a><span class="co"># To check that the data has been imported correctly</span></span>
<span id="cb78-217"><a href="#cb78-217"></a><span class="co"># validation_deepssf_s2_list</span></span>
<span id="cb78-218"><a href="#cb78-218"></a></span>
<span id="cb78-219"><a href="#cb78-219"></a>validation_deepssf_s2_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_deepssf_s2_list)</span>
<span id="cb78-220"><a href="#cb78-220"></a></span>
<span id="cb78-221"><a href="#cb78-221"></a><span class="in">```</span></span>
<span id="cb78-222"><a href="#cb78-222"></a></span>
<span id="cb78-223"><a href="#cb78-223"></a><span class="fu">### Lengthening data frames to stack together for plotting</span></span>
<span id="cb78-224"><a href="#cb78-224"></a></span>
<span id="cb78-227"><a href="#cb78-227"></a><span class="in">```{r}</span></span>
<span id="cb78-228"><a href="#cb78-228"></a>validation_deepssf_s2_long <span class="ot">&lt;-</span> validation_deepssf_s2_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-229"><a href="#cb78-229"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, x_, y_, t_, x2_, y2_, t2_, hour_t2, yday_t2, year_t2, <span class="fu">contains</span>(<span class="st">"probs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-230"><a href="#cb78-230"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"probs"</span>),</span>
<span id="cb78-231"><a href="#cb78-231"></a>               <span class="at">names_to =</span> <span class="st">"full_name"</span>,</span>
<span id="cb78-232"><a href="#cb78-232"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-233"><a href="#cb78-233"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"deepSSF_S2"</span>,</span>
<span id="cb78-234"><a href="#cb78-234"></a>         <span class="at">probability =</span> <span class="fu">gsub</span>(<span class="st">"_probs"</span>, <span class="st">""</span>, full_name),</span>
<span id="cb78-235"><a href="#cb78-235"></a>         <span class="at">.after =</span> <span class="st">"full_name"</span>)</span>
<span id="cb78-236"><a href="#cb78-236"></a></span>
<span id="cb78-237"><a href="#cb78-237"></a><span class="in">```</span></span>
<span id="cb78-238"><a href="#cb78-238"></a></span>
<span id="cb78-239"><a href="#cb78-239"></a><span class="fu"># Compare the probabilities</span></span>
<span id="cb78-240"><a href="#cb78-240"></a></span>
<span id="cb78-241"><a href="#cb78-241"></a><span class="fu">## Combine the wide data frames</span></span>
<span id="cb78-242"><a href="#cb78-242"></a></span>
<span id="cb78-243"><a href="#cb78-243"></a><span class="fu">### Keep only the relevant columns</span></span>
<span id="cb78-244"><a href="#cb78-244"></a></span>
<span id="cb78-247"><a href="#cb78-247"></a><span class="in">```{r}</span></span>
<span id="cb78-248"><a href="#cb78-248"></a>validation_ssf_clean <span class="ot">&lt;-</span> validation_ssf_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-249"><a href="#cb78-249"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span>
<span id="cb78-250"><a href="#cb78-250"></a>                  prob_habitat_ssf_0p, prob_habitat_ssf_2p, </span>
<span id="cb78-251"><a href="#cb78-251"></a>                  prob_movement_ssf_0p, prob_movement_ssf_2p,</span>
<span id="cb78-252"><a href="#cb78-252"></a>                  prob_next_step_ssf_0p, prob_next_step_ssf_2p))</span>
<span id="cb78-253"><a href="#cb78-253"></a></span>
<span id="cb78-254"><a href="#cb78-254"></a>validation_deepssf_clean <span class="ot">&lt;-</span> validation_deepssf_all <span class="sc">%&gt;%</span></span>
<span id="cb78-255"><a href="#cb78-255"></a>  <span class="fu">mutate</span>(<span class="at">habitat_deepSSF =</span> habitat_probs,</span>
<span id="cb78-256"><a href="#cb78-256"></a>         <span class="at">movement_deepSSF =</span> move_probs,</span>
<span id="cb78-257"><a href="#cb78-257"></a>         <span class="at">next_step_deepSSF =</span> next_step_probs,</span>
<span id="cb78-258"><a href="#cb78-258"></a>         <span class="at">.keep =</span> <span class="st">"none"</span>)</span>
<span id="cb78-259"><a href="#cb78-259"></a></span>
<span id="cb78-260"><a href="#cb78-260"></a>validation_deepssf_s2_clean <span class="ot">&lt;-</span> validation_deepssf_s2_all <span class="sc">%&gt;%</span></span>
<span id="cb78-261"><a href="#cb78-261"></a>  <span class="fu">mutate</span>(<span class="at">habitat_deepSSF_S2 =</span> habitat_probs,</span>
<span id="cb78-262"><a href="#cb78-262"></a>         <span class="at">movement_deepSSF_S2 =</span> move_probs,</span>
<span id="cb78-263"><a href="#cb78-263"></a>         <span class="at">next_step_deepSSF_S2 =</span> next_step_probs,</span>
<span id="cb78-264"><a href="#cb78-264"></a>         <span class="at">.keep =</span> <span class="st">"none"</span>)</span>
<span id="cb78-265"><a href="#cb78-265"></a></span>
<span id="cb78-266"><a href="#cb78-266"></a><span class="in">```</span></span>
<span id="cb78-267"><a href="#cb78-267"></a></span>
<span id="cb78-268"><a href="#cb78-268"></a><span class="fu">### Combine the data frames</span></span>
<span id="cb78-269"><a href="#cb78-269"></a></span>
<span id="cb78-272"><a href="#cb78-272"></a><span class="in">```{r}</span></span>
<span id="cb78-273"><a href="#cb78-273"></a>validation_all <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(validation_ssf_clean,</span>
<span id="cb78-274"><a href="#cb78-274"></a>                            validation_deepssf_clean,</span>
<span id="cb78-275"><a href="#cb78-275"></a>                            validation_deepssf_s2_clean)</span>
<span id="cb78-276"><a href="#cb78-276"></a></span>
<span id="cb78-277"><a href="#cb78-277"></a><span class="in">```</span></span>
<span id="cb78-278"><a href="#cb78-278"></a></span>
<span id="cb78-279"><a href="#cb78-279"></a><span class="fu">## Split in habitat selection, movement and next step probabilities</span></span>
<span id="cb78-280"><a href="#cb78-280"></a></span>
<span id="cb78-281"><a href="#cb78-281"></a><span class="fu">### Function to get the maximum probability</span></span>
<span id="cb78-282"><a href="#cb78-282"></a></span>
<span id="cb78-285"><a href="#cb78-285"></a><span class="in">```{r}</span></span>
<span id="cb78-286"><a href="#cb78-286"></a>get_max_column <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb78-287"><a href="#cb78-287"></a>  <span class="co"># Create a new column with the name of the column containing the max value for each row</span></span>
<span id="cb78-288"><a href="#cb78-288"></a>  df<span class="sc">$</span>max_column <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb78-289"><a href="#cb78-289"></a>    <span class="co"># Find the column name with the maximum value</span></span>
<span id="cb78-290"><a href="#cb78-290"></a>    col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(df)</span>
<span id="cb78-291"><a href="#cb78-291"></a>    max_col_index <span class="ot">&lt;-</span> <span class="fu">which.max</span>(row)</span>
<span id="cb78-292"><a href="#cb78-292"></a>    <span class="fu">return</span>(col_names[max_col_index])</span>
<span id="cb78-293"><a href="#cb78-293"></a>  })</span>
<span id="cb78-294"><a href="#cb78-294"></a>  </span>
<span id="cb78-295"><a href="#cb78-295"></a>  <span class="fu">return</span>(df)</span>
<span id="cb78-296"><a href="#cb78-296"></a>}</span>
<span id="cb78-297"><a href="#cb78-297"></a></span>
<span id="cb78-298"><a href="#cb78-298"></a><span class="in">```</span></span>
<span id="cb78-299"><a href="#cb78-299"></a></span>
<span id="cb78-300"><a href="#cb78-300"></a><span class="fu"># Calculate which was the maximum probability for each row</span></span>
<span id="cb78-301"><a href="#cb78-301"></a></span>
<span id="cb78-302"><a href="#cb78-302"></a><span class="fu">## Habitat selection</span></span>
<span id="cb78-303"><a href="#cb78-303"></a></span>
<span id="cb78-306"><a href="#cb78-306"></a><span class="in">```{r}</span></span>
<span id="cb78-307"><a href="#cb78-307"></a>validation_habitat <span class="ot">&lt;-</span> validation_all <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">==</span> <span class="dv">2005</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-308"><a href="#cb78-308"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb78-309"><a href="#cb78-309"></a>    <span class="co"># id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span></span>
<span id="cb78-310"><a href="#cb78-310"></a>    <span class="co"># grep("habitat", colnames(validation_all)),</span></span>
<span id="cb78-311"><a href="#cb78-311"></a>    prob_habitat_ssf_0p,</span>
<span id="cb78-312"><a href="#cb78-312"></a>    <span class="co"># prob_habitat_ssf_2p,</span></span>
<span id="cb78-313"><a href="#cb78-313"></a>    <span class="co"># habitat_deepSSF,</span></span>
<span id="cb78-314"><a href="#cb78-314"></a>    habitat_deepSSF_S2</span>
<span id="cb78-315"><a href="#cb78-315"></a>    ) </span>
<span id="cb78-316"><a href="#cb78-316"></a></span>
<span id="cb78-317"><a href="#cb78-317"></a>validation_habitat_prop <span class="ot">&lt;-</span> <span class="fu">get_max_column</span>(validation_habitat)</span>
<span id="cb78-318"><a href="#cb78-318"></a></span>
<span id="cb78-319"><a href="#cb78-319"></a>max_column_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(validation_habitat_prop<span class="sc">$</span>max_column)</span>
<span id="cb78-320"><a href="#cb78-320"></a>max_column_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(max_column_counts)</span>
<span id="cb78-321"><a href="#cb78-321"></a></span>
<span id="cb78-322"><a href="#cb78-322"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-323"><a href="#cb78-323"></a>  <span class="at">column =</span> <span class="fu">names</span>(max_column_counts),</span>
<span id="cb78-324"><a href="#cb78-324"></a>  <span class="at">count =</span> <span class="fu">as.numeric</span>(max_column_counts),</span>
<span id="cb78-325"><a href="#cb78-325"></a>  <span class="at">proportion =</span> <span class="fu">as.numeric</span>(max_column_proportions)</span>
<span id="cb78-326"><a href="#cb78-326"></a>)</span>
<span id="cb78-327"><a href="#cb78-327"></a></span>
<span id="cb78-328"><a href="#cb78-328"></a>summary_df</span>
<span id="cb78-329"><a href="#cb78-329"></a></span>
<span id="cb78-330"><a href="#cb78-330"></a><span class="in">```</span></span>
<span id="cb78-331"><a href="#cb78-331"></a></span>
<span id="cb78-332"><a href="#cb78-332"></a><span class="fu">## Movement</span></span>
<span id="cb78-333"><a href="#cb78-333"></a></span>
<span id="cb78-336"><a href="#cb78-336"></a><span class="in">```{r}</span></span>
<span id="cb78-337"><a href="#cb78-337"></a>validation_movement <span class="ot">&lt;-</span> validation_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-338"><a href="#cb78-338"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb78-339"><a href="#cb78-339"></a>    <span class="co"># id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span></span>
<span id="cb78-340"><a href="#cb78-340"></a>    <span class="co"># grep("movement", colnames(validation_all)),</span></span>
<span id="cb78-341"><a href="#cb78-341"></a>    <span class="co"># prob_movement_ssf_0p,</span></span>
<span id="cb78-342"><a href="#cb78-342"></a>    prob_movement_ssf_2p,</span>
<span id="cb78-343"><a href="#cb78-343"></a>    movement_deepSSF,</span>
<span id="cb78-344"><a href="#cb78-344"></a>    <span class="co"># movement_deepSSF_S2</span></span>
<span id="cb78-345"><a href="#cb78-345"></a>    ) </span>
<span id="cb78-346"><a href="#cb78-346"></a></span>
<span id="cb78-347"><a href="#cb78-347"></a>validation_movement_prop <span class="ot">&lt;-</span> <span class="fu">get_max_column</span>(validation_movement)</span>
<span id="cb78-348"><a href="#cb78-348"></a></span>
<span id="cb78-349"><a href="#cb78-349"></a>max_column_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(validation_movement_prop<span class="sc">$</span>max_column)</span>
<span id="cb78-350"><a href="#cb78-350"></a>max_column_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(max_column_counts)</span>
<span id="cb78-351"><a href="#cb78-351"></a></span>
<span id="cb78-352"><a href="#cb78-352"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-353"><a href="#cb78-353"></a>  <span class="at">column =</span> <span class="fu">names</span>(max_column_counts),</span>
<span id="cb78-354"><a href="#cb78-354"></a>  <span class="at">count =</span> <span class="fu">as.numeric</span>(max_column_counts),</span>
<span id="cb78-355"><a href="#cb78-355"></a>  <span class="at">proportion =</span> <span class="fu">as.numeric</span>(max_column_proportions)</span>
<span id="cb78-356"><a href="#cb78-356"></a>)</span>
<span id="cb78-357"><a href="#cb78-357"></a></span>
<span id="cb78-358"><a href="#cb78-358"></a>summary_df</span>
<span id="cb78-359"><a href="#cb78-359"></a></span>
<span id="cb78-360"><a href="#cb78-360"></a><span class="in">```</span></span>
<span id="cb78-361"><a href="#cb78-361"></a></span>
<span id="cb78-362"><a href="#cb78-362"></a><span class="fu">## Next-step</span></span>
<span id="cb78-363"><a href="#cb78-363"></a></span>
<span id="cb78-366"><a href="#cb78-366"></a><span class="in">```{r}</span></span>
<span id="cb78-367"><a href="#cb78-367"></a>validation_next_step <span class="ot">&lt;-</span> validation_all <span class="sc">%&gt;%</span> </span>
<span id="cb78-368"><a href="#cb78-368"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb78-369"><a href="#cb78-369"></a>    <span class="co"># id, x_, y_, t_, t2_, hour_t1, hour_t2, yday_t1, yday_t2,</span></span>
<span id="cb78-370"><a href="#cb78-370"></a>    <span class="co"># grep("next_step", colnames(validation_all)),</span></span>
<span id="cb78-371"><a href="#cb78-371"></a>    <span class="co"># prob_next_step_ssf_0p,</span></span>
<span id="cb78-372"><a href="#cb78-372"></a>    prob_next_step_ssf_2p,</span>
<span id="cb78-373"><a href="#cb78-373"></a>    next_step_deepSSF,</span>
<span id="cb78-374"><a href="#cb78-374"></a>    <span class="co"># next_step_deepSSF_S2</span></span>
<span id="cb78-375"><a href="#cb78-375"></a>    ) </span>
<span id="cb78-376"><a href="#cb78-376"></a></span>
<span id="cb78-377"><a href="#cb78-377"></a>validation_next_step_prop <span class="ot">&lt;-</span> <span class="fu">get_max_column</span>(validation_next_step)</span>
<span id="cb78-378"><a href="#cb78-378"></a></span>
<span id="cb78-379"><a href="#cb78-379"></a>max_column_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(validation_next_step_prop<span class="sc">$</span>max_column)</span>
<span id="cb78-380"><a href="#cb78-380"></a>max_column_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(max_column_counts)</span>
<span id="cb78-381"><a href="#cb78-381"></a></span>
<span id="cb78-382"><a href="#cb78-382"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-383"><a href="#cb78-383"></a>  <span class="at">column =</span> <span class="fu">names</span>(max_column_counts),</span>
<span id="cb78-384"><a href="#cb78-384"></a>  <span class="at">count =</span> <span class="fu">as.numeric</span>(max_column_counts),</span>
<span id="cb78-385"><a href="#cb78-385"></a>  <span class="at">proportion =</span> <span class="fu">as.numeric</span>(max_column_proportions)</span>
<span id="cb78-386"><a href="#cb78-386"></a>)</span>
<span id="cb78-387"><a href="#cb78-387"></a></span>
<span id="cb78-388"><a href="#cb78-388"></a>summary_df</span>
<span id="cb78-389"><a href="#cb78-389"></a></span>
<span id="cb78-390"><a href="#cb78-390"></a><span class="in">```</span></span>
<span id="cb78-391"><a href="#cb78-391"></a></span>
<span id="cb78-392"><a href="#cb78-392"></a></span>
<span id="cb78-393"><a href="#cb78-393"></a></span>
<span id="cb78-394"><a href="#cb78-394"></a><span class="fu">## Combine the lengthened data frames</span></span>
<span id="cb78-395"><a href="#cb78-395"></a></span>
<span id="cb78-398"><a href="#cb78-398"></a><span class="in">```{r}</span></span>
<span id="cb78-399"><a href="#cb78-399"></a>validation_all_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(validation_ssf_long,</span>
<span id="cb78-400"><a href="#cb78-400"></a>                                 validation_deepssf_long,</span>
<span id="cb78-401"><a href="#cb78-401"></a>                                 validation_deepssf_s2_long)</span>
<span id="cb78-402"><a href="#cb78-402"></a></span>
<span id="cb78-403"><a href="#cb78-403"></a>validation_all_long <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb78-404"><a href="#cb78-404"></a></span>
<span id="cb78-405"><a href="#cb78-405"></a><span class="in">```</span></span>
<span id="cb78-406"><a href="#cb78-406"></a></span>
<span id="cb78-407"><a href="#cb78-407"></a><span class="fu">## Prepare data frame for plotting</span></span>
<span id="cb78-408"><a href="#cb78-408"></a></span>
<span id="cb78-411"><a href="#cb78-411"></a><span class="in">```{r}</span></span>
<span id="cb78-412"><a href="#cb78-412"></a><span class="co"># Wet season is from November to April</span></span>
<span id="cb78-413"><a href="#cb78-413"></a>months_wet <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb78-414"><a href="#cb78-414"></a></span>
<span id="cb78-415"><a href="#cb78-415"></a>validation_all_long <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb78-416"><a href="#cb78-416"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> focal_id, <span class="st">"in_sample"</span>, <span class="st">"out_sample"</span>),</span>
<span id="cb78-417"><a href="#cb78-417"></a>         <span class="at">yday_t2_2018 =</span> <span class="fu">ifelse</span>(year_t2 <span class="sc">==</span> <span class="dv">2018</span>, yday_t2, yday_t2 <span class="sc">+</span> <span class="dv">365</span>),</span>
<span id="cb78-418"><a href="#cb78-418"></a>         <span class="at">week_t2 =</span> <span class="fu">week</span>(t2_),</span>
<span id="cb78-419"><a href="#cb78-419"></a>         <span class="at">month_t2 =</span> <span class="fu">month</span>(t2_),</span>
<span id="cb78-420"><a href="#cb78-420"></a>         <span class="at">season =</span> <span class="fu">ifelse</span>(month_t2 <span class="sc">%in%</span> months_wet, <span class="st">"wet"</span>, <span class="st">"dry"</span>))</span>
<span id="cb78-421"><a href="#cb78-421"></a></span>
<span id="cb78-422"><a href="#cb78-422"></a><span class="fu">head</span>(validation_all_long)</span>
<span id="cb78-423"><a href="#cb78-423"></a></span>
<span id="cb78-424"><a href="#cb78-424"></a><span class="in">```</span></span>
<span id="cb78-425"><a href="#cb78-425"></a></span>
<span id="cb78-426"><a href="#cb78-426"></a><span class="fu">### Prepare sliding window</span></span>
<span id="cb78-427"><a href="#cb78-427"></a></span>
<span id="cb78-428"><a href="#cb78-428"></a>The predicted probabilities are very noisy, so we apply some smoothing by using a sliding window (rolling mean).</span>
<span id="cb78-429"><a href="#cb78-429"></a></span>
<span id="cb78-430"><a href="#cb78-430"></a>We first need a function to calculate the summary statistics for each window.</span>
<span id="cb78-431"><a href="#cb78-431"></a></span>
<span id="cb78-434"><a href="#cb78-434"></a><span class="in">```{r}</span></span>
<span id="cb78-435"><a href="#cb78-435"></a>window_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb78-436"><a href="#cb78-436"></a>  <span class="fu">summarise</span>(data,</span>
<span id="cb78-437"><a href="#cb78-437"></a>            <span class="at">average_time =</span> <span class="fu">mean</span>(t2_, <span class="at">na.rm =</span> T),</span>
<span id="cb78-438"><a href="#cb78-438"></a>            <span class="at">average_prob =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb78-439"><a href="#cb78-439"></a>            <span class="at">q025 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb78-440"><a href="#cb78-440"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb78-441"><a href="#cb78-441"></a>            <span class="at">q50 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb78-442"><a href="#cb78-442"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb78-443"><a href="#cb78-443"></a>            <span class="at">q975 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> T)</span>
<span id="cb78-444"><a href="#cb78-444"></a>            )</span>
<span id="cb78-445"><a href="#cb78-445"></a>}</span>
<span id="cb78-446"><a href="#cb78-446"></a></span>
<span id="cb78-447"><a href="#cb78-447"></a><span class="in">```</span></span>
<span id="cb78-448"><a href="#cb78-448"></a></span>
<span id="cb78-449"><a href="#cb78-449"></a><span class="fu">### All IDs</span></span>
<span id="cb78-450"><a href="#cb78-450"></a></span>
<span id="cb78-453"><a href="#cb78-453"></a><span class="in">```{r}</span></span>
<span id="cb78-454"><a href="#cb78-454"></a><span class="co">#| message=FALSE</span></span>
<span id="cb78-455"><a href="#cb78-455"></a></span>
<span id="cb78-456"><a href="#cb78-456"></a>window_width <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># number of days in each window - should be odd</span></span>
<span id="cb78-457"><a href="#cb78-457"></a><span class="co"># how many observations before and after the current observation</span></span>
<span id="cb78-458"><a href="#cb78-458"></a>before_after <span class="ot">&lt;-</span> (window_width <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb78-459"><a href="#cb78-459"></a></span>
<span id="cb78-460"><a href="#cb78-460"></a><span class="co"># ensure that the data is sorted by time (while respecting the id and model grouping)</span></span>
<span id="cb78-461"><a href="#cb78-461"></a>all_data <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb78-462"><a href="#cb78-462"></a>  <span class="fu">group_by</span>(id, model, probability) <span class="sc">%&gt;%</span></span>
<span id="cb78-463"><a href="#cb78-463"></a>  <span class="fu">arrange</span>(t2_)</span>
<span id="cb78-464"><a href="#cb78-464"></a></span>
<span id="cb78-465"><a href="#cb78-465"></a><span class="co"># apply the sliding window function</span></span>
<span id="cb78-466"><a href="#cb78-466"></a>validation_all_sliding_period <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span> </span>
<span id="cb78-467"><a href="#cb78-467"></a>  <span class="fu">slide_period_dfr</span>(</span>
<span id="cb78-468"><a href="#cb78-468"></a>    all_data<span class="sc">$</span>t2_,</span>
<span id="cb78-469"><a href="#cb78-469"></a>    <span class="co"># specify that we want to split by days (and slide across at daily intervals)</span></span>
<span id="cb78-470"><a href="#cb78-470"></a>    <span class="st">"day"</span>,</span>
<span id="cb78-471"><a href="#cb78-471"></a>    <span class="co"># our window function (calculates mean and quantiles for each window)</span></span>
<span id="cb78-472"><a href="#cb78-472"></a>    window_summary,</span>
<span id="cb78-473"><a href="#cb78-473"></a>    <span class="co"># how many days before and after the current observation we want to include in the window</span></span>
<span id="cb78-474"><a href="#cb78-474"></a>    <span class="at">.before =</span> before_after,</span>
<span id="cb78-475"><a href="#cb78-475"></a>    <span class="at">.after =</span> before_after</span>
<span id="cb78-476"><a href="#cb78-476"></a>)</span>
<span id="cb78-477"><a href="#cb78-477"></a></span>
<span id="cb78-478"><a href="#cb78-478"></a><span class="fu">head</span>(validation_all_sliding_period, <span class="dv">10</span>)</span>
<span id="cb78-479"><a href="#cb78-479"></a></span>
<span id="cb78-480"><a href="#cb78-480"></a><span class="in">```</span></span>
<span id="cb78-481"><a href="#cb78-481"></a></span>
<span id="cb78-482"><a href="#cb78-482"></a>We can see from the function above that we have the average time, average probability, and quantiles for eac overlapping window, for each model and probability surface (habitat, movement and next-step).</span>
<span id="cb78-483"><a href="#cb78-483"></a></span>
<span id="cb78-484"><a href="#cb78-484"></a><span class="fu">## Out-of-sample validation</span></span>
<span id="cb78-485"><a href="#cb78-485"></a></span>
<span id="cb78-486"><a href="#cb78-486"></a>The above sliding windows are for each individual separately, but we also want to calculate the average and quantiles for all out-of-sample individuals together.</span>
<span id="cb78-487"><a href="#cb78-487"></a></span>
<span id="cb78-488"><a href="#cb78-488"></a><span class="fu">### Calculating mean and quantiles</span></span>
<span id="cb78-489"><a href="#cb78-489"></a></span>
<span id="cb78-492"><a href="#cb78-492"></a><span class="in">```{r}</span></span>
<span id="cb78-493"><a href="#cb78-493"></a><span class="co"># out-of-sample data - all ids but the focal id</span></span>
<span id="cb78-494"><a href="#cb78-494"></a>OOS_data <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb78-495"><a href="#cb78-495"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">==</span> focal_id) <span class="sc">%&gt;%</span></span>
<span id="cb78-496"><a href="#cb78-496"></a>  <span class="fu">group_by</span>(model, probability) <span class="sc">%&gt;%</span></span>
<span id="cb78-497"><a href="#cb78-497"></a>  <span class="fu">arrange</span>(t2_)</span>
<span id="cb78-498"><a href="#cb78-498"></a></span>
<span id="cb78-499"><a href="#cb78-499"></a>validation_all_sliding_period_OOS <span class="ot">&lt;-</span> OOS_data <span class="sc">%&gt;%</span> </span>
<span id="cb78-500"><a href="#cb78-500"></a>  <span class="fu">slide_period_dfr</span>(</span>
<span id="cb78-501"><a href="#cb78-501"></a>    OOS_data<span class="sc">$</span>t2_,</span>
<span id="cb78-502"><a href="#cb78-502"></a>    <span class="st">"day"</span>,</span>
<span id="cb78-503"><a href="#cb78-503"></a>    window_summary,</span>
<span id="cb78-504"><a href="#cb78-504"></a>    <span class="at">.before =</span> before_after,</span>
<span id="cb78-505"><a href="#cb78-505"></a>    <span class="at">.after =</span> before_after</span>
<span id="cb78-506"><a href="#cb78-506"></a>)</span>
<span id="cb78-507"><a href="#cb78-507"></a></span>
<span id="cb78-508"><a href="#cb78-508"></a><span class="fu">head</span>(validation_all_sliding_period_OOS, <span class="dv">10</span>)</span>
<span id="cb78-509"><a href="#cb78-509"></a></span>
<span id="cb78-510"><a href="#cb78-510"></a><span class="in">```</span></span>
<span id="cb78-511"><a href="#cb78-511"></a></span>
<span id="cb78-512"><a href="#cb78-512"></a>Now the summaries are calculated for all out-of-sample individuals together.</span>
<span id="cb78-513"><a href="#cb78-513"></a></span>
<span id="cb78-514"><a href="#cb78-514"></a><span class="fu"># Habitat selection across the tracking period</span></span>
<span id="cb78-515"><a href="#cb78-515"></a></span>
<span id="cb78-516"><a href="#cb78-516"></a><span class="fu">## All models</span></span>
<span id="cb78-517"><a href="#cb78-517"></a></span>
<span id="cb78-518"><a href="#cb78-518"></a>The solid coloured lines show the average probability for the focal individual that the model was fitted to, and the shaded ribbon is the 50% quantile (there is high variability between probability values, so for clarity we omitted the 95% quantiles). The thin coloured lines are the average probability values for 12 individuals that the model was not fitted to, and are therefore out-of-sample validation data. The dashed coloured lines are the mean values for each model for all of the out-of-sample individuals.</span>
<span id="cb78-519"><a href="#cb78-519"></a></span>
<span id="cb78-520"><a href="#cb78-520"></a>We also show the 'null' probability, i.e. if the selection was completely random, which is just the probability divided equally between all cells.</span>
<span id="cb78-521"><a href="#cb78-521"></a></span>
<span id="cb78-524"><a href="#cb78-524"></a><span class="in">```{r}</span></span>
<span id="cb78-525"><a href="#cb78-525"></a><span class="co"># if there were uniform probabilities (i.e. no selection)</span></span>
<span id="cb78-526"><a href="#cb78-526"></a>uniform_prob <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">101</span><span class="sc">*</span><span class="dv">101</span>)</span>
<span id="cb78-527"><a href="#cb78-527"></a></span>
<span id="cb78-528"><a href="#cb78-528"></a>ribbon_50_alpha <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb78-529"><a href="#cb78-529"></a>primary_linewidth <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb78-530"><a href="#cb78-530"></a>OOS_mean_linewidth <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb78-531"><a href="#cb78-531"></a>secondary_linewidth <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb78-532"><a href="#cb78-532"></a></span>
<span id="cb78-533"><a href="#cb78-533"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-534"><a href="#cb78-534"></a>  </span>
<span id="cb78-535"><a href="#cb78-535"></a>  <span class="co"># dashed lines containing the SSF probabilities (for zooming into in the paper)</span></span>
<span id="cb78-536"><a href="#cb78-536"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-537"><a href="#cb78-537"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-538"><a href="#cb78-538"></a>  </span>
<span id="cb78-539"><a href="#cb78-539"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-540"><a href="#cb78-540"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-541"><a href="#cb78-541"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-542"><a href="#cb78-542"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb78-543"><a href="#cb78-543"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-544"><a href="#cb78-544"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-545"><a href="#cb78-545"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-546"><a href="#cb78-546"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-547"><a href="#cb78-547"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-548"><a href="#cb78-548"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-549"><a href="#cb78-549"></a>  </span>
<span id="cb78-550"><a href="#cb78-550"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-551"><a href="#cb78-551"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-552"><a href="#cb78-552"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-553"><a href="#cb78-553"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb78-554"><a href="#cb78-554"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-555"><a href="#cb78-555"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-556"><a href="#cb78-556"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-557"><a href="#cb78-557"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-558"><a href="#cb78-558"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-559"><a href="#cb78-559"></a>  </span>
<span id="cb78-560"><a href="#cb78-560"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-561"><a href="#cb78-561"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-562"><a href="#cb78-562"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>),</span>
<span id="cb78-563"><a href="#cb78-563"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-564"><a href="#cb78-564"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-565"><a href="#cb78-565"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-566"><a href="#cb78-566"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-567"><a href="#cb78-567"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-568"><a href="#cb78-568"></a>  </span>
<span id="cb78-569"><a href="#cb78-569"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-570"><a href="#cb78-570"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-571"><a href="#cb78-571"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-572"><a href="#cb78-572"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb78-573"><a href="#cb78-573"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-574"><a href="#cb78-574"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-575"><a href="#cb78-575"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-576"><a href="#cb78-576"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-577"><a href="#cb78-577"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-578"><a href="#cb78-578"></a>  </span>
<span id="cb78-579"><a href="#cb78-579"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-580"><a href="#cb78-580"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-581"><a href="#cb78-581"></a>  </span>
<span id="cb78-582"><a href="#cb78-582"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-583"><a href="#cb78-583"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-584"><a href="#cb78-584"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-585"><a href="#cb78-585"></a>  </span>
<span id="cb78-586"><a href="#cb78-586"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-587"><a href="#cb78-587"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-588"><a href="#cb78-588"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-589"><a href="#cb78-589"></a>  </span>
<span id="cb78-590"><a href="#cb78-590"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-591"><a href="#cb78-591"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-592"><a href="#cb78-592"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-593"><a href="#cb78-593"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-594"><a href="#cb78-594"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-595"><a href="#cb78-595"></a></span>
<span id="cb78-596"><a href="#cb78-596"></a><span class="co"># ggsave(paste0("outputs/validation_all_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-597"><a href="#cb78-597"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-598"><a href="#cb78-598"></a></span>
<span id="cb78-599"><a href="#cb78-599"></a><span class="in">```</span></span>
<span id="cb78-600"><a href="#cb78-600"></a></span>
<span id="cb78-601"><a href="#cb78-601"></a>The first thing to note is difference in magnitude between the deepSSF and the SSF predictions. The deepSSF predicted probabilities are often much higher, but can also be much lower, suggesting that the deepSSF models are more 'confident'. </span>
<span id="cb78-602"><a href="#cb78-602"></a></span>
<span id="cb78-603"><a href="#cb78-603"></a>The deepSSF and deepSSF S2 models both performed particularly well between December 2018 and July 2019, (wet-season and early dry-season), although only the deepSSF S2 model performs well outside of this period (for most of the dry season). This suggests that the derived covariates may lack information that is relevant to buffalo during this period, such as a representation of water.</span>
<span id="cb78-604"><a href="#cb78-604"></a></span>
<span id="cb78-605"><a href="#cb78-605"></a>The higher performance of the deepSSF S2 predictions is also echoed in the out-of-sample predictions, which are generally quite a lot higher than the other models. </span>
<span id="cb78-606"><a href="#cb78-606"></a></span>
<span id="cb78-607"><a href="#cb78-607"></a><span class="fu">## deepSSF models</span></span>
<span id="cb78-608"><a href="#cb78-608"></a></span>
<span id="cb78-611"><a href="#cb78-611"></a><span class="in">```{r}</span></span>
<span id="cb78-612"><a href="#cb78-612"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-613"><a href="#cb78-613"></a>  </span>
<span id="cb78-614"><a href="#cb78-614"></a>  <span class="co"># dashed lines containing the SSF probabilities (for zooming into in the paper)</span></span>
<span id="cb78-615"><a href="#cb78-615"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-616"><a href="#cb78-616"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-617"><a href="#cb78-617"></a>  </span>
<span id="cb78-618"><a href="#cb78-618"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-619"><a href="#cb78-619"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-620"><a href="#cb78-620"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-621"><a href="#cb78-621"></a>                       id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-622"><a href="#cb78-622"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-623"><a href="#cb78-623"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-624"><a href="#cb78-624"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-625"><a href="#cb78-625"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-626"><a href="#cb78-626"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-627"><a href="#cb78-627"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-628"><a href="#cb78-628"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-629"><a href="#cb78-629"></a>  </span>
<span id="cb78-630"><a href="#cb78-630"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-631"><a href="#cb78-631"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-632"><a href="#cb78-632"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-633"><a href="#cb78-633"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-634"><a href="#cb78-634"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-635"><a href="#cb78-635"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-636"><a href="#cb78-636"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-637"><a href="#cb78-637"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-638"><a href="#cb78-638"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-639"><a href="#cb78-639"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-640"><a href="#cb78-640"></a>  </span>
<span id="cb78-641"><a href="#cb78-641"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-642"><a href="#cb78-642"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-643"><a href="#cb78-643"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-644"><a href="#cb78-644"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-645"><a href="#cb78-645"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-646"><a href="#cb78-646"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-647"><a href="#cb78-647"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-648"><a href="#cb78-648"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-649"><a href="#cb78-649"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-650"><a href="#cb78-650"></a>  </span>
<span id="cb78-651"><a href="#cb78-651"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-652"><a href="#cb78-652"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-653"><a href="#cb78-653"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-654"><a href="#cb78-654"></a>                     id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-655"><a href="#cb78-655"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-656"><a href="#cb78-656"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-657"><a href="#cb78-657"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-658"><a href="#cb78-658"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-659"><a href="#cb78-659"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-660"><a href="#cb78-660"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-661"><a href="#cb78-661"></a>  </span>
<span id="cb78-662"><a href="#cb78-662"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-663"><a href="#cb78-663"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-664"><a href="#cb78-664"></a>  </span>
<span id="cb78-665"><a href="#cb78-665"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-666"><a href="#cb78-666"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-667"><a href="#cb78-667"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-668"><a href="#cb78-668"></a>  </span>
<span id="cb78-669"><a href="#cb78-669"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-670"><a href="#cb78-670"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-671"><a href="#cb78-671"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-672"><a href="#cb78-672"></a>  </span>
<span id="cb78-673"><a href="#cb78-673"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-674"><a href="#cb78-674"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-675"><a href="#cb78-675"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-676"><a href="#cb78-676"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-677"><a href="#cb78-677"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-678"><a href="#cb78-678"></a></span>
<span id="cb78-679"><a href="#cb78-679"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-680"><a href="#cb78-680"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-681"><a href="#cb78-681"></a></span>
<span id="cb78-682"><a href="#cb78-682"></a><span class="in">```</span></span>
<span id="cb78-683"><a href="#cb78-683"></a></span>
<span id="cb78-684"><a href="#cb78-684"></a><span class="fu">## SSF models</span></span>
<span id="cb78-685"><a href="#cb78-685"></a></span>
<span id="cb78-688"><a href="#cb78-688"></a><span class="in">```{r}</span></span>
<span id="cb78-689"><a href="#cb78-689"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-690"><a href="#cb78-690"></a>  </span>
<span id="cb78-691"><a href="#cb78-691"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-692"><a href="#cb78-692"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-693"><a href="#cb78-693"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-694"><a href="#cb78-694"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-695"><a href="#cb78-695"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-696"><a href="#cb78-696"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-697"><a href="#cb78-697"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-698"><a href="#cb78-698"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-699"><a href="#cb78-699"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-700"><a href="#cb78-700"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-701"><a href="#cb78-701"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-702"><a href="#cb78-702"></a>  </span>
<span id="cb78-703"><a href="#cb78-703"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-704"><a href="#cb78-704"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-705"><a href="#cb78-705"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-706"><a href="#cb78-706"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-707"><a href="#cb78-707"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-708"><a href="#cb78-708"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-709"><a href="#cb78-709"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-710"><a href="#cb78-710"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-711"><a href="#cb78-711"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-712"><a href="#cb78-712"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-713"><a href="#cb78-713"></a>  </span>
<span id="cb78-714"><a href="#cb78-714"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-715"><a href="#cb78-715"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-716"><a href="#cb78-716"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-717"><a href="#cb78-717"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-718"><a href="#cb78-718"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-719"><a href="#cb78-719"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-720"><a href="#cb78-720"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-721"><a href="#cb78-721"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-722"><a href="#cb78-722"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-723"><a href="#cb78-723"></a>  </span>
<span id="cb78-724"><a href="#cb78-724"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-725"><a href="#cb78-725"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-726"><a href="#cb78-726"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-727"><a href="#cb78-727"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-728"><a href="#cb78-728"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-729"><a href="#cb78-729"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-730"><a href="#cb78-730"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-731"><a href="#cb78-731"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-732"><a href="#cb78-732"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-733"><a href="#cb78-733"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-734"><a href="#cb78-734"></a>  </span>
<span id="cb78-735"><a href="#cb78-735"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-736"><a href="#cb78-736"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-737"><a href="#cb78-737"></a>  </span>
<span id="cb78-738"><a href="#cb78-738"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-739"><a href="#cb78-739"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-740"><a href="#cb78-740"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-741"><a href="#cb78-741"></a>  </span>
<span id="cb78-742"><a href="#cb78-742"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-743"><a href="#cb78-743"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-744"><a href="#cb78-744"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-745"><a href="#cb78-745"></a>  </span>
<span id="cb78-746"><a href="#cb78-746"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>, </span>
<span id="cb78-747"><a href="#cb78-747"></a>                     <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb78-748"><a href="#cb78-748"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb78-749"><a href="#cb78-749"></a>  </span>
<span id="cb78-750"><a href="#cb78-750"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-751"><a href="#cb78-751"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.6e-4</span>, <span class="fl">1.5e-4</span>)) <span class="sc">+</span></span>
<span id="cb78-752"><a href="#cb78-752"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-753"><a href="#cb78-753"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-754"><a href="#cb78-754"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-755"><a href="#cb78-755"></a></span>
<span id="cb78-756"><a href="#cb78-756"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-757"><a href="#cb78-757"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-758"><a href="#cb78-758"></a></span>
<span id="cb78-759"><a href="#cb78-759"></a><span class="in">```</span></span>
<span id="cb78-760"><a href="#cb78-760"></a></span>
<span id="cb78-761"><a href="#cb78-761"></a>There isn't a clear seasonal trend with the SSF predictions, but in general the models do better than the null model, although the out-of-sample predictions vary around the null model.</span>
<span id="cb78-762"><a href="#cb78-762"></a></span>
<span id="cb78-763"><a href="#cb78-763"></a><span class="fu"># Movement probability across the tracking period</span></span>
<span id="cb78-764"><a href="#cb78-764"></a></span>
<span id="cb78-765"><a href="#cb78-765"></a><span class="fu">## All models</span></span>
<span id="cb78-766"><a href="#cb78-766"></a></span>
<span id="cb78-769"><a href="#cb78-769"></a><span class="in">```{r}</span></span>
<span id="cb78-770"><a href="#cb78-770"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-771"><a href="#cb78-771"></a>  </span>
<span id="cb78-772"><a href="#cb78-772"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-773"><a href="#cb78-773"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-774"><a href="#cb78-774"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-775"><a href="#cb78-775"></a>  </span>
<span id="cb78-776"><a href="#cb78-776"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-777"><a href="#cb78-777"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-778"><a href="#cb78-778"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-779"><a href="#cb78-779"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb78-780"><a href="#cb78-780"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-781"><a href="#cb78-781"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-782"><a href="#cb78-782"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-783"><a href="#cb78-783"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-784"><a href="#cb78-784"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-785"><a href="#cb78-785"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-786"><a href="#cb78-786"></a>  </span>
<span id="cb78-787"><a href="#cb78-787"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-788"><a href="#cb78-788"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-789"><a href="#cb78-789"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-790"><a href="#cb78-790"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb78-791"><a href="#cb78-791"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-792"><a href="#cb78-792"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-793"><a href="#cb78-793"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-794"><a href="#cb78-794"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-795"><a href="#cb78-795"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-796"><a href="#cb78-796"></a>  </span>
<span id="cb78-797"><a href="#cb78-797"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-798"><a href="#cb78-798"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-799"><a href="#cb78-799"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>),</span>
<span id="cb78-800"><a href="#cb78-800"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-801"><a href="#cb78-801"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-802"><a href="#cb78-802"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-803"><a href="#cb78-803"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-804"><a href="#cb78-804"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-805"><a href="#cb78-805"></a>  </span>
<span id="cb78-806"><a href="#cb78-806"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-807"><a href="#cb78-807"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-808"><a href="#cb78-808"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-809"><a href="#cb78-809"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb78-810"><a href="#cb78-810"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-811"><a href="#cb78-811"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-812"><a href="#cb78-812"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-813"><a href="#cb78-813"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-814"><a href="#cb78-814"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-815"><a href="#cb78-815"></a>  </span>
<span id="cb78-816"><a href="#cb78-816"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-817"><a href="#cb78-817"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-818"><a href="#cb78-818"></a>  </span>
<span id="cb78-819"><a href="#cb78-819"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-820"><a href="#cb78-820"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-821"><a href="#cb78-821"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-822"><a href="#cb78-822"></a>  </span>
<span id="cb78-823"><a href="#cb78-823"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-824"><a href="#cb78-824"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-825"><a href="#cb78-825"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-826"><a href="#cb78-826"></a>  </span>
<span id="cb78-827"><a href="#cb78-827"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-828"><a href="#cb78-828"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-829"><a href="#cb78-829"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-830"><a href="#cb78-830"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-831"><a href="#cb78-831"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-832"><a href="#cb78-832"></a></span>
<span id="cb78-833"><a href="#cb78-833"></a><span class="co"># ggsave(paste0("outputs/validation_all_move_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-834"><a href="#cb78-834"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-835"><a href="#cb78-835"></a></span>
<span id="cb78-836"><a href="#cb78-836"></a><span class="in">```</span></span>
<span id="cb78-837"><a href="#cb78-837"></a></span>
<span id="cb78-838"><a href="#cb78-838"></a>The movement probabilities for the deepSSF models are much higher than the for the SSF models, which I suspect is mostly due to the mixture of distributions in the deepSSF models. When the buffalo are in a low movement period, there can be very high probability in the few cells close to the buffalo, which is often accurate (when the predicted probability is 0.2 that means all of the probability mass is shared between only 5 cells. I don't think the SSF movement kernel has the same flexibility to capture this. </span>
<span id="cb78-839"><a href="#cb78-839"></a></span>
<span id="cb78-840"><a href="#cb78-840"></a>This also comes out very clearly in the hourly predictions, with much higher predicted probabilities during the low movement periods.</span>
<span id="cb78-841"><a href="#cb78-841"></a></span>
<span id="cb78-842"><a href="#cb78-842"></a><span class="fu">## deepSSF models</span></span>
<span id="cb78-843"><a href="#cb78-843"></a></span>
<span id="cb78-846"><a href="#cb78-846"></a><span class="in">```{r}</span></span>
<span id="cb78-847"><a href="#cb78-847"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-848"><a href="#cb78-848"></a>  </span>
<span id="cb78-849"><a href="#cb78-849"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-850"><a href="#cb78-850"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-851"><a href="#cb78-851"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">9e-3</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-852"><a href="#cb78-852"></a>  </span>
<span id="cb78-853"><a href="#cb78-853"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-854"><a href="#cb78-854"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-855"><a href="#cb78-855"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-856"><a href="#cb78-856"></a>                       id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-857"><a href="#cb78-857"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-858"><a href="#cb78-858"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-859"><a href="#cb78-859"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-860"><a href="#cb78-860"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-861"><a href="#cb78-861"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-862"><a href="#cb78-862"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-863"><a href="#cb78-863"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-864"><a href="#cb78-864"></a>  </span>
<span id="cb78-865"><a href="#cb78-865"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-866"><a href="#cb78-866"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-867"><a href="#cb78-867"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-868"><a href="#cb78-868"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-869"><a href="#cb78-869"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-870"><a href="#cb78-870"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-871"><a href="#cb78-871"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-872"><a href="#cb78-872"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-873"><a href="#cb78-873"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-874"><a href="#cb78-874"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-875"><a href="#cb78-875"></a>  </span>
<span id="cb78-876"><a href="#cb78-876"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-877"><a href="#cb78-877"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-878"><a href="#cb78-878"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-879"><a href="#cb78-879"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-880"><a href="#cb78-880"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-881"><a href="#cb78-881"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-882"><a href="#cb78-882"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-883"><a href="#cb78-883"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-884"><a href="#cb78-884"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-885"><a href="#cb78-885"></a>  </span>
<span id="cb78-886"><a href="#cb78-886"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-887"><a href="#cb78-887"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-888"><a href="#cb78-888"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-889"><a href="#cb78-889"></a>                     id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-890"><a href="#cb78-890"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-891"><a href="#cb78-891"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-892"><a href="#cb78-892"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-893"><a href="#cb78-893"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-894"><a href="#cb78-894"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-895"><a href="#cb78-895"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-896"><a href="#cb78-896"></a>  </span>
<span id="cb78-897"><a href="#cb78-897"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-898"><a href="#cb78-898"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-899"><a href="#cb78-899"></a>  </span>
<span id="cb78-900"><a href="#cb78-900"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-901"><a href="#cb78-901"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-902"><a href="#cb78-902"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-903"><a href="#cb78-903"></a>  </span>
<span id="cb78-904"><a href="#cb78-904"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-905"><a href="#cb78-905"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-906"><a href="#cb78-906"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-907"><a href="#cb78-907"></a>  </span>
<span id="cb78-908"><a href="#cb78-908"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-909"><a href="#cb78-909"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-910"><a href="#cb78-910"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-911"><a href="#cb78-911"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-912"><a href="#cb78-912"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-913"><a href="#cb78-913"></a></span>
<span id="cb78-914"><a href="#cb78-914"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_move_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-915"><a href="#cb78-915"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-916"><a href="#cb78-916"></a></span>
<span id="cb78-917"><a href="#cb78-917"></a><span class="in">```</span></span>
<span id="cb78-918"><a href="#cb78-918"></a></span>
<span id="cb78-919"><a href="#cb78-919"></a><span class="fu">## SSF models</span></span>
<span id="cb78-920"><a href="#cb78-920"></a></span>
<span id="cb78-923"><a href="#cb78-923"></a><span class="in">```{r}</span></span>
<span id="cb78-924"><a href="#cb78-924"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-925"><a href="#cb78-925"></a>  </span>
<span id="cb78-926"><a href="#cb78-926"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-927"><a href="#cb78-927"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-928"><a href="#cb78-928"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-929"><a href="#cb78-929"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-930"><a href="#cb78-930"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-931"><a href="#cb78-931"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-932"><a href="#cb78-932"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-933"><a href="#cb78-933"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-934"><a href="#cb78-934"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-935"><a href="#cb78-935"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-936"><a href="#cb78-936"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-937"><a href="#cb78-937"></a>  </span>
<span id="cb78-938"><a href="#cb78-938"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-939"><a href="#cb78-939"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-940"><a href="#cb78-940"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-941"><a href="#cb78-941"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-942"><a href="#cb78-942"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-943"><a href="#cb78-943"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-944"><a href="#cb78-944"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-945"><a href="#cb78-945"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-946"><a href="#cb78-946"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-947"><a href="#cb78-947"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-948"><a href="#cb78-948"></a>  </span>
<span id="cb78-949"><a href="#cb78-949"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-950"><a href="#cb78-950"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-951"><a href="#cb78-951"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-952"><a href="#cb78-952"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-953"><a href="#cb78-953"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-954"><a href="#cb78-954"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-955"><a href="#cb78-955"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-956"><a href="#cb78-956"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-957"><a href="#cb78-957"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-958"><a href="#cb78-958"></a>  </span>
<span id="cb78-959"><a href="#cb78-959"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-960"><a href="#cb78-960"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-961"><a href="#cb78-961"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-962"><a href="#cb78-962"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-963"><a href="#cb78-963"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-964"><a href="#cb78-964"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-965"><a href="#cb78-965"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-966"><a href="#cb78-966"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-967"><a href="#cb78-967"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-968"><a href="#cb78-968"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-969"><a href="#cb78-969"></a>  </span>
<span id="cb78-970"><a href="#cb78-970"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-971"><a href="#cb78-971"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-972"><a href="#cb78-972"></a>  </span>
<span id="cb78-973"><a href="#cb78-973"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-974"><a href="#cb78-974"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-975"><a href="#cb78-975"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-976"><a href="#cb78-976"></a>  </span>
<span id="cb78-977"><a href="#cb78-977"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-978"><a href="#cb78-978"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-979"><a href="#cb78-979"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-980"><a href="#cb78-980"></a>  </span>
<span id="cb78-981"><a href="#cb78-981"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>, </span>
<span id="cb78-982"><a href="#cb78-982"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb78-983"><a href="#cb78-983"></a>  </span>
<span id="cb78-984"><a href="#cb78-984"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-985"><a href="#cb78-985"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">9e-3</span>)) <span class="sc">+</span></span>
<span id="cb78-986"><a href="#cb78-986"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-987"><a href="#cb78-987"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-988"><a href="#cb78-988"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-989"><a href="#cb78-989"></a></span>
<span id="cb78-990"><a href="#cb78-990"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_move_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-991"><a href="#cb78-991"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-992"><a href="#cb78-992"></a></span>
<span id="cb78-993"><a href="#cb78-993"></a><span class="in">```</span></span>
<span id="cb78-994"><a href="#cb78-994"></a></span>
<span id="cb78-995"><a href="#cb78-995"></a>The temporally dynamic models have consistently higher probabilities of movement than the static models, which again is likely due to the concentration of the movement kernel during the low movement periods, where the probability values are distributed across much fewer cells.</span>
<span id="cb78-996"><a href="#cb78-996"></a></span>
<span id="cb78-997"><a href="#cb78-997"></a><span class="fu"># Next-step probabilities across the tracking period</span></span>
<span id="cb78-998"><a href="#cb78-998"></a></span>
<span id="cb78-999"><a href="#cb78-999"></a>The next-step probability values are very similar to the movement probabilities due to the concentration of the probability mass in fewer cells that are closer to the buffalo, whereas the habitat selection probabilities are distributed across all of the local layers, so they're not actually that informative beyond the movement probabilities.</span>
<span id="cb78-1000"><a href="#cb78-1000"></a></span>
<span id="cb78-1001"><a href="#cb78-1001"></a><span class="fu">## All models</span></span>
<span id="cb78-1002"><a href="#cb78-1002"></a></span>
<span id="cb78-1005"><a href="#cb78-1005"></a><span class="in">```{r}</span></span>
<span id="cb78-1006"><a href="#cb78-1006"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1007"><a href="#cb78-1007"></a>  </span>
<span id="cb78-1008"><a href="#cb78-1008"></a>  <span class="co"># dashed lines containing the SSF probability values</span></span>
<span id="cb78-1009"><a href="#cb78-1009"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1010"><a href="#cb78-1010"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1011"><a href="#cb78-1011"></a>  </span>
<span id="cb78-1012"><a href="#cb78-1012"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1013"><a href="#cb78-1013"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-1014"><a href="#cb78-1014"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1015"><a href="#cb78-1015"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1016"><a href="#cb78-1016"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1017"><a href="#cb78-1017"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1018"><a href="#cb78-1018"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1019"><a href="#cb78-1019"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1020"><a href="#cb78-1020"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1021"><a href="#cb78-1021"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1022"><a href="#cb78-1022"></a>  </span>
<span id="cb78-1023"><a href="#cb78-1023"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1024"><a href="#cb78-1024"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-1025"><a href="#cb78-1025"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1026"><a href="#cb78-1026"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1027"><a href="#cb78-1027"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1028"><a href="#cb78-1028"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1029"><a href="#cb78-1029"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1030"><a href="#cb78-1030"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1031"><a href="#cb78-1031"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1032"><a href="#cb78-1032"></a>  </span>
<span id="cb78-1033"><a href="#cb78-1033"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-1034"><a href="#cb78-1034"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1035"><a href="#cb78-1035"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>),</span>
<span id="cb78-1036"><a href="#cb78-1036"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1037"><a href="#cb78-1037"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1038"><a href="#cb78-1038"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1039"><a href="#cb78-1039"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1040"><a href="#cb78-1040"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1041"><a href="#cb78-1041"></a>  </span>
<span id="cb78-1042"><a href="#cb78-1042"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1043"><a href="#cb78-1043"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-1044"><a href="#cb78-1044"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1045"><a href="#cb78-1045"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1046"><a href="#cb78-1046"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-1047"><a href="#cb78-1047"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1048"><a href="#cb78-1048"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1049"><a href="#cb78-1049"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1050"><a href="#cb78-1050"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1051"><a href="#cb78-1051"></a>  </span>
<span id="cb78-1052"><a href="#cb78-1052"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-1053"><a href="#cb78-1053"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-1054"><a href="#cb78-1054"></a>  </span>
<span id="cb78-1055"><a href="#cb78-1055"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1056"><a href="#cb78-1056"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1057"><a href="#cb78-1057"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1058"><a href="#cb78-1058"></a>  </span>
<span id="cb78-1059"><a href="#cb78-1059"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1060"><a href="#cb78-1060"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1061"><a href="#cb78-1061"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1062"><a href="#cb78-1062"></a>  </span>
<span id="cb78-1063"><a href="#cb78-1063"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1064"><a href="#cb78-1064"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-1065"><a href="#cb78-1065"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1066"><a href="#cb78-1066"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-1067"><a href="#cb78-1067"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-1068"><a href="#cb78-1068"></a></span>
<span id="cb78-1069"><a href="#cb78-1069"></a><span class="co"># ggsave(paste0("outputs/validation_all_next_step_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-1070"><a href="#cb78-1070"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1071"><a href="#cb78-1071"></a></span>
<span id="cb78-1072"><a href="#cb78-1072"></a><span class="in">```</span></span>
<span id="cb78-1073"><a href="#cb78-1073"></a></span>
<span id="cb78-1074"><a href="#cb78-1074"></a><span class="fu">## deepSSF models</span></span>
<span id="cb78-1075"><a href="#cb78-1075"></a></span>
<span id="cb78-1078"><a href="#cb78-1078"></a><span class="in">```{r}</span></span>
<span id="cb78-1079"><a href="#cb78-1079"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1080"><a href="#cb78-1080"></a>  </span>
<span id="cb78-1081"><a href="#cb78-1081"></a>  <span class="co"># dashed lines containing the SSF probability values</span></span>
<span id="cb78-1082"><a href="#cb78-1082"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1083"><a href="#cb78-1083"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">9e-3</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1084"><a href="#cb78-1084"></a>  </span>
<span id="cb78-1085"><a href="#cb78-1085"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1086"><a href="#cb78-1086"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-1087"><a href="#cb78-1087"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1088"><a href="#cb78-1088"></a>                       id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-1089"><a href="#cb78-1089"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1090"><a href="#cb78-1090"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1091"><a href="#cb78-1091"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1092"><a href="#cb78-1092"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1093"><a href="#cb78-1093"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1094"><a href="#cb78-1094"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1095"><a href="#cb78-1095"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1096"><a href="#cb78-1096"></a>  </span>
<span id="cb78-1097"><a href="#cb78-1097"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1098"><a href="#cb78-1098"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-1099"><a href="#cb78-1099"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1100"><a href="#cb78-1100"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-1101"><a href="#cb78-1101"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1102"><a href="#cb78-1102"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-1103"><a href="#cb78-1103"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1104"><a href="#cb78-1104"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1105"><a href="#cb78-1105"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1106"><a href="#cb78-1106"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1107"><a href="#cb78-1107"></a>  </span>
<span id="cb78-1108"><a href="#cb78-1108"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-1109"><a href="#cb78-1109"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1110"><a href="#cb78-1110"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1111"><a href="#cb78-1111"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1112"><a href="#cb78-1112"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1113"><a href="#cb78-1113"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1114"><a href="#cb78-1114"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1115"><a href="#cb78-1115"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1116"><a href="#cb78-1116"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1117"><a href="#cb78-1117"></a>  </span>
<span id="cb78-1118"><a href="#cb78-1118"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1119"><a href="#cb78-1119"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-1120"><a href="#cb78-1120"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1121"><a href="#cb78-1121"></a>                     id <span class="sc">==</span> focal_id <span class="sc">&amp;</span></span>
<span id="cb78-1122"><a href="#cb78-1122"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1123"><a href="#cb78-1123"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-1124"><a href="#cb78-1124"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1125"><a href="#cb78-1125"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1126"><a href="#cb78-1126"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1127"><a href="#cb78-1127"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1128"><a href="#cb78-1128"></a>  </span>
<span id="cb78-1129"><a href="#cb78-1129"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-1130"><a href="#cb78-1130"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-1131"><a href="#cb78-1131"></a>  </span>
<span id="cb78-1132"><a href="#cb78-1132"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1133"><a href="#cb78-1133"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1134"><a href="#cb78-1134"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1135"><a href="#cb78-1135"></a>  </span>
<span id="cb78-1136"><a href="#cb78-1136"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1137"><a href="#cb78-1137"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1138"><a href="#cb78-1138"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1139"><a href="#cb78-1139"></a>  </span>
<span id="cb78-1140"><a href="#cb78-1140"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1141"><a href="#cb78-1141"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-1142"><a href="#cb78-1142"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1143"><a href="#cb78-1143"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-1144"><a href="#cb78-1144"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-1145"><a href="#cb78-1145"></a></span>
<span id="cb78-1146"><a href="#cb78-1146"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_next_step_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-1147"><a href="#cb78-1147"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1148"><a href="#cb78-1148"></a></span>
<span id="cb78-1149"><a href="#cb78-1149"></a><span class="in">```</span></span>
<span id="cb78-1150"><a href="#cb78-1150"></a></span>
<span id="cb78-1151"><a href="#cb78-1151"></a><span class="fu">## SSF models</span></span>
<span id="cb78-1152"><a href="#cb78-1152"></a></span>
<span id="cb78-1155"><a href="#cb78-1155"></a><span class="in">```{r}</span></span>
<span id="cb78-1156"><a href="#cb78-1156"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1157"><a href="#cb78-1157"></a>  </span>
<span id="cb78-1158"><a href="#cb78-1158"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1159"><a href="#cb78-1159"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span></span>
<span id="cb78-1160"><a href="#cb78-1160"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1161"><a href="#cb78-1161"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1162"><a href="#cb78-1162"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1163"><a href="#cb78-1163"></a>              <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1164"><a href="#cb78-1164"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1165"><a href="#cb78-1165"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1166"><a href="#cb78-1166"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1167"><a href="#cb78-1167"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1168"><a href="#cb78-1168"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1169"><a href="#cb78-1169"></a>  </span>
<span id="cb78-1170"><a href="#cb78-1170"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1171"><a href="#cb78-1171"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-1172"><a href="#cb78-1172"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1173"><a href="#cb78-1173"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1174"><a href="#cb78-1174"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1175"><a href="#cb78-1175"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-1176"><a href="#cb78-1176"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1177"><a href="#cb78-1177"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1178"><a href="#cb78-1178"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1179"><a href="#cb78-1179"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1180"><a href="#cb78-1180"></a>  </span>
<span id="cb78-1181"><a href="#cb78-1181"></a>  <span class="co"># out-of-sample mean line for all individuals</span></span>
<span id="cb78-1182"><a href="#cb78-1182"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1183"><a href="#cb78-1183"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1184"><a href="#cb78-1184"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1185"><a href="#cb78-1185"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time,</span>
<span id="cb78-1186"><a href="#cb78-1186"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1187"><a href="#cb78-1187"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1188"><a href="#cb78-1188"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1189"><a href="#cb78-1189"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1190"><a href="#cb78-1190"></a>  </span>
<span id="cb78-1191"><a href="#cb78-1191"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1192"><a href="#cb78-1192"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_sliding_period <span class="sc">%&gt;%</span> </span>
<span id="cb78-1193"><a href="#cb78-1193"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1194"><a href="#cb78-1194"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1195"><a href="#cb78-1195"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1196"><a href="#cb78-1196"></a>            <span class="fu">aes</span>(<span class="at">x =</span> average_time, </span>
<span id="cb78-1197"><a href="#cb78-1197"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1198"><a href="#cb78-1198"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1199"><a href="#cb78-1199"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1200"><a href="#cb78-1200"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1201"><a href="#cb78-1201"></a>  </span>
<span id="cb78-1202"><a href="#cb78-1202"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-1203"><a href="#cb78-1203"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb78-1204"><a href="#cb78-1204"></a>  </span>
<span id="cb78-1205"><a href="#cb78-1205"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1206"><a href="#cb78-1206"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1207"><a href="#cb78-1207"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1208"><a href="#cb78-1208"></a>  </span>
<span id="cb78-1209"><a href="#cb78-1209"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1210"><a href="#cb78-1210"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1211"><a href="#cb78-1211"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1212"><a href="#cb78-1212"></a>  </span>
<span id="cb78-1213"><a href="#cb78-1213"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>, </span>
<span id="cb78-1214"><a href="#cb78-1214"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb78-1215"><a href="#cb78-1215"></a>  </span>
<span id="cb78-1216"><a href="#cb78-1216"></a>  <span class="fu">scale_x_datetime</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb78-1217"><a href="#cb78-1217"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">9e-3</span>)) <span class="sc">+</span></span>
<span id="cb78-1218"><a href="#cb78-1218"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1219"><a href="#cb78-1219"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb78-1220"><a href="#cb78-1220"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb78-1221"><a href="#cb78-1221"></a></span>
<span id="cb78-1222"><a href="#cb78-1222"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_next_step_sliding_", window_width, "days.png"),</span></span>
<span id="cb78-1223"><a href="#cb78-1223"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1224"><a href="#cb78-1224"></a></span>
<span id="cb78-1225"><a href="#cb78-1225"></a><span class="in">```</span></span>
<span id="cb78-1226"><a href="#cb78-1226"></a></span>
<span id="cb78-1227"><a href="#cb78-1227"></a><span class="fu"># Hourly probabilities</span></span>
<span id="cb78-1228"><a href="#cb78-1228"></a></span>
<span id="cb78-1229"><a href="#cb78-1229"></a>We can also calculate the habitat selection, movement and next-step probabilities for each hour of the day, indicating when the models are accurate (or notr) at different times of the day.</span>
<span id="cb78-1230"><a href="#cb78-1230"></a></span>
<span id="cb78-1231"><a href="#cb78-1231"></a>For this we don't need a sliding window, we will just bin by the hour of the day.</span>
<span id="cb78-1232"><a href="#cb78-1232"></a></span>
<span id="cb78-1233"><a href="#cb78-1233"></a>Here we just show the hourly probabilities across the whole tracking period, but we could also split this up into seasons and assess how accurate the models are during the wet and dry seasons.</span>
<span id="cb78-1234"><a href="#cb78-1234"></a></span>
<span id="cb78-1237"><a href="#cb78-1237"></a><span class="in">```{r}</span></span>
<span id="cb78-1238"><a href="#cb78-1238"></a><span class="co"># grouping by each individual, model and hour of the day</span></span>
<span id="cb78-1239"><a href="#cb78-1239"></a>validation_all_quantiles_hourly <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb78-1240"><a href="#cb78-1240"></a>  <span class="fu">group_by</span>(id, model, probability, hour_t2) <span class="sc">%&gt;%</span> </span>
<span id="cb78-1241"><a href="#cb78-1241"></a>  <span class="fu">summarise</span>(<span class="at">average_prob =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1242"><a href="#cb78-1242"></a>            <span class="at">sd_prob =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1243"><a href="#cb78-1243"></a>            <span class="at">q025 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb78-1244"><a href="#cb78-1244"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1245"><a href="#cb78-1245"></a>            <span class="at">q50 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb78-1246"><a href="#cb78-1246"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1247"><a href="#cb78-1247"></a>            <span class="at">q975 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> T)</span>
<span id="cb78-1248"><a href="#cb78-1248"></a>            )</span>
<span id="cb78-1249"><a href="#cb78-1249"></a></span>
<span id="cb78-1250"><a href="#cb78-1250"></a><span class="fu">head</span>(validation_all_quantiles_hourly)</span>
<span id="cb78-1251"><a href="#cb78-1251"></a></span>
<span id="cb78-1252"><a href="#cb78-1252"></a><span class="co"># out-of-sample ids</span></span>
<span id="cb78-1253"><a href="#cb78-1253"></a><span class="co"># grouping by each model and hour of the day (combining all OOS individuals to get the average)</span></span>
<span id="cb78-1254"><a href="#cb78-1254"></a>validation_all_quantiles_hourly_OOS <span class="ot">&lt;-</span> validation_all_long <span class="sc">%&gt;%</span> </span>
<span id="cb78-1255"><a href="#cb78-1255"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">==</span> focal_id) <span class="sc">%&gt;%</span></span>
<span id="cb78-1256"><a href="#cb78-1256"></a>  <span class="fu">group_by</span>(model, probability, hour_t2) <span class="sc">%&gt;%</span> </span>
<span id="cb78-1257"><a href="#cb78-1257"></a>  <span class="fu">summarise</span>(<span class="at">average_prob =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1258"><a href="#cb78-1258"></a>            <span class="at">sd_prob =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1259"><a href="#cb78-1259"></a>            <span class="at">q025 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb78-1260"><a href="#cb78-1260"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1261"><a href="#cb78-1261"></a>            <span class="at">q50 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb78-1262"><a href="#cb78-1262"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb78-1263"><a href="#cb78-1263"></a>            <span class="at">q975 =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> T)</span>
<span id="cb78-1264"><a href="#cb78-1264"></a>            )</span>
<span id="cb78-1265"><a href="#cb78-1265"></a></span>
<span id="cb78-1266"><a href="#cb78-1266"></a><span class="fu">head</span>(validation_all_quantiles_hourly_OOS)</span>
<span id="cb78-1267"><a href="#cb78-1267"></a></span>
<span id="cb78-1268"><a href="#cb78-1268"></a><span class="in">```</span></span>
<span id="cb78-1269"><a href="#cb78-1269"></a></span>
<span id="cb78-1270"><a href="#cb78-1270"></a><span class="fu"># Habitat selection across the day</span></span>
<span id="cb78-1271"><a href="#cb78-1271"></a></span>
<span id="cb78-1272"><a href="#cb78-1272"></a><span class="fu">## All models</span></span>
<span id="cb78-1273"><a href="#cb78-1273"></a></span>
<span id="cb78-1276"><a href="#cb78-1276"></a><span class="in">```{r}</span></span>
<span id="cb78-1277"><a href="#cb78-1277"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1278"><a href="#cb78-1278"></a>  </span>
<span id="cb78-1279"><a href="#cb78-1279"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-1280"><a href="#cb78-1280"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1281"><a href="#cb78-1281"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1282"><a href="#cb78-1282"></a>  </span>
<span id="cb78-1283"><a href="#cb78-1283"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1284"><a href="#cb78-1284"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1285"><a href="#cb78-1285"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1286"><a href="#cb78-1286"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1287"><a href="#cb78-1287"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1288"><a href="#cb78-1288"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1289"><a href="#cb78-1289"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1290"><a href="#cb78-1290"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1291"><a href="#cb78-1291"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1292"><a href="#cb78-1292"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1293"><a href="#cb78-1293"></a>  </span>
<span id="cb78-1294"><a href="#cb78-1294"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1295"><a href="#cb78-1295"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1296"><a href="#cb78-1296"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1297"><a href="#cb78-1297"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1298"><a href="#cb78-1298"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1299"><a href="#cb78-1299"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1300"><a href="#cb78-1300"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1301"><a href="#cb78-1301"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1302"><a href="#cb78-1302"></a>            <span class="at">linewidth =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb78-1303"><a href="#cb78-1303"></a>  </span>
<span id="cb78-1304"><a href="#cb78-1304"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1305"><a href="#cb78-1305"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1306"><a href="#cb78-1306"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>),</span>
<span id="cb78-1307"><a href="#cb78-1307"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1308"><a href="#cb78-1308"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1309"><a href="#cb78-1309"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1310"><a href="#cb78-1310"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1311"><a href="#cb78-1311"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1312"><a href="#cb78-1312"></a>  </span>
<span id="cb78-1313"><a href="#cb78-1313"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1314"><a href="#cb78-1314"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1315"><a href="#cb78-1315"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1316"><a href="#cb78-1316"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1317"><a href="#cb78-1317"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1318"><a href="#cb78-1318"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1319"><a href="#cb78-1319"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1320"><a href="#cb78-1320"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1321"><a href="#cb78-1321"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1322"><a href="#cb78-1322"></a>  </span>
<span id="cb78-1323"><a href="#cb78-1323"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-1324"><a href="#cb78-1324"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1325"><a href="#cb78-1325"></a>  </span>
<span id="cb78-1326"><a href="#cb78-1326"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1327"><a href="#cb78-1327"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1328"><a href="#cb78-1328"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1329"><a href="#cb78-1329"></a>  </span>
<span id="cb78-1330"><a href="#cb78-1330"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1331"><a href="#cb78-1331"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1332"><a href="#cb78-1332"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1333"><a href="#cb78-1333"></a>  </span>
<span id="cb78-1334"><a href="#cb78-1334"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1335"><a href="#cb78-1335"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1336"><a href="#cb78-1336"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1337"><a href="#cb78-1337"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1338"><a href="#cb78-1338"></a></span>
<span id="cb78-1339"><a href="#cb78-1339"></a><span class="co"># ggsave(paste0("outputs/validation_all_hourly.png"),</span></span>
<span id="cb78-1340"><a href="#cb78-1340"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1341"><a href="#cb78-1341"></a></span>
<span id="cb78-1342"><a href="#cb78-1342"></a><span class="in">```</span></span>
<span id="cb78-1343"><a href="#cb78-1343"></a></span>
<span id="cb78-1344"><a href="#cb78-1344"></a>The deepSSF models both predict well in the evening (at least in-sample), but only the deepSSF S2 predicts well during the middle of the day, again suggesting that there is information in the Sentinel-2 layers that isn't present in the derived covariates. </span>
<span id="cb78-1345"><a href="#cb78-1345"></a></span>
<span id="cb78-1346"><a href="#cb78-1346"></a>The out-of-sample predictions are also much higher for the deepSSF S2 model, suggesting that it is better at generalising to new data.</span>
<span id="cb78-1347"><a href="#cb78-1347"></a></span>
<span id="cb78-1348"><a href="#cb78-1348"></a><span class="fu">## deepSSF models</span></span>
<span id="cb78-1349"><a href="#cb78-1349"></a></span>
<span id="cb78-1352"><a href="#cb78-1352"></a><span class="in">```{r}</span></span>
<span id="cb78-1353"><a href="#cb78-1353"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1354"><a href="#cb78-1354"></a>  </span>
<span id="cb78-1355"><a href="#cb78-1355"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-1356"><a href="#cb78-1356"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1357"><a href="#cb78-1357"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1358"><a href="#cb78-1358"></a>  </span>
<span id="cb78-1359"><a href="#cb78-1359"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1360"><a href="#cb78-1360"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1361"><a href="#cb78-1361"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1362"><a href="#cb78-1362"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1363"><a href="#cb78-1363"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1364"><a href="#cb78-1364"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1365"><a href="#cb78-1365"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1366"><a href="#cb78-1366"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1367"><a href="#cb78-1367"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1368"><a href="#cb78-1368"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1369"><a href="#cb78-1369"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1370"><a href="#cb78-1370"></a>  </span>
<span id="cb78-1371"><a href="#cb78-1371"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1372"><a href="#cb78-1372"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1373"><a href="#cb78-1373"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1374"><a href="#cb78-1374"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1375"><a href="#cb78-1375"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1376"><a href="#cb78-1376"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1377"><a href="#cb78-1377"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1378"><a href="#cb78-1378"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1379"><a href="#cb78-1379"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1380"><a href="#cb78-1380"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1381"><a href="#cb78-1381"></a>  </span>
<span id="cb78-1382"><a href="#cb78-1382"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1383"><a href="#cb78-1383"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1384"><a href="#cb78-1384"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1385"><a href="#cb78-1385"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1386"><a href="#cb78-1386"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1387"><a href="#cb78-1387"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1388"><a href="#cb78-1388"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1389"><a href="#cb78-1389"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1390"><a href="#cb78-1390"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1391"><a href="#cb78-1391"></a>  </span>
<span id="cb78-1392"><a href="#cb78-1392"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1393"><a href="#cb78-1393"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1394"><a href="#cb78-1394"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1395"><a href="#cb78-1395"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1396"><a href="#cb78-1396"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1397"><a href="#cb78-1397"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1398"><a href="#cb78-1398"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1399"><a href="#cb78-1399"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1400"><a href="#cb78-1400"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1401"><a href="#cb78-1401"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1402"><a href="#cb78-1402"></a>  </span>
<span id="cb78-1403"><a href="#cb78-1403"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-1404"><a href="#cb78-1404"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1405"><a href="#cb78-1405"></a>  </span>
<span id="cb78-1406"><a href="#cb78-1406"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1407"><a href="#cb78-1407"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1408"><a href="#cb78-1408"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1409"><a href="#cb78-1409"></a>  </span>
<span id="cb78-1410"><a href="#cb78-1410"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1411"><a href="#cb78-1411"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1412"><a href="#cb78-1412"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1413"><a href="#cb78-1413"></a>  </span>
<span id="cb78-1414"><a href="#cb78-1414"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1415"><a href="#cb78-1415"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1416"><a href="#cb78-1416"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4e-4</span>)) <span class="sc">+</span></span>
<span id="cb78-1417"><a href="#cb78-1417"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1418"><a href="#cb78-1418"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1419"><a href="#cb78-1419"></a></span>
<span id="cb78-1420"><a href="#cb78-1420"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_hourly.png"),</span></span>
<span id="cb78-1421"><a href="#cb78-1421"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1422"><a href="#cb78-1422"></a></span>
<span id="cb78-1423"><a href="#cb78-1423"></a><span class="in">```</span></span>
<span id="cb78-1424"><a href="#cb78-1424"></a></span>
<span id="cb78-1425"><a href="#cb78-1425"></a><span class="fu">## SSF models</span></span>
<span id="cb78-1426"><a href="#cb78-1426"></a></span>
<span id="cb78-1429"><a href="#cb78-1429"></a><span class="in">```{r}</span></span>
<span id="cb78-1430"><a href="#cb78-1430"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1431"><a href="#cb78-1431"></a>  </span>
<span id="cb78-1432"><a href="#cb78-1432"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1433"><a href="#cb78-1433"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1434"><a href="#cb78-1434"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1435"><a href="#cb78-1435"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1436"><a href="#cb78-1436"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1437"><a href="#cb78-1437"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1438"><a href="#cb78-1438"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1439"><a href="#cb78-1439"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1440"><a href="#cb78-1440"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1441"><a href="#cb78-1441"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1442"><a href="#cb78-1442"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1443"><a href="#cb78-1443"></a>  </span>
<span id="cb78-1444"><a href="#cb78-1444"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1445"><a href="#cb78-1445"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1446"><a href="#cb78-1446"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1447"><a href="#cb78-1447"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1448"><a href="#cb78-1448"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1449"><a href="#cb78-1449"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1450"><a href="#cb78-1450"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1451"><a href="#cb78-1451"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1452"><a href="#cb78-1452"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1453"><a href="#cb78-1453"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1454"><a href="#cb78-1454"></a>  </span>
<span id="cb78-1455"><a href="#cb78-1455"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1456"><a href="#cb78-1456"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1457"><a href="#cb78-1457"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1458"><a href="#cb78-1458"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1459"><a href="#cb78-1459"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1460"><a href="#cb78-1460"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1461"><a href="#cb78-1461"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1462"><a href="#cb78-1462"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1463"><a href="#cb78-1463"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1464"><a href="#cb78-1464"></a>  </span>
<span id="cb78-1465"><a href="#cb78-1465"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1466"><a href="#cb78-1466"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1467"><a href="#cb78-1467"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"habitat"</span>,</span>
<span id="cb78-1468"><a href="#cb78-1468"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1469"><a href="#cb78-1469"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1470"><a href="#cb78-1470"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1471"><a href="#cb78-1471"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1472"><a href="#cb78-1472"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1473"><a href="#cb78-1473"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1474"><a href="#cb78-1474"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1475"><a href="#cb78-1475"></a>  </span>
<span id="cb78-1476"><a href="#cb78-1476"></a>  <span class="co"># dashed line for the null probability</span></span>
<span id="cb78-1477"><a href="#cb78-1477"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1478"><a href="#cb78-1478"></a>  </span>
<span id="cb78-1479"><a href="#cb78-1479"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1480"><a href="#cb78-1480"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1481"><a href="#cb78-1481"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1482"><a href="#cb78-1482"></a>  </span>
<span id="cb78-1483"><a href="#cb78-1483"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1484"><a href="#cb78-1484"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1485"><a href="#cb78-1485"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1486"><a href="#cb78-1486"></a>  </span>
<span id="cb78-1487"><a href="#cb78-1487"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>,</span>
<span id="cb78-1488"><a href="#cb78-1488"></a>                     <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb78-1489"><a href="#cb78-1489"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb78-1490"><a href="#cb78-1490"></a>  </span>
<span id="cb78-1491"><a href="#cb78-1491"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1492"><a href="#cb78-1492"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.6e-4</span>, <span class="fl">1.5e-4</span>)) <span class="sc">+</span></span>
<span id="cb78-1493"><a href="#cb78-1493"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1494"><a href="#cb78-1494"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1495"><a href="#cb78-1495"></a></span>
<span id="cb78-1496"><a href="#cb78-1496"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_hourly.png"),</span></span>
<span id="cb78-1497"><a href="#cb78-1497"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1498"><a href="#cb78-1498"></a></span>
<span id="cb78-1499"><a href="#cb78-1499"></a><span class="in">```</span></span>
<span id="cb78-1500"><a href="#cb78-1500"></a></span>
<span id="cb78-1501"><a href="#cb78-1501"></a>The SSF model with temporal dynamics had higher prediction accuracy than the SSF model without temporal dynamics overall (in- and out-of-sample), but it was more variable throughout the day, and was quite poor between midnight and about 5am.</span>
<span id="cb78-1502"><a href="#cb78-1502"></a></span>
<span id="cb78-1503"><a href="#cb78-1503"></a><span class="fu"># Movement probability across the day</span></span>
<span id="cb78-1504"><a href="#cb78-1504"></a></span>
<span id="cb78-1505"><a href="#cb78-1505"></a><span class="fu">## All models</span></span>
<span id="cb78-1506"><a href="#cb78-1506"></a></span>
<span id="cb78-1509"><a href="#cb78-1509"></a><span class="in">```{r}</span></span>
<span id="cb78-1510"><a href="#cb78-1510"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1511"><a href="#cb78-1511"></a>  </span>
<span id="cb78-1512"><a href="#cb78-1512"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-1513"><a href="#cb78-1513"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1514"><a href="#cb78-1514"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1515"><a href="#cb78-1515"></a>  </span>
<span id="cb78-1516"><a href="#cb78-1516"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1517"><a href="#cb78-1517"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1518"><a href="#cb78-1518"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1519"><a href="#cb78-1519"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1520"><a href="#cb78-1520"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1521"><a href="#cb78-1521"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1522"><a href="#cb78-1522"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1523"><a href="#cb78-1523"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1524"><a href="#cb78-1524"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1525"><a href="#cb78-1525"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1526"><a href="#cb78-1526"></a>  </span>
<span id="cb78-1527"><a href="#cb78-1527"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1528"><a href="#cb78-1528"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1529"><a href="#cb78-1529"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1530"><a href="#cb78-1530"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1531"><a href="#cb78-1531"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1532"><a href="#cb78-1532"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1533"><a href="#cb78-1533"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1534"><a href="#cb78-1534"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1535"><a href="#cb78-1535"></a>            <span class="at">linewidth =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb78-1536"><a href="#cb78-1536"></a>  </span>
<span id="cb78-1537"><a href="#cb78-1537"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1538"><a href="#cb78-1538"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1539"><a href="#cb78-1539"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>),</span>
<span id="cb78-1540"><a href="#cb78-1540"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1541"><a href="#cb78-1541"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1542"><a href="#cb78-1542"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1543"><a href="#cb78-1543"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1544"><a href="#cb78-1544"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1545"><a href="#cb78-1545"></a>  </span>
<span id="cb78-1546"><a href="#cb78-1546"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1547"><a href="#cb78-1547"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1548"><a href="#cb78-1548"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1549"><a href="#cb78-1549"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1550"><a href="#cb78-1550"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1551"><a href="#cb78-1551"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1552"><a href="#cb78-1552"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1553"><a href="#cb78-1553"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1554"><a href="#cb78-1554"></a>            <span class="at">linewidth =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb78-1555"><a href="#cb78-1555"></a>  </span>
<span id="cb78-1556"><a href="#cb78-1556"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1557"><a href="#cb78-1557"></a>  </span>
<span id="cb78-1558"><a href="#cb78-1558"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1559"><a href="#cb78-1559"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1560"><a href="#cb78-1560"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1561"><a href="#cb78-1561"></a>  </span>
<span id="cb78-1562"><a href="#cb78-1562"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1563"><a href="#cb78-1563"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1564"><a href="#cb78-1564"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1565"><a href="#cb78-1565"></a>  </span>
<span id="cb78-1566"><a href="#cb78-1566"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1567"><a href="#cb78-1567"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1568"><a href="#cb78-1568"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1569"><a href="#cb78-1569"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1570"><a href="#cb78-1570"></a></span>
<span id="cb78-1571"><a href="#cb78-1571"></a><span class="co"># ggsave(paste0("outputs/validation_all_move_hourly.png"),</span></span>
<span id="cb78-1572"><a href="#cb78-1572"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1573"><a href="#cb78-1573"></a></span>
<span id="cb78-1574"><a href="#cb78-1574"></a><span class="in">```</span></span>
<span id="cb78-1575"><a href="#cb78-1575"></a></span>
<span id="cb78-1576"><a href="#cb78-1576"></a>The movement probabilities are much lower during the high movement periods. This is because there are many more cells that the buffalo are likely to move to, and so the probability of moving to any one cell is lower, and the model must spread the prediction probability across many more cells.</span>
<span id="cb78-1577"><a href="#cb78-1577"></a></span>
<span id="cb78-1578"><a href="#cb78-1578"></a>The SSF probabilities are also much much lower than the deepSSF probabilities, as explained for the movement probabilities across the tracking period.</span>
<span id="cb78-1579"><a href="#cb78-1579"></a></span>
<span id="cb78-1580"><a href="#cb78-1580"></a><span class="fu">## deepSSF models</span></span>
<span id="cb78-1581"><a href="#cb78-1581"></a></span>
<span id="cb78-1584"><a href="#cb78-1584"></a><span class="in">```{r}</span></span>
<span id="cb78-1585"><a href="#cb78-1585"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1586"><a href="#cb78-1586"></a>  </span>
<span id="cb78-1587"><a href="#cb78-1587"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-1588"><a href="#cb78-1588"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1589"><a href="#cb78-1589"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.25e-2</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1590"><a href="#cb78-1590"></a>  </span>
<span id="cb78-1591"><a href="#cb78-1591"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1592"><a href="#cb78-1592"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1593"><a href="#cb78-1593"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1594"><a href="#cb78-1594"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1595"><a href="#cb78-1595"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1596"><a href="#cb78-1596"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1597"><a href="#cb78-1597"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1598"><a href="#cb78-1598"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1599"><a href="#cb78-1599"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1600"><a href="#cb78-1600"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1601"><a href="#cb78-1601"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1602"><a href="#cb78-1602"></a>  </span>
<span id="cb78-1603"><a href="#cb78-1603"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1604"><a href="#cb78-1604"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1605"><a href="#cb78-1605"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1606"><a href="#cb78-1606"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1607"><a href="#cb78-1607"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1608"><a href="#cb78-1608"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1609"><a href="#cb78-1609"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1610"><a href="#cb78-1610"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1611"><a href="#cb78-1611"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1612"><a href="#cb78-1612"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1613"><a href="#cb78-1613"></a>  </span>
<span id="cb78-1614"><a href="#cb78-1614"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1615"><a href="#cb78-1615"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1616"><a href="#cb78-1616"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1617"><a href="#cb78-1617"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1618"><a href="#cb78-1618"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1619"><a href="#cb78-1619"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1620"><a href="#cb78-1620"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1621"><a href="#cb78-1621"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1622"><a href="#cb78-1622"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1623"><a href="#cb78-1623"></a>  </span>
<span id="cb78-1624"><a href="#cb78-1624"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1625"><a href="#cb78-1625"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1626"><a href="#cb78-1626"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1627"><a href="#cb78-1627"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1628"><a href="#cb78-1628"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1629"><a href="#cb78-1629"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1630"><a href="#cb78-1630"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1631"><a href="#cb78-1631"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1632"><a href="#cb78-1632"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1633"><a href="#cb78-1633"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1634"><a href="#cb78-1634"></a>  </span>
<span id="cb78-1635"><a href="#cb78-1635"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb78-1636"><a href="#cb78-1636"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1637"><a href="#cb78-1637"></a>  </span>
<span id="cb78-1638"><a href="#cb78-1638"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1639"><a href="#cb78-1639"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1640"><a href="#cb78-1640"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1641"><a href="#cb78-1641"></a>  </span>
<span id="cb78-1642"><a href="#cb78-1642"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1643"><a href="#cb78-1643"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1644"><a href="#cb78-1644"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1645"><a href="#cb78-1645"></a>  </span>
<span id="cb78-1646"><a href="#cb78-1646"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1647"><a href="#cb78-1647"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1648"><a href="#cb78-1648"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1649"><a href="#cb78-1649"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1650"><a href="#cb78-1650"></a></span>
<span id="cb78-1651"><a href="#cb78-1651"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_move_hourly.png"),</span></span>
<span id="cb78-1652"><a href="#cb78-1652"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1653"><a href="#cb78-1653"></a></span>
<span id="cb78-1654"><a href="#cb78-1654"></a><span class="in">```</span></span>
<span id="cb78-1655"><a href="#cb78-1655"></a></span>
<span id="cb78-1656"><a href="#cb78-1656"></a><span class="fu">## SSF models</span></span>
<span id="cb78-1657"><a href="#cb78-1657"></a></span>
<span id="cb78-1660"><a href="#cb78-1660"></a><span class="in">```{r}</span></span>
<span id="cb78-1661"><a href="#cb78-1661"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1662"><a href="#cb78-1662"></a>  </span>
<span id="cb78-1663"><a href="#cb78-1663"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1664"><a href="#cb78-1664"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1665"><a href="#cb78-1665"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1666"><a href="#cb78-1666"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1667"><a href="#cb78-1667"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1668"><a href="#cb78-1668"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1669"><a href="#cb78-1669"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1670"><a href="#cb78-1670"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1671"><a href="#cb78-1671"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1672"><a href="#cb78-1672"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1673"><a href="#cb78-1673"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1674"><a href="#cb78-1674"></a>  </span>
<span id="cb78-1675"><a href="#cb78-1675"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1676"><a href="#cb78-1676"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1677"><a href="#cb78-1677"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1678"><a href="#cb78-1678"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1679"><a href="#cb78-1679"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1680"><a href="#cb78-1680"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1681"><a href="#cb78-1681"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1682"><a href="#cb78-1682"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1683"><a href="#cb78-1683"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1684"><a href="#cb78-1684"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1685"><a href="#cb78-1685"></a>  </span>
<span id="cb78-1686"><a href="#cb78-1686"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1687"><a href="#cb78-1687"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1688"><a href="#cb78-1688"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1689"><a href="#cb78-1689"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1690"><a href="#cb78-1690"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1691"><a href="#cb78-1691"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1692"><a href="#cb78-1692"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1693"><a href="#cb78-1693"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1694"><a href="#cb78-1694"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1695"><a href="#cb78-1695"></a>  </span>
<span id="cb78-1696"><a href="#cb78-1696"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1697"><a href="#cb78-1697"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1698"><a href="#cb78-1698"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span>,</span>
<span id="cb78-1699"><a href="#cb78-1699"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1700"><a href="#cb78-1700"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1701"><a href="#cb78-1701"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1702"><a href="#cb78-1702"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1703"><a href="#cb78-1703"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1704"><a href="#cb78-1704"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1705"><a href="#cb78-1705"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1706"><a href="#cb78-1706"></a>  </span>
<span id="cb78-1707"><a href="#cb78-1707"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb78-1708"><a href="#cb78-1708"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1709"><a href="#cb78-1709"></a>  </span>
<span id="cb78-1710"><a href="#cb78-1710"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1711"><a href="#cb78-1711"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1712"><a href="#cb78-1712"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1713"><a href="#cb78-1713"></a>  </span>
<span id="cb78-1714"><a href="#cb78-1714"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1715"><a href="#cb78-1715"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1716"><a href="#cb78-1716"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1717"><a href="#cb78-1717"></a>  </span>
<span id="cb78-1718"><a href="#cb78-1718"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>,</span>
<span id="cb78-1719"><a href="#cb78-1719"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb78-1720"><a href="#cb78-1720"></a>  </span>
<span id="cb78-1721"><a href="#cb78-1721"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1722"><a href="#cb78-1722"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.25e-2</span>)) <span class="sc">+</span></span>
<span id="cb78-1723"><a href="#cb78-1723"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1724"><a href="#cb78-1724"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1725"><a href="#cb78-1725"></a></span>
<span id="cb78-1726"><a href="#cb78-1726"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_move_hourly.png"),</span></span>
<span id="cb78-1727"><a href="#cb78-1727"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1728"><a href="#cb78-1728"></a></span>
<span id="cb78-1729"><a href="#cb78-1729"></a><span class="in">```</span></span>
<span id="cb78-1730"><a href="#cb78-1730"></a></span>
<span id="cb78-1731"><a href="#cb78-1731"></a>The SSF models perform similarly, expect at night, where the temporally dynamic performs much better in- and out-of-sample.</span>
<span id="cb78-1732"><a href="#cb78-1732"></a></span>
<span id="cb78-1733"><a href="#cb78-1733"></a><span class="fu"># Next-step probability across the day</span></span>
<span id="cb78-1734"><a href="#cb78-1734"></a></span>
<span id="cb78-1735"><a href="#cb78-1735"></a><span class="fu">## All models</span></span>
<span id="cb78-1736"><a href="#cb78-1736"></a></span>
<span id="cb78-1739"><a href="#cb78-1739"></a><span class="in">```{r}</span></span>
<span id="cb78-1740"><a href="#cb78-1740"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1741"><a href="#cb78-1741"></a>  </span>
<span id="cb78-1742"><a href="#cb78-1742"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-1743"><a href="#cb78-1743"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1744"><a href="#cb78-1744"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3e-4</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1745"><a href="#cb78-1745"></a>  </span>
<span id="cb78-1746"><a href="#cb78-1746"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1747"><a href="#cb78-1747"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1748"><a href="#cb78-1748"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1749"><a href="#cb78-1749"></a>                       id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1750"><a href="#cb78-1750"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1751"><a href="#cb78-1751"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1752"><a href="#cb78-1752"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1753"><a href="#cb78-1753"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1754"><a href="#cb78-1754"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1755"><a href="#cb78-1755"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1756"><a href="#cb78-1756"></a>  </span>
<span id="cb78-1757"><a href="#cb78-1757"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1758"><a href="#cb78-1758"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1759"><a href="#cb78-1759"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1760"><a href="#cb78-1760"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1761"><a href="#cb78-1761"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1762"><a href="#cb78-1762"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1763"><a href="#cb78-1763"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1764"><a href="#cb78-1764"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1765"><a href="#cb78-1765"></a>            <span class="at">linewidth =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb78-1766"><a href="#cb78-1766"></a>  </span>
<span id="cb78-1767"><a href="#cb78-1767"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1768"><a href="#cb78-1768"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1769"><a href="#cb78-1769"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"move"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1770"><a href="#cb78-1770"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1771"><a href="#cb78-1771"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1772"><a href="#cb78-1772"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1773"><a href="#cb78-1773"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1774"><a href="#cb78-1774"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1775"><a href="#cb78-1775"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1776"><a href="#cb78-1776"></a>  </span>
<span id="cb78-1777"><a href="#cb78-1777"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1778"><a href="#cb78-1778"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1779"><a href="#cb78-1779"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1780"><a href="#cb78-1780"></a>                     id <span class="sc">==</span> focal_id),</span>
<span id="cb78-1781"><a href="#cb78-1781"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1782"><a href="#cb78-1782"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1783"><a href="#cb78-1783"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1784"><a href="#cb78-1784"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1785"><a href="#cb78-1785"></a>            <span class="at">linewidth =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb78-1786"><a href="#cb78-1786"></a>  </span>
<span id="cb78-1787"><a href="#cb78-1787"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb78-1788"><a href="#cb78-1788"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1789"><a href="#cb78-1789"></a>  </span>
<span id="cb78-1790"><a href="#cb78-1790"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1791"><a href="#cb78-1791"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1792"><a href="#cb78-1792"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1793"><a href="#cb78-1793"></a>  </span>
<span id="cb78-1794"><a href="#cb78-1794"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1795"><a href="#cb78-1795"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#AF3602"</span>, <span class="st">"#000000"</span>, <span class="st">"#0096B5"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1796"><a href="#cb78-1796"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>, <span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1797"><a href="#cb78-1797"></a>  </span>
<span id="cb78-1798"><a href="#cb78-1798"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1799"><a href="#cb78-1799"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1800"><a href="#cb78-1800"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1801"><a href="#cb78-1801"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1802"><a href="#cb78-1802"></a></span>
<span id="cb78-1803"><a href="#cb78-1803"></a><span class="co"># ggsave(paste0("outputs/validation_all_next_step_hourly.png"),</span></span>
<span id="cb78-1804"><a href="#cb78-1804"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1805"><a href="#cb78-1805"></a></span>
<span id="cb78-1806"><a href="#cb78-1806"></a><span class="in">```</span></span>
<span id="cb78-1807"><a href="#cb78-1807"></a></span>
<span id="cb78-1808"><a href="#cb78-1808"></a><span class="fu">## deepSSF models</span></span>
<span id="cb78-1809"><a href="#cb78-1809"></a></span>
<span id="cb78-1812"><a href="#cb78-1812"></a><span class="in">```{r}</span></span>
<span id="cb78-1813"><a href="#cb78-1813"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1814"><a href="#cb78-1814"></a>  </span>
<span id="cb78-1815"><a href="#cb78-1815"></a>  <span class="co"># dashed lines containing the SSF probabilities</span></span>
<span id="cb78-1816"><a href="#cb78-1816"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1817"><a href="#cb78-1817"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.25e-2</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1818"><a href="#cb78-1818"></a>  </span>
<span id="cb78-1819"><a href="#cb78-1819"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1820"><a href="#cb78-1820"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1821"><a href="#cb78-1821"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1822"><a href="#cb78-1822"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1823"><a href="#cb78-1823"></a>                       <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1824"><a href="#cb78-1824"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1825"><a href="#cb78-1825"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1826"><a href="#cb78-1826"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1827"><a href="#cb78-1827"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1828"><a href="#cb78-1828"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1829"><a href="#cb78-1829"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1830"><a href="#cb78-1830"></a>  </span>
<span id="cb78-1831"><a href="#cb78-1831"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1832"><a href="#cb78-1832"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1833"><a href="#cb78-1833"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1834"><a href="#cb78-1834"></a>                     <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1835"><a href="#cb78-1835"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1836"><a href="#cb78-1836"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1837"><a href="#cb78-1837"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1838"><a href="#cb78-1838"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1839"><a href="#cb78-1839"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1840"><a href="#cb78-1840"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1841"><a href="#cb78-1841"></a>  </span>
<span id="cb78-1842"><a href="#cb78-1842"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1843"><a href="#cb78-1843"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1844"><a href="#cb78-1844"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1845"><a href="#cb78-1845"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1846"><a href="#cb78-1846"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1847"><a href="#cb78-1847"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1848"><a href="#cb78-1848"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1849"><a href="#cb78-1849"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1850"><a href="#cb78-1850"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1851"><a href="#cb78-1851"></a>  </span>
<span id="cb78-1852"><a href="#cb78-1852"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1853"><a href="#cb78-1853"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1854"><a href="#cb78-1854"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1855"><a href="#cb78-1855"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1856"><a href="#cb78-1856"></a>                     <span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1857"><a href="#cb78-1857"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1858"><a href="#cb78-1858"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1859"><a href="#cb78-1859"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1860"><a href="#cb78-1860"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1861"><a href="#cb78-1861"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1862"><a href="#cb78-1862"></a>  </span>
<span id="cb78-1863"><a href="#cb78-1863"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb78-1864"><a href="#cb78-1864"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1865"><a href="#cb78-1865"></a>  </span>
<span id="cb78-1866"><a href="#cb78-1866"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1867"><a href="#cb78-1867"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1868"><a href="#cb78-1868"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1869"><a href="#cb78-1869"></a>  </span>
<span id="cb78-1870"><a href="#cb78-1870"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1871"><a href="#cb78-1871"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E25834"</span>, <span class="st">"#000000"</span>),</span>
<span id="cb78-1872"><a href="#cb78-1872"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"deepSSF"</span>, <span class="st">"deepSSF S2"</span>)) <span class="sc">+</span></span>
<span id="cb78-1873"><a href="#cb78-1873"></a>  </span>
<span id="cb78-1874"><a href="#cb78-1874"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>) <span class="sc">+</span></span>
<span id="cb78-1875"><a href="#cb78-1875"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1876"><a href="#cb78-1876"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1877"><a href="#cb78-1877"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1878"><a href="#cb78-1878"></a></span>
<span id="cb78-1879"><a href="#cb78-1879"></a><span class="co"># ggsave(paste0("outputs/validation_deepSSF_next_step_hourly.png"),</span></span>
<span id="cb78-1880"><a href="#cb78-1880"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1881"><a href="#cb78-1881"></a></span>
<span id="cb78-1882"><a href="#cb78-1882"></a><span class="in">```</span></span>
<span id="cb78-1883"><a href="#cb78-1883"></a></span>
<span id="cb78-1884"><a href="#cb78-1884"></a><span class="fu">## SSF models</span></span>
<span id="cb78-1885"><a href="#cb78-1885"></a></span>
<span id="cb78-1888"><a href="#cb78-1888"></a><span class="in">```{r}</span></span>
<span id="cb78-1889"><a href="#cb78-1889"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-1890"><a href="#cb78-1890"></a>  </span>
<span id="cb78-1891"><a href="#cb78-1891"></a>  <span class="co"># in sample 50% ribbon</span></span>
<span id="cb78-1892"><a href="#cb78-1892"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span></span>
<span id="cb78-1893"><a href="#cb78-1893"></a>                <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1894"><a href="#cb78-1894"></a>                       id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1895"><a href="#cb78-1895"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1896"><a href="#cb78-1896"></a>              <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1897"><a href="#cb78-1897"></a>                  <span class="at">ymin =</span> q25,</span>
<span id="cb78-1898"><a href="#cb78-1898"></a>                  <span class="at">ymax =</span> q75,</span>
<span id="cb78-1899"><a href="#cb78-1899"></a>                  <span class="at">fill =</span> model,</span>
<span id="cb78-1900"><a href="#cb78-1900"></a>                  <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1901"><a href="#cb78-1901"></a>              <span class="at">alpha =</span> ribbon_50_alpha) <span class="sc">+</span></span>
<span id="cb78-1902"><a href="#cb78-1902"></a>  </span>
<span id="cb78-1903"><a href="#cb78-1903"></a>  <span class="co"># out-of-sample thin line for each individual</span></span>
<span id="cb78-1904"><a href="#cb78-1904"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1905"><a href="#cb78-1905"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1906"><a href="#cb78-1906"></a>                       <span class="sc">!</span>id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1907"><a href="#cb78-1907"></a>                       <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1908"><a href="#cb78-1908"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1909"><a href="#cb78-1909"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1910"><a href="#cb78-1910"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1911"><a href="#cb78-1911"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1912"><a href="#cb78-1912"></a>            <span class="at">linewidth =</span> secondary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1913"><a href="#cb78-1913"></a>  </span>
<span id="cb78-1914"><a href="#cb78-1914"></a>  <span class="co"># out-of-sample mean line</span></span>
<span id="cb78-1915"><a href="#cb78-1915"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly_OOS <span class="sc">%&gt;%</span></span>
<span id="cb78-1916"><a href="#cb78-1916"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span> <span class="sc">&amp;</span></span>
<span id="cb78-1917"><a href="#cb78-1917"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1918"><a href="#cb78-1918"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2,</span>
<span id="cb78-1919"><a href="#cb78-1919"></a>                <span class="at">y =</span> average_prob,</span>
<span id="cb78-1920"><a href="#cb78-1920"></a>                <span class="at">colour =</span> model),</span>
<span id="cb78-1921"><a href="#cb78-1921"></a>            <span class="at">linewidth =</span> OOS_mean_linewidth, </span>
<span id="cb78-1922"><a href="#cb78-1922"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-1923"><a href="#cb78-1923"></a>  </span>
<span id="cb78-1924"><a href="#cb78-1924"></a>  <span class="co"># in sample mean line</span></span>
<span id="cb78-1925"><a href="#cb78-1925"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> validation_all_quantiles_hourly <span class="sc">%&gt;%</span> </span>
<span id="cb78-1926"><a href="#cb78-1926"></a>              <span class="fu">filter</span>(probability <span class="sc">==</span> <span class="st">"next_step"</span>,</span>
<span id="cb78-1927"><a href="#cb78-1927"></a>                     id <span class="sc">==</span> focal_id,</span>
<span id="cb78-1928"><a href="#cb78-1928"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"deepSSF"</span>, model)),</span>
<span id="cb78-1929"><a href="#cb78-1929"></a>            <span class="fu">aes</span>(<span class="at">x =</span> hour_t2, </span>
<span id="cb78-1930"><a href="#cb78-1930"></a>                <span class="at">y =</span> average_prob, </span>
<span id="cb78-1931"><a href="#cb78-1931"></a>                <span class="at">colour =</span> model,</span>
<span id="cb78-1932"><a href="#cb78-1932"></a>                <span class="at">group =</span> <span class="fu">interaction</span>(id, model)),</span>
<span id="cb78-1933"><a href="#cb78-1933"></a>            <span class="at">linewidth =</span> primary_linewidth) <span class="sc">+</span></span>
<span id="cb78-1934"><a href="#cb78-1934"></a>  </span>
<span id="cb78-1935"><a href="#cb78-1935"></a>  <span class="co"># dashed line for uniform probability</span></span>
<span id="cb78-1936"><a href="#cb78-1936"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> uniform_prob, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb78-1937"><a href="#cb78-1937"></a>  </span>
<span id="cb78-1938"><a href="#cb78-1938"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1939"><a href="#cb78-1939"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1940"><a href="#cb78-1940"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1941"><a href="#cb78-1941"></a>  </span>
<span id="cb78-1942"><a href="#cb78-1942"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Model"</span>,</span>
<span id="cb78-1943"><a href="#cb78-1943"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0096B5"</span>, <span class="st">"#26185F"</span>),</span>
<span id="cb78-1944"><a href="#cb78-1944"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SSF"</span>, <span class="st">"SSF 2p"</span>)) <span class="sc">+</span></span>
<span id="cb78-1945"><a href="#cb78-1945"></a>  </span>
<span id="cb78-1946"><a href="#cb78-1946"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Probability value"</span>,</span>
<span id="cb78-1947"><a href="#cb78-1947"></a>                     <span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb78-1948"><a href="#cb78-1948"></a>  </span>
<span id="cb78-1949"><a href="#cb78-1949"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Hour"</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb78-1950"><a href="#cb78-1950"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.25e-2</span>)) <span class="sc">+</span></span>
<span id="cb78-1951"><a href="#cb78-1951"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-1952"><a href="#cb78-1952"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb78-1953"><a href="#cb78-1953"></a></span>
<span id="cb78-1954"><a href="#cb78-1954"></a><span class="co"># ggsave(paste0("outputs/validation_SSF_next_step_hourly.png"),</span></span>
<span id="cb78-1955"><a href="#cb78-1955"></a><span class="co">#        width = 80, height = 80, units = "mm", dpi = 600)</span></span>
<span id="cb78-1956"><a href="#cb78-1956"></a></span>
<span id="cb78-1957"><a href="#cb78-1957"></a><span class="in">```</span></span>
<span id="cb78-1958"><a href="#cb78-1958"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://swforrest.github.io">
<p>Website</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:scottwforrest@gmail.com">
      <i class="bi bi-envelope-at-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/swforrest">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/swforrest/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/scottwilliamf.bsky.social">
<p>Bluesky</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com.au/citations?user=ECYMO3YAAAAJ&amp;hl=en&amp;authuser=1">
<p>Scholar</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>